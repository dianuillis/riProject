<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 18:19:55[mciao0827] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<event  confidence="0.8" wordnetid="100029378">
<rule  confidence="0.8" wordnetid="105846932">
<act  confidence="0.8" wordnetid="100030358">
<psychological_feature  confidence="0.8" wordnetid="100023100">
<procedure  confidence="0.8" wordnetid="101023820">
<activity  confidence="0.8" wordnetid="100407535">
<algorithm  confidence="0.8" wordnetid="105847438">
<header>
<title>Spigot algorithm</title>
<id>1235183</id>
<revision>
<id>211054428</id>
<timestamp>2008-05-08T16:14:53Z</timestamp>
<contributor>
<username>Iridescent</username>
<id>937705</id>
</contributor>
</revision>
<categories>
<category>Arbitrary precision algorithms</category>
</categories>
</header>
<bdy>

A <b>spigot algorithm</b> is an <link xlink:type="simple" xlink:href="../775/775.xml">
algorithm</link> used to compute the value of a mathematical constant such as <link xlink:type="simple" xlink:href="../601/23601.xml">
&amp;pi;</link> or <link xlink:type="simple" xlink:href="../633/9633.xml">
e</link>. Unlike <link xlink:type="simple" xlink:href="../798/54798.xml">
recursive</link> algorithms, a spigot algorithm yields digits incrementally without using previously computed digits. The <link xlink:type="simple" xlink:href="../165/656165.xml">
Bailey-Borwein-Plouffe formula</link> for the binary digits of Ï€ is an example of a spigot algorithm.
<sec>
<st>
Example</st>

<p>

This example illustrates the working of a spigot algorithm by calculating the binary digits of the <link xlink:type="simple" xlink:href="../476/21476.xml">
natural logarithm</link> of 2 (sequence <weblink xlink:type="simple" xlink:href="http://www.research.att.com/cgi-bin/access.cgi/as/njas/sequences/eisA.cgi?Anum=A068426">
A068426</weblink> in <series wordnetid="108457976" confidence="0.8">
<arrangement wordnetid="107938773" confidence="0.8">
<sequence wordnetid="108459252" confidence="0.8">
<ordering wordnetid="108456993" confidence="0.8">
<group wordnetid="100031264" confidence="0.8">
<link xlink:type="simple" xlink:href="../004/500004.xml">
OEIS</link></group>
</ordering>
</sequence>
</arrangement>
</series>
) using the identity</p>
<p>

<indent level="1">

<math>\ln(2)=\sum_{k=1}^{\infty}\frac{1}{k2^k}\, .</math>
</indent>

To start calculating binary digits from, say, the 8th place we multiply this identity by 27:</p>
<p>

<indent level="1">

<math>2^7\ln(2) =2^7\sum_{k=1}^{\infty}\frac{1}{k2^k}\, .</math>
</indent>

We then divide the infinite sum into a "head", in which the exponents of 2 are greater than or equal to zero, and a "tail", in which the exponents of 2 are negative:</p>
<p>

<indent level="1">

<math>2^7\ln(2) =\sum_{k=1}^{7}\frac{2^{7-k}}{k}+\sum_{k=8}^{\infty}\frac{1}{k2^{k-7}}\, .</math>
</indent>

We are only interested in the fractional part of this value, so we can replace each of the terms in the "head" by</p>
<p>

<indent level="1">

<math>\frac{2^{7-k} \mod k}{k}\, .</math>
</indent>

Calculating each of these terms and adding them to a running total where we again only keep the fractional part, we have:
<indent level="1">

| class="wikitable"
</indent>
|-
! <it>k</it>
! <it>A</it> = 27-<it>k</it>
! <it>B</it> = <it>A</it> mod <it>k</it>
! <it>C</it> = <it>B</it> / <it>k</it>
! Sum of <it>C</it> mod 1
|-
| 1
| 64
| 0
| 0
| 0
|-
| 2
| 32
| 0
| 0
| 0
|-
| 3
| 16
| 1
| 1/3
| 1/3
|-
| 4
| 8
| 0
| 0
| 1/3
|-
| 5
| 4
| 4
| 4/5
| 2/15
|-
| 6
| 2
| 2
| 1/3
| 7/15
|-
| 7
| 1
| 1
| 1/7
| 64/105
|}</p>
<p>

We add a few terms in the "tail", noting that the error introduced by truncating the sum is less than the final term:</p>
<p>

<indent level="1">

| class="wikitable"
</indent>
|-
! <it>k</it>
! <it>D</it> = 1/<it>k</it>2<it>k</it>-7
! Sum of <it>D</it>
! Maximum error
|-
| 8
| 1/16
| 1/16
| 1/16</p>
<p>

|-
| 9
| 1/36
| 13/144
| 1/36
|-
| 10
| 1/80
| 37/360
| 1/80
|}</p>
<p>

Adding the "head" and the first few terms of the "tail" together we get:</p>
<p>

<indent level="1">

<math>2^7\ln(2)\mod{1} \approx \frac{64}{105}+\frac{37}{360}=0.10011100 \cdots_{2} + 0.00011010 \cdots_{2} = 0.1011 \cdots_{2}\, ,</math>
</indent>

so the 8th to 11th binary digits in the binary expansion of ln(2) are 1, 0, 1, 1. Note that we have not calculated the values of the first 7 binary digits - indeed, all information about them has been intentionally discarded by using <link xlink:type="simple" xlink:href="../087/20087.xml">
modular arithmetic</link> in the "head" sum.</p>
<p>

The same approach can be used to calculate digits of the binary expansion of ln(2) starting from an arbitrary <it>n</it>th position. The number of terms in the "head" sum increases linearly with <it>n</it>, but the complexity of each term only increases with the logarithm of <it>n</it> if an efficient method of <link xlink:type="simple" xlink:href="../032/903032.xml">
modular exponentiation</link> is used. The <link xlink:type="simple" xlink:href="../110/552110.xml">
precision</link> of calculations and intermediate results and the number of terms taken from the "tail" sum are all independent of <it>n</it>, and only depend on the number of binary digits that are being calculated - <link xlink:type="simple" xlink:href="../250/143250.xml">
single precision</link> arithmetic can be used to calculate around 12 binary digits, regardless of the starting position.</p>

</sec>
<sec>
<st>
External links</st>
<p>

<list>
<entry level="1" type="bullet">

  <cite id="Reference-Mathworld-Spigot algorithm"><physical_entity wordnetid="100001930" confidence="0.8">
<communicator wordnetid="109610660" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<intellectual wordnetid="109621545" confidence="0.8">
<encyclopedist wordnetid="110055566" confidence="0.8">
<compiler wordnetid="109946957" confidence="0.8">
<alumnus wordnetid="109786338" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<scientist wordnetid="110560637" confidence="0.8">
<writer wordnetid="110794014" confidence="0.8">
<mathematician wordnetid="110301261" confidence="0.8">
<scholar wordnetid="110557854" confidence="0.8">
<link xlink:type="simple" xlink:href="../189/836189.xml">
Eric W. Weisstein</link></scholar>
</mathematician>
</writer>
</scientist>
</causal_agent>
</alumnus>
</compiler>
</encyclopedist>
</intellectual>
</person>
</communicator>
</physical_entity>
, <it><weblink xlink:type="simple" xlink:href="http://mathworld.wolfram.com/SpigotAlgorithm.html">
Spigot algorithm</weblink></it> at <computer wordnetid="103082979" confidence="0.8">
<work wordnetid="104599396" confidence="0.8">
<creation wordnetid="103129123" confidence="0.8">
<machine wordnetid="103699975" confidence="0.8">
<reference_book wordnetid="106417598" confidence="0.8">
<publication wordnetid="106589574" confidence="0.8">
<encyclopedia wordnetid="106427387" confidence="0.8">
<product wordnetid="104007894" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<book wordnetid="106410904" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<web_site wordnetid="106359193" confidence="0.8">
<link xlink:type="simple" xlink:href="../235/374235.xml">
MathWorld</link></web_site>
</device>
</book>
</instrumentality>
</artifact>
</product>
</encyclopedia>
</publication>
</reference_book>
</machine>
</creation>
</work>
</computer>
.</cite></entry>
<entry level="1" type="bullet">

 "<weblink xlink:type="simple" xlink:href="http://web.comlab.ox.ac.uk/oucl/work/jeremy.gibbons/publications/spigot.pdf">
Unbounded Spigot Algorithms for the Digits of Pi</weblink>".</entry>
</list>
</p>

</sec>
</bdy>
</algorithm>
</activity>
</procedure>
</psychological_feature>
</act>
</rule>
</event>
</article>
