<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 17.04.2009 01:50:14[mciao0828] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<header>
<title>Windows Security Log</title>
<id>13410217</id>
<revision>
<id>229053025</id>
<timestamp>2008-07-31T17:22:12Z</timestamp>
<contributor>
<username>Abune</username>
<id>376277</id>
</contributor>
</revision>
<categories>
<category>Computer security</category>
<category>Microsoft Windows security technology</category>
</categories>
</header>
<bdy>

The <b>Security Log</b>, in <link xlink:type="simple" xlink:href="../890/18890.xml">
Microsoft Windows</link>, is a log that contains records of login/logout activity and/or other security-related events specified by the system's audit policy. Auditing allows administrators to configure Windows to record operating system activity in the Security Log. The Security Log is one of three logs viewable under <idea wordnetid="105833840" confidence="0.8">
<concept wordnetid="105835747" confidence="0.8">
<component wordnetid="105868954" confidence="0.8">
<part wordnetid="105867413" confidence="0.8">
<link xlink:type="simple" xlink:href="../085/4132085.xml">
Event Viewer</link></part>
</component>
</concept>
</idea>
. <know-how wordnetid="105616786" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../227/632227.xml">
Local Security Authority Subsystem Service</link></method>
</know-how>
 writes events to the log. The Security Log is one of the primary tools used by Administrators to detect and investigate attempted and successful unauthorized activity and to troubleshoot problems; Microsoft describes it as "Your Best and Last Defense".<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%221%22])">1</ref> The log and the audit policies that govern it are also favorite targets of <link xlink:type="simple" xlink:href="../497/997497.xml">
hacker</link>s and rogue <link xlink:type="simple" xlink:href="../985/154985.xml">
system administrator</link>s seeking to cover their tracks before and after committing unauthorized activity.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%222%22])">2</ref>
<sec>
<st>
Types of data logged</st>
<p>

If the audit policy is set to record logins, a successful login results in the user's user name and computer name being logged as well as the user name they are logging into.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%223%22])">3</ref> Depending on the version of Windows and the method of login, the <link xlink:type="simple" xlink:href="../921/14921.xml">
IP address</link> may or may not be recorded. Windows 2000 Web Server, for instance, does not log IP addresses for successful logins, but Windows Server 2003 includes this capability.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%224%22])">4</ref> The categories of events that can be logged are:<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%225%22])">5</ref>
<list>
<entry level="1" type="bullet">

Account logon events</entry>
<entry level="1" type="bullet">

Account management</entry>
<entry level="1" type="bullet">

Directory service access</entry>
<entry level="1" type="bullet">

Logon events</entry>
<entry level="1" type="bullet">

Object access</entry>
<entry level="1" type="bullet">

Policy change</entry>
<entry level="1" type="bullet">

Privilege use</entry>
<entry level="1" type="bullet">

Process tracking</entry>
<entry level="1" type="bullet">

System events</entry>
</list>
</p>
<p>

The sheer number of loggable events means that security log analysis can be a time-consuming task.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%226%22])">6</ref> Third-party utilities have been developed to help identify suspicious trends. It is also possible to filter the log using customized criteria.</p>

</sec>
<sec>
<st>
Attacks and countermeasures</st>

<p>

Administrators are allowed to view and clear the log (there is no way to separate the rights to view and clear the log).<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%227%22])">7</ref> In addition, an Administrator can use <link xlink:type="simple" xlink:href="../249/13410249.xml">
Winzapper</link> to delete specific events from the log. For this reason, once the Administrator account has been compromised, the event history as contained in the Security Log is unreliable.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%228%22])">8</ref> A defense against this is to set up a remote <link>
log server</link> with all services shut off, allowing only console access.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%229%22])">9</ref></p>
<p>

As the log approaches its maximum size, it can either overwrite old events or stop logging new events. This makes it susceptible to attacks in which an intruder can flood the log by generating a large number of new events. A partial defense against this is to increase the maximum log size so that a greater number of events will be required to flood the log. It is possible to set the log to not overwrite old events, but as Chris Benton notes, "the only problem is that NT has a really bad habit of crashing when its logs become full".<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2210%22])">10</ref></p>
<p>

Randy Franklin Smith's <it>Ultimate Windows Security</it> points out that given the ability of administrators to manipulate the Security Log to cover unauthorized activity, separation of duty between operations and security-monitoring IT staff, combined with frequent backups of the log to a server accessible only to the latter, can improve security.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2211%22])">11</ref></p>
<p>

Another way to defeat the Security Log would be for a user to login as Administrator and change the auditing policies to stop logging the unauthorized activity he intends to carry out. The policy change itself could be logged, depending on the "audit policy change" setting, but this event could be deleted from the log using Winzapper; and from that point onward, the activity would not generate a trail in the Security Log.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%225%22])">5</ref></p>
<p>

Microsoft notes, "It is possible to detect attempts to elude a security monitoring solution with such techniques, but it is challenging to do so because many of the same events that can occur during an attempt to cover the tracks of intrusive activity are events that occur regularly on any typical business network".<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2212%22])">12</ref></p>
<p>

As Benton points out, one way of preventing successful attacks is <link xlink:type="simple" xlink:href="../087/29087.xml">
security through obscurity</link>. Keeping the IT department's security systems and practices confidential helps prevent users from formulating ways to cover their tracks. If users are aware that the log is copied over to the remote log server at :00 of every hour, for instance, they may take measures to defeat that system by attacking at :10 and then deleting the relevant log events before the top of the next hour.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2210%22])">10</ref></p>
<p>

Of course, log manipulation is not needed for all attacks. Simply being aware of how the Security Log works can be enough to take precautions against detection. For instance, a user wanting to log into a fellow employee's account on a corporate network might wait until after hours to gain unobserved <link xlink:type="simple" xlink:href="../142/13412142.xml">
physical access</link> to the computer in their cubicle; surreptitiously use a <link xlink:type="simple" xlink:href="../779/6227779.xml">
hardware keylogger</link> to obtain their password; and later login to that user's account through <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../110/16575110.xml">
Terminal Services</link></software>
 from a <link xlink:type="simple" xlink:href="../576/1060576.xml">
Wi-Fi hotspot</link> whose IP address cannot be traced back to the intruder.</p>
<p>

After the log is cleared through Event Viewer, one log entry is immediately created in the freshly-cleared log noting the time it was cleared and the admin who cleared it. This information can be a starting point in the investigation of the suspicious activity.</p>
<p>

In addition to the Windows Security Log, admins can check the <link xlink:type="simple" xlink:href="../163/2815163.xml">
Internet Connection Firewall</link> security log for clues.</p>

</sec>
<sec>
<st>
Writing false events to the log</st>
<p>

It is theoretically possible to write false events to the log. Microsoft notes, "To be able to write to the Security log, SeAuditPrivilege is required. By default, only Local System and Network Service accounts have such privilege".<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2213%22])">13</ref> <it>Microsoft Windows Internals</it> states, "Processes that call audit system services . . . must have the SeAuditPrivilege privilege to successfully generate an audit record".<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2214%22])">14</ref> The Winzapper FAQ notes that it is "possible to add your own 'made up' event records to the log" but this feature was not added because it was considered "too nasty," a reference to the fact that someone with Administrator access could use such functionality to shift the blame for unauthorized activity to an innocent party.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%228%22])">8</ref> Server 2003 added some API calls so that applications could register with the security event logs and write security audit entries. Specifically, the AuthzInstallSecurityEventSource function installs the specified source as a security event source.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2215%22])">15</ref></p>

</sec>
<sec>
<st>
Admissibility in court</st>
<p>

The EventTracker newsletter states that "The possibility of tampering is not enough to cause the logs to be inadmissible, there must be specific evidence of tampering in order for the logs to be considered inadmissible"<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2216%22])">16</ref>.</p>

</sec>
<sec>
<st>
References</st>

<p>

<reflist>
<entry id="1">
<weblink xlink:type="simple" xlink:href="http://www.microsoft.com/technet/archive/winntas/maintain/security/ntsecuri.mspx?mfr=true">
The NT Security Log - Your Best and Last Defense</weblink>, R. Franklin Smith</entry>
<entry id="2">
<weblink xlink:type="simple" xlink:href="http://www.windowsitpro.com/Windows/Article/ArticleID/8785/8785.html">
Protecting the NT Security Log</weblink>, Randy Franklin Smith, Windows IT Pro, July 2000.</entry>
<entry id="3">
<weblink xlink:type="simple" xlink:href="http://technet.microsoft.com/en-us/library/Bb742436.aspx">
Tracking Logon and Logoff Activity in Windows 2000</weblink>, Microsoft.</entry>
<entry id="4">
<weblink xlink:type="simple" xlink:href="http://www.windowsitpro.com/Windows/Article/ArticleID/40022/40022.html">
Capturing IP Addresses for Web Server Logon Events</weblink>, Randy Franklin Smith, <it>Windows IT Pro</it>, October 2003.</entry>
<entry id="5">
<weblink xlink:type="simple" xlink:href="http://technet2.microsoft.com/windowsserver/en/library/962f5863-15df-4271-9ae0-4b0412e297491033.mspx?mfr=true">
Auditing Policy</weblink>, Microsoft.</entry>
<entry id="6">
<weblink xlink:type="simple" xlink:href="http://www.infosecwriters.com/text_resources/pdf/top5-log-analysis-mistakes.pdf">
“Five Mistakes of Security Log Analysis”</weblink>, Anton Chuvakin, Ph.D., GCIA, GCIH.</entry>
<entry id="7">
<weblink xlink:type="simple" xlink:href="http://www.windowsitpro.com/WindowsSecurity/Article/ArticleID/42811/42811.html">
Access Denied: Letting Users View Security Logs</weblink>, Randy Franklin Smith, July 2004 -- intermittently broken link as of 2007-9-27.</entry>
<entry id="8">
<weblink xlink:type="simple" xlink:href="http://www.ntsecurity.nu/toolbox/winzapper/">
Winzapper FAQ</weblink>, NTSecurity.</entry>
<entry id="9">
<weblink xlink:type="simple" xlink:href="http://honeynet.org/papers/enemy2/index.html">
Know Your Enemy: II</weblink>, Honeynet Project.</entry>
<entry id="10">
<weblink xlink:type="simple" xlink:href="http://nsi.arcert.gov.ar/webs/textos/ntaudit.pdf">
Auditing Windows NT</weblink>, Chris Benton.</entry>
<entry id="11">
<weblink xlink:type="simple" xlink:href="http://www.ultimatewindowssecurity.com/ebookChapter2.html">
Ultimate Windows Security</weblink>, Randy Franklin Smith.</entry>
<entry id="12">
<weblink xlink:type="simple" xlink:href="http://www.microsoft.com/technet/security/midsizebusiness/topics/serversecurity/attackdetection.mspx">
Security Monitoring and Attack Detection</weblink>, Microsoft, Aug. 29, 2006.</entry>
<entry id="13">
<weblink xlink:type="simple" xlink:href="http://msdn2.microsoft.com/en-us/library/ms731669.aspx">
Auditing Security Events</weblink>, Microsoft.</entry>
<entry id="14">
<weblink xlink:type="simple" xlink:href="http://book.itzero.com/read/microsoft/0507/microsoft.press.microsoft.windows.internals.fourth.edition.dec.2004.internal.fixed.ebook-ddu_html/0735619174/ch08lev1sec4.html">
 Microsoft Windows Internals</weblink>, Microsoft.</entry>
<entry id="15">
<weblink xlink:type="simple" xlink:href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/secauthz/security/authzinstallsecurityeventsource.asp">
AuthzInstallSecurityEventSource Function</weblink>, Microsoft.</entry>
<entry id="16">
<weblink xlink:type="simple" xlink:href="http://www.eventlogmanager.com/subpass/newsletter/april06.htm">
EventTracker Newsletter</weblink>, April 2006, Will your log files stand up in court? Authentication vs. logon events?</entry>
</reflist>
</p>

</sec>
<sec>
<st>
External links</st>
<p>

<list>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://support.microsoft.com/kb/947226">
Description of security events in Windows Vista and in Windows Server 2008</weblink></entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.microsoft.com/downloads/details.aspx?FamilyID=82e6d48f-e843-40ed-8b10-b3b716f6b51b">
Description of security events in Windows Vista and in Windows Server 2008 (XLS)</weblink></entry>
</list>

</p>
</sec>
<sec>
<st>
See also</st>
<p>

<list>
<entry level="1" type="bullet">

<link xlink:type="simple" xlink:href="../898/9654898.xml">
Log management and intelligence</link></entry>
<entry level="1" type="bullet">

<message wordnetid="106598915" confidence="0.8">
<information wordnetid="106634376" confidence="0.8">
<format wordnetid="106636806" confidence="0.8">
<link xlink:type="simple" xlink:href="../392/7915392.xml">
Common Log Format</link></format>
</information>
</message>
</entry>
<entry level="1" type="bullet">

<message wordnetid="106598915" confidence="0.8">
<protocol wordnetid="106665108" confidence="0.8">
<standard wordnetid="107260623" confidence="0.8">
<direction wordnetid="106786629" confidence="0.8">
<rule wordnetid="106652242" confidence="0.8">
<system_of_measurement wordnetid="113577171" confidence="0.8">
<link xlink:type="simple" xlink:href="../295/1590295.xml">
Syslog</link></system_of_measurement>
</rule>
</direction>
</standard>
</protocol>
</message>
</entry>
</list>
</p>

</sec>
</bdy>
</article>
