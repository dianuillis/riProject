<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 17.04.2009 02:34:46[mciao0826] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<entity  confidence="0.9511911446218017" wordnetid="100001740">
<header>
<title>Three-pass protocol</title>
<id>14580492</id>
<revision>
<id>221594262</id>
<timestamp>2008-06-25T05:40:34Z</timestamp>
<contributor>
<username>Koavf</username>
<id>205121</id>
</contributor>
</revision>
<categories>
<category>Asymmetric-key cryptosystems</category>
</categories>
</header>
<bdy>

In <link xlink:type="simple" xlink:href="../432/18934432.xml">
cryptography</link>, the <b>three-pass protocol</b> for sending messages is a framework which allows one party to securely send a message to a second party without the need to exchange or distribute <link xlink:type="simple" xlink:href="../039/53039.xml">
encryption keys</link>.  This message protocol should not be confused with various other algorithms which use 3 passes for <link xlink:type="simple" xlink:href="../967/47967.xml">
authentication</link>. <p>

It is called the <it>three-pass protocol</it> because the sender and the receiver exchange three encrypted messages.  The first three-pass protocol was developed by <person wordnetid="100007846" confidence="0.9508927676800064">
<scientist wordnetid="110560637" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../314/57314.xml">
Adi Shamir</link></scientist>
</person>
 circa 1980, and is described in more detail in a later section.  The basic concept of the Three-Pass Protocol is that each party has a private encryption key and a private decryption key.  The two parties use their keys independently, first to encrypt the message, and then to decrypt the message.</p>
<p>

The protocol uses an <link xlink:type="simple" xlink:href="../294/10294.xml">
encryption function</link> <it>E</it> and a decryption function <it>D</it>.  The encryption function uses an <link xlink:type="simple" xlink:href="../294/10294.xml">
encryption key</link> <it>e</it> to change a <link xlink:type="simple" xlink:href="../935/157935.xml">
plaintext</link> message <it>m</it> into an encrypted message, or <link xlink:type="simple" xlink:href="../294/10294.xml">
ciphertext</link>, <it>E(e,m)</it>.  Corresponding to each encryption key <it>e</it> there is a decryption key <it>d</it> which allows the message to be recovered using the decryption function, <it>D(d,E(e,m))=m</it>. Sometimes the encryption function and decryption function are the same.</p>
<p>

In order for the encryption function and decryption function to be suitable for the <it>Three-Pass Protocol</it> they must have the property that for any message <it>m</it>, any encryption key <it>e</it> with corresponding decryption key <it>d</it> and any independent encryption key <it>k</it>, &nbsp;<it>D(d,E(k,E(e,m))) = E(k,m)</it>.  In other words, it must be possible to remove the first encryption with the key <it>e</it> even though a second encryption with the key <it>k</it> has been performed.  This will always be possible with a commutative encryption. A commutative encryption is an encryption that is order-independent, i.e. it satisfies <it>E(a,E(b,m))=E(b,E(a,m))</it> for all encryption keys <it>a</it> and <it>b</it> and all messages <it>m</it>.  Commutative encryptions satisfy <it>D(d,E(k,E(e,m))) = D(d,E(e,E(k,m))) = E(k,m)</it>.  </p>
<p>

The Three-Pass Protocol works as follows:
<list>
<entry level="1" type="number">

 The sender chooses a private encryption key <it>s</it> and a corresponding decryption key <it>t</it>.  The sender encrypts the message <it>m</it> with the key <it>s</it> and sends the encrypted message <it>E(s,m)</it> to the receiver.</entry>
<entry level="1" type="number">

 The receiver chooses a private encryption key <it>r</it> and a corresponding decryption key <it>q</it> and <link xlink:type="simple" xlink:href="../541/1062541.xml">
super-encrypts</link> the first message <it>E(s,m)</it> with the key <it>r</it> and sends the doubly-encrypted message <it>E(r,E(s,m))</it> back to the sender.</entry>
<entry level="1" type="number">

 The sender decrypts the second message with the key <it>t</it>.  Because of the commutativity property described above <it>D(t,E(r,E(s,m)))=E(r,m)</it> which is the message encrypted with only the receiver's private key.  The sender sends this to the receiver.</entry>
</list>

The receiver can now decrypt the message using the key <it>q</it>, namely <it>D(q,E(r,m))=m</it> the original message.</p>
<p>

Notice that all of the operations involving the sender's private keys <it>s</it> and <it>t</it> are performed by the sender, and all of the operations involving the receiver's private keys <it>r</it> and <it>q</it> are performed by the receiver, so that neither party needs to know the other party's keys.</p>

<sec>
<st>
 Shamir three-pass protocol </st>

<p>

The first Three-Pass Protocol was the <person wordnetid="100007846" confidence="0.9508927676800064">
<scientist wordnetid="110560637" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../314/57314.xml">
Shamir</link></scientist>
</person>
 Three-Pass Protocol developed circa 1980.  It is also called the <it>Shamir No-Key Protocol</it> because the sender and the receiver do not exchange any keys, however the protocol requires the sender and receiver to have two private keys for encrypting and decrypting messages.  The Shamir algorithm uses <link xlink:type="simple" xlink:href="../491/99491.xml">
exponentiation</link> modulo a large <link xlink:type="simple" xlink:href="../666/23666.xml">
prime</link> as both the encryption and decryption functions.  That is <it>E</it>(<it>e</it>,<it>m</it>) = <it>me</it> mod <it>p</it> and <it>D</it>(<it>d</it>,<it>m</it>) = <it>md</it> mod <it>p</it> where <it>p</it> is a large prime.  For any encryption exponent <it>e</it> in the range 1..<it>p</it>-1 with gcd(<it>e</it>,<it>p</it>-1) = 1. The corresponding decryption exponent <it>d</it> is chosen such that <it>de</it> ≡ 1 (mod <it>p</it>-1). It follows from <link xlink:type="simple" xlink:href="../453/53453.xml">
Fermat's Little Theorem</link> that <it>D</it>(<it>d</it>,<it>E</it>(<it>e</it>,<it>m</it>)) = <it>mde</it> mod <it>p</it> = <it>m</it>.</p>
<p>

The Shamir protocol has the desired commutativity property since <it>E</it>(<it>a</it>,<it>E</it>(<it>b</it>,<it>m</it>)) = <it>mab</it> mod&nbsp;<it>p</it> = <it>mba</it> mod&nbsp;<it>p</it> = <it>E</it>(<it>b</it>,<it>E</it>(<it>a</it>,<it>m</it>)).</p>

</sec>
<sec>
<st>
 Massey-Omura cryptosystem </st>

<p>

The Massey-Omura Cryptosystem was proposed by <person wordnetid="100007846" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../907/9543907.xml">
James Massey</link></person>
 and <person wordnetid="100007846" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../614/11383614.xml">
Jim K. Omura</link></person>
 in 1982 as a possible improvement over the Shamir protocol.  The Massey-Omura method uses <link xlink:type="simple" xlink:href="../491/99491.xml">
exponentiation</link> in the <link xlink:type="simple" xlink:href="../615/11615.xml">
Galois field</link> GF(2<it>n</it>) as both the encryption and decryption functions.  That is <it>E(e,m)=me</it> and <it>D(d,m)=md</it> where the calculations are carried out in the Galois field.  For any encryption exponent <it>e</it> with 0<it>e</it>2<it>n</it>-1 and gcd(<it>e</it>,2<it>n</it>-1)=1 the corresponding decryption exponent is <it>d</it> such that <it>de</it> ≡ 1 (mod 2<it>n</it>-1).  Since the multiplicative group of the Galois field GF(2<it>n</it>) has order 2<it>n</it>-1 <statement wordnetid="106722453" confidence="0.8">
<message wordnetid="106598915" confidence="0.8">
<theorem wordnetid="106752293" confidence="0.8">
<proposition wordnetid="106750804" confidence="0.8">
<group wordnetid="100031264" confidence="0.8">
<link xlink:type="simple" xlink:href="../150/31150.xml">
Lagrange's theorem</link></group>
</proposition>
</theorem>
</message>
</statement>
 implies that <it>mde</it>=<it>m</it> for all <it>m</it> in GF(2<it>n</it>)* .</p>
<p>

Each element of the Galois field GF(2<it>n</it>) is represented as a <link xlink:type="simple" xlink:href="../686/238686.xml">
binary</link> <link xlink:type="simple" xlink:href="../910/741910.xml">
vector</link> over a <link xlink:type="simple" xlink:href="../589/1028589.xml">
normal basis</link> in which each <link xlink:type="simple" xlink:href="../420/18420.xml">
basis vector</link> is the square of the preceding one.  That is, the basis vectors are <it>v</it>1, <it>v</it>2, <it>v</it>4, <it>v</it>8, ... where <it>v</it> is a field element of maximum <link xlink:type="simple" xlink:href="../527/493527.xml">
order</link>.  By using this representation, exponentiations by powers of 2 can be accomplished by <link xlink:type="simple" xlink:href="../276/1917276.xml">
cyclic shifts</link>. This means that raising <it>m</it> to an arbitrary power can be accomplished with at most <it>n</it> shifts and <it>n</it> multiplications.  Moreover, several multiplications can be performed in parallel. This allows faster hardware realizations at the cost of having to implement several multipliers.</p>

</sec>
<sec>
<st>
 Security </st>

<p>

Any three-pass algorithm will be secure only if it is not feasible for an attacker to determine a significant amount of information about the message <it>m</it> from the three transmitted messages <it>E(s,m)</it>, <it>E(r,E(s,m))</it> and <it>E(r,m)</it>.  The encryption and decryption functions must be chosen so that the computational cost of determining any significant part of <it>m</it> from the three messages is prohibitive.</p>
<p>

For the encryption functions used in the Shamir algorithm and the Massey-Omura algorithm described above, the security relies on the difficulty of computing <link xlink:type="simple" xlink:href="../334/181334.xml">
discrete logarithms</link> in a finite field.  If an attacker could compute discrete logarithms in <it>GF(p)</it> for the Shamir method or <it>GF(2n)</it> for the Massey-Omura method then the protocol could be broken.  The key <it>s</it> could be computed from the messages <it>mr</it> and <it>mrs</it>.  When <it>s</it> is known, it is easy to compute the decryption exponent <it>t</it>.  Then the attacker could compute <it>m</it> by raising the intercepted message <it>ms</it> to the <it>t</it> power.  K. Sakurai and H. Shizuya show that under certain assumptions breaking Massey-Omura cryptosystem is equivalent to the Diffie-Hellman assumption.</p>

</sec>
<sec>
<st>
 Authentication </st>

<p>

When the encryption function satisfies the conditions just described, the three-pass protocol is secure against passive attacks in which an eavesdropper can read the messages transmitted between the parties.  However, the three-pass protocol does not provide any <link xlink:type="simple" xlink:href="../967/47967.xml">
authentication</link>.  Without any additional authentication the protocol is susceptible to a <link xlink:type="simple" xlink:href="../676/144676.xml">
man-in-the-middle attack</link> if the opponent has the ability to create false messages, or to intercept and replace the genuine transmitted messages.</p>

</sec>
<sec>
<st>
 References </st>

<p>

<list>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://patft.uspto.gov/netacgi/nph-Parser?patentnumber=4567600">
U.S. Patent 4,567,600</weblink><weblink xlink:type="simple" xlink:href="http://www.pat2pdf.org/pat2pdf/foo.pl?number=4567600">
&nbsp;</weblink>, U.S. patent on the Massey-Omura cryptosystem</entry>
<entry level="1" type="bullet">

 Alan G. Konheim (1981) <it>Cryptography: A Primer</it> 346-7.</entry>
<entry level="1" type="bullet">

 A. Menezes, P. VanOorschot, S. Vanstone (1996) <it>Handbook of Applied Cryptography</it> 500, 642.</entry>
<entry level="1" type="bullet">

 K. Sakurai and H. Shizuya (1998) "A Structural Comparison of the Computational Difficulty of Breaking Discrete Log Cryptosystems" <it>Journal of Cryptology</it> <b>11</b>: 29-43.</entry>
</list>
</p>


<p>

<table style=";" class="navbox" cellspacing="0">
<row>
<col style="padding:2px;">
<table style="width:100%;background:transparent;color:inherit;;" class="nowraplinks  " cellspacing="0">
<row>
<col colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd">
<table style="width:100%;;;;" class="nowraplinks  navbox-subgroup" cellspacing="0">
<row>
<col colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd">
<table style="width:100%;;;;" class="nowraplinks  navbox-subgroup" cellspacing="0">
<row>
<header colspan="2" style=";background:#ccf;" class="navbox-title">
&nbsp;<link xlink:type="simple" xlink:href="../222/24222.xml">
Public-key cryptography</link></header>
</row>
<row style="height:2px;">

</row>
<row>
<col colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd"><p>

<b>Algorithms:</b> <link xlink:type="simple" xlink:href="../287/14050287.xml">
CEILIDH</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../406/1564406.xml">
Cramer-Shoup</link>&nbsp;&#124; 
<message wordnetid="106598915" confidence="0.8">
<protocol wordnetid="106665108" confidence="0.8">
<direction wordnetid="106786629" confidence="0.8">
<rule wordnetid="106652242" confidence="0.8">
<link xlink:type="simple" xlink:href="../903/7903.xml">
DH</link></rule>
</direction>
</protocol>
</message>
&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../470/59470.xml">
DSA</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../958/3357958.xml">
ECDH</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../525/450525.xml">
ECDSA</link>&nbsp;&#124; 
<message wordnetid="106598915" confidence="0.8">
<protocol wordnetid="106665108" confidence="0.8">
<direction wordnetid="106786629" confidence="0.8">
<rule wordnetid="106652242" confidence="0.8">
<link xlink:type="simple" xlink:href="../894/1506894.xml">
EKE</link></rule>
</direction>
</protocol>
</message>
&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../458/59458.xml">
ElGamal encryption</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../473/2033473.xml">
ElGamal signature scheme</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../608/598608.xml">
GMR</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../076/3530076.xml">
IES</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../486/3200486.xml">
Lamport</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../447/1586447.xml">
MQV</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../582/481582.xml">
NTRUEncrypt</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../327/3513327.xml">
NTRUSign</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../685/480685.xml">
Paillier</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../283/451283.xml">
Rabin</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../385/25385.xml">
RSA</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../536/450536.xml">
Schnorr</link>&nbsp;&#124; 
<message wordnetid="106598915" confidence="0.8">
<protocol wordnetid="106665108" confidence="0.8">
<direction wordnetid="106786629" confidence="0.8">
<rule wordnetid="106652242" confidence="0.8">
<link xlink:type="simple" xlink:href="../061/2159061.xml">
SPEKE</link></rule>
</direction>
</protocol>
</message>
&nbsp;&#124; 
<message wordnetid="106598915" confidence="0.8">
<protocol wordnetid="106665108" confidence="0.8">
<know-how wordnetid="105616786" confidence="0.8">
<direction wordnetid="106786629" confidence="0.8">
<rule wordnetid="106652242" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../670/1306670.xml">
SRP</link></method>
</rule>
</direction>
</know-how>
</protocol>
</message>
&nbsp;&#124; 
<message wordnetid="106598915" confidence="0.8">
<protocol wordnetid="106665108" confidence="0.8">
<know-how wordnetid="105616786" confidence="0.8">
<direction wordnetid="106786629" confidence="0.8">
<rule wordnetid="106652242" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../137/2587137.xml">
STS</link></method>
</rule>
</direction>
</know-how>
</protocol>
</message>
&nbsp;&#124; 
<region wordnetid="108630985" confidence="0.8">
<field wordnetid="108569998" confidence="0.8">
<location wordnetid="100027167" confidence="0.8">
<tract wordnetid="108673395" confidence="0.8">
<geographical_area wordnetid="108574314" confidence="0.8">
<link xlink:type="simple" xlink:href="../209/3963209.xml">
XTR</link></geographical_area>
</tract>
</location>
</field>
</region>
</p>
</col>
</row>
<row style="height:2px">

</row>
<row>
<col colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-even"><p>

<b>Theory:</b> <link xlink:type="simple" xlink:href="../334/181334.xml">
Discrete logarithm</link>&nbsp;&#124; 
<region wordnetid="108630985" confidence="0.8">
<field wordnetid="108569998" confidence="0.8">
<location wordnetid="100027167" confidence="0.8">
<tract wordnetid="108673395" confidence="0.8">
<geographical_area wordnetid="108574314" confidence="0.8">
<link xlink:type="simple" xlink:href="../966/9966.xml">
Elliptic curve cryptography</link></geographical_area>
</tract>
</location>
</field>
</region>
&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../741/1544741.xml">
RSA problem</link></p>
</col>
</row>
<row style="height:2px">

</row>
<row>
<col colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd"><p>

<b>Standardization:</b> <link>
ANS X9F1</link>&nbsp;&#124; 
<standard wordnetid="107260623" confidence="0.8">
<system_of_measurement wordnetid="113577171" confidence="0.8">
<link xlink:type="simple" xlink:href="../159/549159.xml">
CRYPTREC</link></system_of_measurement>
</standard>
&nbsp;&#124; 
<standard wordnetid="107260623" confidence="0.8">
<system_of_measurement wordnetid="113577171" confidence="0.8">
<link xlink:type="simple" xlink:href="../154/1644154.xml">
IEEE P1363</link></system_of_measurement>
</standard>
&nbsp;&#124; 
<standard wordnetid="107260623" confidence="0.8">
<system_of_measurement wordnetid="113577171" confidence="0.8">
<link xlink:type="simple" xlink:href="../430/497430.xml">
NESSIE</link></system_of_measurement>
</standard>
&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../099/1602099.xml">
NSA Suite B</link></p>
</col>
</row>
<row style="height:2px">

</row>
<row>
<col colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-even"><p>

<b>Misc:</b> <document wordnetid="106470073" confidence="0.8">
<written_communication wordnetid="106349220" confidence="0.8">
<writing wordnetid="106362953" confidence="0.8">
<link xlink:type="simple" xlink:href="../644/59644.xml">
Digital signature</link></writing>
</written_communication>
</document>
&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../312/7943312.xml">
Fingerprint</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../112/194112.xml">
PKI</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../356/296356.xml">
Web of trust</link>&nbsp;&#124; 
<link xlink:type="simple" xlink:href="../749/5749.xml">
Key size</link></p>
</col>
</row>
</table>
</col>
</row>
</table>
</col>
</row>
<row style="height:2px">

</row>
<row>
<col colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-even">
<table style="width:100%;;;;" class="nowraplinks  navbox-subgroup" cellspacing="0">
<row>
<header colspan="2" style=";background:#ccf;" class="navbox-title">
&nbsp;<link xlink:type="simple" xlink:href="../432/18934432.xml">
Cryptography</link></header>
</row>
<row style="height:2px;">

</row>
<row>
<col colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-odd">
<link xlink:type="simple" xlink:href="../066/520066.xml">
History of cryptography</link> | <link xlink:type="simple" xlink:href="../715/5715.xml">
Cryptanalysis</link> | 
Cryptography portal | <link xlink:type="simple" xlink:href="../585/449585.xml">
Topics in cryptography</link></col>
</row>
<row style="height:2px">

</row>
<row>
<col colspan="2" style="width:100%;padding:0px;;;" class="navbox-list navbox-even">
<event wordnetid="100029378" confidence="0.8">
<rule wordnetid="105846932" confidence="0.8">
<act wordnetid="100030358" confidence="0.8">
<psychological_feature wordnetid="100023100" confidence="0.8">
<procedure wordnetid="101023820" confidence="0.8">
<activity wordnetid="100407535" confidence="0.8">
<algorithm wordnetid="105847438" confidence="0.8">
<link xlink:type="simple" xlink:href="../042/53042.xml">
Symmetric-key algorithm</link></algorithm>
</activity>
</procedure>
</psychological_feature>
</act>
</rule>
</event>
 | <link xlink:type="simple" xlink:href="../594/4594.xml">
Block cipher</link> | <link xlink:type="simple" xlink:href="../007/49007.xml">
Stream cipher</link> | <link xlink:type="simple" xlink:href="../222/24222.xml">
Public-key cryptography</link> | <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<primitive wordnetid="109627462" confidence="0.8">
<link xlink:type="simple" xlink:href="../526/439526.xml">
Cryptographic hash function</link></primitive>
</causal_agent>
</person>
</physical_entity>
 | <link xlink:type="simple" xlink:href="../523/567523.xml">
Message authentication code</link> | <event wordnetid="100029378" confidence="0.8">
<rule wordnetid="105846932" confidence="0.8">
<act wordnetid="100030358" confidence="0.8">
<psychological_feature wordnetid="100023100" confidence="0.8">
<procedure wordnetid="101023820" confidence="0.8">
<activity wordnetid="100407535" confidence="0.8">
<algorithm wordnetid="105847438" confidence="0.8">
<link xlink:type="simple" xlink:href="../249/182249.xml">
Random numbers</link></algorithm>
</activity>
</procedure>
</psychological_feature>
</act>
</rule>
</event>
 | <link xlink:type="simple" xlink:href="../733/28733.xml">
Steganography</link></col>
</row>
</table>
</col>
</row>
</table>
</col>
</row>
</table>
</p>



</sec>
</bdy>
</entity>
</article>
