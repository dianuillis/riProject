<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 17.04.2009 02:35:57[mciao0825] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<header>
<title>Histogram of oriented gradients</title>
<id>14644226</id>
<revision>
<id>229958731</id>
<timestamp>2008-08-05T10:41:43Z</timestamp>
<contributor>
<username>HenkvD</username>
<id>140348</id>
</contributor>
</revision>
<categories>
<category>Computer vision</category>
<category>Object recognition and categorization</category>
</categories>
</header>
<bdy>

<b>Histogram of Oriented Gradient</b> descriptors, or <b>HOG</b> descriptors, are feature descriptors used in <link xlink:type="simple" xlink:href="../596/6596.xml">
computer vision</link> and <link xlink:type="simple" xlink:href="../332/76332.xml">
image processing</link> for the purpose of <link xlink:type="simple" xlink:href="../591/15822591.xml">
object detection</link>. The technique counts occurrences of gradient orientation in localized portions of an image. This method is similar to that of <link>
edge orientation histograms</link>, <link xlink:type="simple" xlink:href="../345/1208345.xml">
scale-invariant feature transform</link> descriptors, and <link xlink:type="simple" xlink:href="../107/15281107.xml">
shape context</link>s, but differs in that it computes on a dense grid of uniformly spaced cells and uses overlapping local contrast normalization for improved performance. <p>

<link>
Navneet Dalal</link> and <link>
Bill Triggs</link>, researchers for the <link xlink:type="simple" xlink:href="../413/318413.xml">
French National Institute for Research in Computer Science and Control</link> (<link xlink:type="simple" xlink:href="../413/318413.xml">
INRIA</link>), first described Histogram of Oriented Gradient descriptors in their June 2005 paper to the <link>
International Conference on Computer Vision and Pattern Recognition</link>. In this work they focused their algorithm on the problem of pedestrian detection in static images, although since then they expanded their tests to include human detection in film and video, as well as to a variety of common animals and vehicles in static imagery.</p>

<sec>
<st>
Theory</st>
<p>

The essential thought behind the Histogram of Oriented Gradient descriptors is that local object appearance and shape within an image can be described by the distribution of intensity gradients or edge directions. The implementation of these descriptors can be achieved by dividing the image into small connected regions, called cells, and for each cell compiling a histogram of gradient directions or edge orientations for the pixels within the cell. The combination of these histograms then represents the descriptor. For improved performance, the local histograms can be contrast-normalized by calculating a measure of the intensity across a larger region of the image, called a block, and then using this value to normalize all cells within the block. This normalization results in better invariance to changes in illumination or shadowing. </p>
<p>

The Histogram of Oriented Gradients descriptor maintains a few key advantages over other descriptor methods. Since the Histogram of Oriented Gradients descriptor operates on localized cells, the method upholds invariance to geometric and photometric transformations; such changes would only appear in larger spatial regions. Moreover, as Dalal and Triggs observe, coarse spatial sampling, fine orientation sampling, and strong local photometric normalization permits the individual body movement of pedestrians to be ignored so long as they maintain a roughly upright position. The HOG descriptor is thus particularly suited for human detection in images. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%221%22])">1</ref></p>


<p>

Page 8 Figure 6 of the above reference is an example from the Dalal and Triggs human recognition experiment. Part (a) shows the average gradient across their training images. Parts (b) and (c) show the maximum positive and negative SVM weights for each block. Part (d) shows a test image. Part (e) shows the computed R-HOG descriptor for the test image. Parts (f) and (g) show the descriptor weighted by the positive and negative SVM weights.</p>

</sec>
<sec>
<st>
Algorithm Implementation</st>

<ss1>
<st>
Gradient Computation </st>
<p>

The first step of calculation in many feature detectors is image preprocessing to ensure normalized color and gamma values. As Dalal and Triggs point out, however, this step can be omitted in HOG descriptor computation, as the ensuing descriptor normalization essentially achieves the same result. Image preprocessing thus provides little impact on performance. Instead, the first step of calculation is the computation of the gradient values. The most common method is to simply apply the 1-D centered, point discrete <link>
derivative mask</link> in one of or both the horizontal and vertical directions. Specifically, this method requires filtering the color or intensity data of the image with the following filter kernels:</p>
<p>

<math>[-1, 0, 1]</math> and <math>[-1, 0, 1]^T</math></p>
<p>

Dalal and Triggs tested other, more complex masks, such as 3x3 Sobel masks (<link xlink:type="simple" xlink:href="../116/476116.xml">
Sobel operator</link>) or diagonal masks, but these masks generally exhibited poorer performance in human image detection experiments. They also experimented with <link>
Gaussian smoothing</link> before applying the derivative mask, but similarly found that omission of any smoothing performed better in practice. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%222%22])">2</ref></p>

</ss1>
<ss1>
<st>
Orientation Binning</st>
<p>

The second step of calculation involves creating the cell histograms. Each pixel within the cell casts a weighted vote for an orientation-based histogram channel based on the values found in the gradient computation. The cells themselves can either be rectangular or radial in shape, and the histogram channels are evenly spread over 0 to 180 degrees or 0 to 360 degrees, depending on whether the gradient is “unsigned” or “signed”. Dalal and Triggs found that unsigned gradients used in conjunction with 9 histogram channels performed best in their human detection experiments. As for the vote weight, pixel contribution can either be the gradient magnitude itself, or some function of the magnitude; in actual tests the gradient magnitude itself generally produces the best results. Other options for the vote weight could include the square root or square of the gradient magnitude, or some clipped version of the magnitude. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%223%22])">3</ref></p>

</ss1>
<ss1>
<st>
Descriptor Blocks</st>
<p>

In order to account for changes in illumination and contrast, the gradient strengths must be locally normalized, which requires grouping the cells together into larger, spatially-connected blocks. The HOG descriptor is then the vector of the components of the normalized cell histograms from all of the block regions. These blocks typically overlap, meaning that each cell contributes more than once to the final descriptor. Two main block geometries exist: rectangular R-HOG blocks and circular C-HOG blocks. R-HOG blocks are generally square grids, represented by three parameters: the number of cells per block, the number of pixels per cell, and the number of channels per cell histogram. In the Dalal and Triggs human detection experiment, the optimal parameters were found to be 3x3 cell blocks of 6x6 pixel cells with 9 histogram channels. Moreover, they found that some minor improvement in performance could be gained by applying a Gaussian spatial window within each block before tabulating histogram votes in order to weight pixels around the edge of the blocks less. The R-HOG blocks appear quite similar to the <link xlink:type="simple" xlink:href="../345/1208345.xml">
scale-invariant feature transform</link> descriptors; however, despite their similar formation, R-HOG blocks are computed in dense grids at some single scale without orientation alignment, whereas SIFT descriptors are computed at sparse, scale-invariant key image points and are rotated to align orientation. In addition, the R-HOG blocks are used in conjunction to encode spatial form information, while SIFT descriptors are used singly. </p>


<p>

C-HOG blocks can be found in two variants: those with a single, central cell and those with an angularly-divided central cell. In addition, these C-HOG blocks can be described with four parameters: the number of angular and radial bins, the radius of the center bin, and the expansion factor for the radius of additional radial bins. Dalal and Triggs found that the two main variants provided equal performance, and that two radial bins with four angular bins, a center radius of 4 pixels, and an expansion factor of 2 provided the best performance in their experimentation. Also, Gaussian weighting provided no benefit when used in conjunction with the C-HOG blocks. C-HOG blocks appear similar to <link xlink:type="simple" xlink:href="../107/15281107.xml">
Shape Contexts</link>, but differ strongly in that C-HOG blocks contain cells with several orientation channels, while Shape Contexts only make use of a single edge presence count in their formulation. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%224%22])">4</ref></p>

</ss1>
<ss1>
<st>
Block Normalization</st>
<p>

Dalal and Triggs explore four different methods for block normalization. Let <math>v</math> be the non-normalized vector containing all histograms in a given block, <math>||v_k||</math> be its <it>k</it>-norm for <math>k={1,2}</math> and <math>e</math> be some small constant (whose value will not influence the results). Then the normalization factor can be one of the following:</p>
<p>

L2-norm: <math>f = {v \over \sqrt{||v||^2_2+e^2}}</math></p>
<p>

L1-norm: <math>f = {v \over (||v||_1+e)}</math></p>
<p>

L1-sqrt: <math>f = \sqrt{v \over (||v||_1+e)}</math></p>
<p>

In addition, the scheme L2-Hys can be computed by first taking the L2-norm, clipping the result, and then renormalizing. In their experiments, Dalal and Triggs found the L2-Hys, L2-norm, and L1-sqrt schemes provide similar performance, while the L1-norm provides slightly less reliable performance; however, all four methods showed very significant improvement over the non-normalized data. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%225%22])">5</ref></p>

</ss1>
<ss1>
<st>
SVM Classifier</st>
<p>

The final step in object recognition using Histogram of Oriented Gradient descriptors is to feed the descriptors into some recognition system based on supervised learning. The <link xlink:type="simple" xlink:href="../309/65309.xml">
Support Vector Machine</link> classifier is a binary classifier which looks for an optimal hyperplane as a decision function. Once trained on images containing some particular object, the SVM classifier can make decisions regarding the presence of an object, such as a human being, in additional test images. In the Dalal and Triggs human recognition tests, they used the freely available SVMLight software package<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%226%22])">6</ref> in conjunction with their HOG descriptors to find human figures in test images.</p>

</ss1>
</sec>
<sec>
<st>
Testing</st>
<p>

In their original human detection experiment, Dalal and Triggs compared their R-HOG and C-HOG descriptor blocks against <link>
Generalized Haar Wavelets</link>, <link xlink:type="simple" xlink:href="../345/1208345.xml">
PCA-SIFT</link> descriptors, and <link xlink:type="simple" xlink:href="../107/15281107.xml">
Shape Contexts</link>. Generalized Haar Wavelets are oriented Haar wavelets, and were used in 2001 by Mohan, Papageorgiou, and Poggio in their own object detection experiments. PCA-SIFT descriptors are similar to SIFT descriptors, but differ in that <link xlink:type="simple" xlink:href="../340/76340.xml">
Principal Component Analysis</link> is applied to the normalized gradient patches. PCA-SIFT descriptors were first used in 2004 by Ke and Sukthankar and were claimed to outperform regular SIFT descriptors. Finally, Shape Contexts use circular bins, similar to those used in C-HOG blocks, but only tabulate votes on the basis of edge presence, making no distinction with regards to orientation. Shape Contexts were originally used in 2001 by Belongie, Malik, and Puzicha.</p>
<p>

The testing commenced on two different data sets. <link xlink:type="simple" xlink:href="../879/18879.xml">
The Massachusetts Institute of Technology</link> pedestrian database contains 509 training images and 200 test images of pedestrians on city streets. The set only contains images featuring the front or back of human figures and contains little variety in human pose. The set is well-known and has been used in a variety of human detection experiments, such as those conducted by Papageorgiou and Poggio in 2000. The MIT database is currently available for research at http://cbcl.mit.edu/cbcl/software-datasets/PedestrianData.html. The second set was developed by Dalal and Triggs exclusively for their human detection experiment due to the fact that the HOG descriptors performed near-perfectly on the MIT set. Their set, known as INRIA, contains 1805 images of humans taken from personal photographs. The set contains images of humans in a wide variety of poses and includes difficult backgrounds, such as crowd scenes, thus rendering it more complex than the MIT set. The IRNIA database is currently available for research at http://lear.inrialpes.fr/data. </p>


<p>

The above site has an image showing examples from the INRIA human detection database.</p>
<p>

As for the results, the C-HOG and R-HOG block descriptors perform comparatively, with the C-HOG descriptors maintaining a slight advantage in the detection miss rate at fixed false positive rates across both data sets. On the MIT set, the C-HOG and R-HOG descriptors produced a detection miss rate of essentially zero at a <math>10^{-4}</math> false positive rate. On the INRIA set, the C-HOG and R-HOG descriptors produced a detection miss rate of roughly 0.1 at a <math>10^{-4}</math> false positive rate. The Generalized Haar Wavelets represent the next highest performing approach: the wavelets produced roughly a 0.01 miss rate at a <math>10^{-4}</math> false positive rate on the MIT set, and roughly a 0.3 miss rate on the INRIA set. The PCA-SIFT descriptors and Shape Contexts both performed fairly poorly on both data sets. Both methods produced a miss rate of 0.1 at a <math>10^{-4}</math> false positive rate on the MIT set and nearly a miss rate of 0.5 at a <math>10^{-4}</math> false positive rate on the INRIA set. The image below contains the result data from the original Dalal and Triggs experiment. The curves represent the <link>
Detection Error Tradeoff</link> on a log-log scale, which equates to the miss rate versus the false positive rate. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%227%22])">7</ref></p>



</sec>
<sec>
<st>
Further Development</st>
<p>

As part of the <link xlink:type="simple" xlink:href="../068/4068.xml">
Pascal</link> Visual Object Classes 2006 Workshop, Dalal and Triggs presented results on applying Histogram of Oriented Gradient descriptors to image objects other than human beings, such as cars, buses, and bicycles, as well as common animals such as dogs, cats, and cows. They included with their results the optimal parameters for block formulation and normalization in each case. The image in the below reference shows some of their detection examples for motorbikes. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%228%22])">8</ref></p>


<p>

Then as part of the 2006 <link>
European Conference on Computer Vision</link>, Dalal and Triggs teamed up with <link>
Cordelia Schmid</link> to apply Histogram of Oriented Gradient detectors to the problem of human detection in films and videos. Essentially their technique involves the combination of regular HOG descriptors on individual video frames with new Internal Motion Histograms (IMH) on pairs of subsequent video frames. These Internal Motion Histograms use the gradient magnitudes from optical flow fields obtained from two consecutive frames. These gradient magnitudes are then used in the same manner as those produced from static image data within the HOG descriptor approach. When testing on two large datasets taken from several movie DVDs, the combined HOG-IMH method yielded a miss rate of approximately 0.1 at a <math>10^{-4}</math> false positive rate. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%229%22])">9</ref></p>


<p>

At the <link>
Intelligent Vehicles Symposium</link> in 2006, <link>
F. Suard</link>, <link>
A. Rakotomamonjy</link>, and <link>
A. Bensrhair</link> introduced a complete system for pedestrian detection based on HOG descriptors. Their system operates using two infrared cameras. Since human beings appear brighter than their surroundings on infrared images, the system first locates positions of interest within the larger view field where humans could possibly be located. Then normal Support Vector Machine classifiers operate on the HOG descriptors taken from these smaller positions of interest to formulate a decision regarding the presence of a pedestrian. Once pedestrians are located within the view field, the actual position of the pedestrian is estimated using stereovision. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2210%22])">10</ref></p>
<p>

At the <link xlink:type="simple" xlink:href="../938/56938.xml">
IEEE</link> <link>
Conference on Computer Vision and Pattern Recognition</link> in 2006, <link>
Qiang Zhu</link>, <link>
Shai Avidan</link>, <link>
Mei-Chen Yeh</link>, and <link>
Kwang-Ting Cheng</link> presented an algorithm to significantly speed up human detection using HOG descriptor methods. Their method uses HOG descriptors in combination with the <link>
cascade of rejecters</link> algorithm normally applied with great success to the problem of face detection. Also, rather than relying on blocks of uniform size, they introduce blocks that vary in size, location, and aspect ratio. In order to isolate the blocks best suited for human detection, they applied the <event wordnetid="100029378" confidence="0.8">
<rule wordnetid="105846932" confidence="0.8">
<act wordnetid="100030358" confidence="0.8">
<psychological_feature wordnetid="100023100" confidence="0.8">
<procedure wordnetid="101023820" confidence="0.8">
<activity wordnetid="100407535" confidence="0.8">
<algorithm wordnetid="105847438" confidence="0.8">
<link xlink:type="simple" xlink:href="../603/1645603.xml">
AdaBoost</link></algorithm>
</activity>
</procedure>
</psychological_feature>
</act>
</rule>
</event>
 algorithm to select those blocks to be included in the rejecter cascade. In their experimentation, their algorithm achieved comparable performance to the original Dalal and Triggs algorithm, but operated at speeds up to 70 times faster. In April 2006, the Mitsubishi Electric Research Laboratories applied for the U.S. Patent of this algorithm under application number 20070237387. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2211%22])">11</ref></p>

</sec>
<sec>
<st>
References</st>

<p>

<reflist>
<entry id="1">
"<weblink xlink:type="simple" xlink:href="http://www.acemedia.org/aceMedia/files/document/wp7/2005/cvpr05-inria.pdf">
Histograms of Oriented Gradients for Human Detection, pg. 2</weblink>".</entry>
<entry id="2">
"<weblink xlink:type="simple" xlink:href="http://www.acemedia.org/aceMedia/files/document/wp7/2005/cvpr05-inria.pdf">
Histograms of Oriented Gradients for Human Detection, pg. 4</weblink>".</entry>
<entry id="3">
"<weblink xlink:type="simple" xlink:href="http://www.acemedia.org/aceMedia/files/document/wp7/2005/cvpr05-inria.pdf">
Histograms of Oriented Gradients for Human Detection, pg. 5</weblink>".</entry>
<entry id="4">
"<weblink xlink:type="simple" xlink:href="http://www.acemedia.org/aceMedia/files/document/wp7/2005/cvpr05-inria.pdf">
Histograms of Oriented Gradients for Human Detection, pg. 6</weblink>".</entry>
<entry id="5">
"<weblink xlink:type="simple" xlink:href="http://www.acemedia.org/aceMedia/files/document/wp7/2005/cvpr05-inria.pdf">
Histograms of Oriented Gradients for Human Detection, pg. 6</weblink>".</entry>
<entry id="6">
"<weblink xlink:type="simple" xlink:href="http://svmlight.joachims.org/">
SVMlight is an implementation of Support Vector Machines (SVMs) in C</weblink>".</entry>
<entry id="7">
"<weblink xlink:type="simple" xlink:href="http://www.acemedia.org/aceMedia/files/document/wp7/2005/cvpr05-inria.pdf">
Histograms of Oriented Gradients for Human Detection, pg. 4</weblink>".</entry>
<entry id="8">
"<weblink xlink:type="simple" xlink:href="http://www.pascal-network.org/challenges/VOC/voc2006/slides/dalal.pdf">
Object Detection using Histograms of Oriented Gradients</weblink>".</entry>
<entry id="9">
"<weblink xlink:type="simple" xlink:href="http://www.acemedia.org/aceMedia/files/document/wp7/2006/eccv06-inria.pdf">
Human Detection Using Oriented Histograms of Flow and Appearance</weblink>".</entry>
<entry id="10">
"<weblink xlink:type="simple" xlink:href="http://www.ce.unipr.it/people/broggi/publications/iv2006-pd-aziz.pdf">
Pedestrian Detection using Infrared images and Histograms of Oriented Gradients</weblink>".</entry>
<entry id="11">
"<weblink xlink:type="simple" xlink:href="http://shaiavidan.org/papers/IntegralHoG.pdf">
Fast Human Detection Using a Cascade of Histograms of Oriented Gradients</weblink>".</entry>
</reflist>
</p>

</sec>
<sec>
<st>
External links</st>
<p>

<list>
<entry level="1" type="bullet">

 http://www.cs.cmu.edu/~yke/pcasift/ - Code for PCA-SIFT Object Detection</entry>
<entry level="1" type="bullet">

 http://ralyx.inria.fr/2006/Raweb/lear/uid30.html - Software Toolkit for HOG Object Detection</entry>
<entry level="1" type="bullet">

 http://pascal.inrialpes.fr/data/human/ - INRIA Human Image Dataset</entry>
<entry level="1" type="bullet">

 http://cbcl.mit.edu/software-datasets/PedestrianData.html - MIT Pedestrian Image Dataset</entry>
</list>
</p>

</sec>
<sec>
<st>
See also</st>
<p>

<list>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../455/3193455.xml">
Feature (computer vision)</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../224/1284224.xml">
Feature detection (computer vision)</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../190/242190.xml">
Feature extraction</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../669/7046669.xml">
Interest point detection</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../759/4921759.xml">
Corner detection</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../345/1208345.xml">
Scale-Invariant Feature Transform</link></entry>
</list>
</p>

</sec>
</bdy>
</article>
