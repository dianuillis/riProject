<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 17.04.2009 03:55:13[mciao0828] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<know-how  confidence="0.8" wordnetid="105616786">
<method  confidence="0.8" wordnetid="105660268">
<header>
<title>Multiple-try Metropolis</title>
<id>17238630</id>
<revision>
<id>226597222</id>
<timestamp>2008-07-19T08:18:41Z</timestamp>
<contributor>
<username>Dlwh</username>
<id>1798372</id>
</contributor>
</revision>
<categories>
<category>Monte Carlo methods</category>
</categories>
</header>
<bdy>

In <know-how wordnetid="105616786" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../801/236801.xml">
Markov chain Monte Carlo</link></method>
</know-how>
, the <link>
Metropolis–Hastings algorithm</link> (MH) can be used to sample from a <link xlink:type="simple" xlink:href="../543/23543.xml">
probability distribution</link> which is difficult to sample from directly. However, the MH algorithm requires the user to supply a proposal distribution, which can be relatively arbitrary. In many cases, one uses a Gaussian distribution centered on the current point in the probability space, of the form <math>Q(x'; x^t)=N(x^t;\sigma^2 I) \,</math>. This proposal distribution is convenient to sample from and may be the best choice if one has little knowledge about the target distribution, <math>\pi(x) \,</math>. If desired, one can use the more general <link xlink:type="simple" xlink:href="../347/50347.xml">
multivariate normal distribution</link>, <math>Q(x'; x^t)=N(x^t;\mathbf{\Sigma})</math>, where <math>\mathbf{\Sigma}</math> is the covariance matrix which the user believes is similar to the target distribution.<p>

Although this method must converge to the stationary distribution in the limit of infinite sample size, in practice the progress can be exceedingly slow. If <math>\sigma^2 \,</math> is too large, almost all steps under the MH algorithm will be rejected. On the other hand, if <math>\sigma^2 \,</math> is too small, almost all steps will be accepted, and the Markov chain will be similar to a random walk through the probability space. In the simpler case of <math>Q(x'; x^t)=N(x^t;I) \,</math>, we see that <math>N \,</math> steps only takes us a distance of <math>\sqrt{N} \,</math>. In this event, the Markov Chain will not fully explore the probability space in any reasonable amount of time. Thus the MH algorithm requires reasonable tuning of the scale parameter (<math>\sigma^2 \,</math> or <math>\mathbf{\Sigma}</math>).</p>

<sec>
<st>
 Problems with high dimensionality </st>

<p>

Even if the scale parameter is well-tuned, as the dimensionality of the problem increases, progress can still remain exceedingly slow. To see this, again consider <math>Q(x'; x^t)=N(x^t;I) \,</math>. In one dimension, this corresponds to a Gaussian distribution with mean 0 and variance 1. For one dimension, this distribution has a mean step of zero, however the mean squared step size is given by</p>
<p>

<indent level="1">

<math>\langle x^2 \rangle =\int_{-\infty}^{\infty}x^2\frac{1}{\sqrt{2 \pi}}e^{-\frac{x^2}{2}}=1</math>
</indent>

As the number of dimensions increases, the expected step size becomes larger and larger. In <math>N \,</math> dimensions, the probability of moving a radial distance <math>P_n(r) \,</math> is related to the <structure wordnetid="105726345" confidence="0.8">
<arrangement wordnetid="105726596" confidence="0.8">
<distribution wordnetid="105729036" confidence="0.8">
<link xlink:type="simple" xlink:href="../933/1901933.xml">
Chi distribution</link></distribution>
</arrangement>
</structure>
, and is given by</p>
<p>

<indent level="1">

<math>P_n(r) \propto r^{n-1}e^{-r^2/2}</math>
</indent>

This distribution is peaked at <math>r=\sqrt{N-1} \,</math> which is <math>\approx\sqrt{N} \,</math> for large <math>N \,</math>. This means that the step size will increase as the roughly the square root of the number of dimensions. For the MH algorithm, large steps will almost always land in regions of low probability, and therefore be rejected. </p>
<p>

If we now add the scale parameter <math>\sigma^2 \,</math> back in, we find that to retain a reasonable acceptance rate, we must make the transformation <math>\sigma^2 \rightarrow \sigma^2/N</math>. In this situation, the acceptance rate can now be made reasonable, but the exploration of the probability space becomes increasingly slow. To see this, consider a slice along any one dimension of the problem. By making the scale transformation above, the expected step size is any one dimension is not <math>\sigma \,</math> but instead is <math>\sigma/\sqrt{N}</math>. As this step size is much smaller than the "true" scale of the probability distribution (assuming that <math>\sigma \,</math> is somehow known a priori, which is the best possible case), the algorithm executes a random walk along every parameter.</p>

</sec>
<sec>
<st>
 Multiple-try Metropolis </st>

<p>

Liu et al (2000) have suggested a modified MH algorithm, which they call the Multiple-try Metropolis algorithm (MTM), which allows larger step sizes whilst still retaining a reasonable acceptance rate.</p>
<p>

Suppose <math>Q(\mathbf{x},\mathbf{y})</math> is an arbitrary proposal function. We require that <math>Q(\mathbf{x},\mathbf{y})&amp;gt;0</math> only if <math>Q(\mathbf{y},\mathbf{x})&amp;gt;0</math>. Additionally, <math>\pi(\mathbf{x})</math> is the likelihood function.</p>
<p>

Define <math>w(\mathbf{x},\mathbf{y})=\pi(\mathbf{x})Q(\mathbf{x},\mathbf{y})\lambda(\mathbf{x},\mathbf{y})</math> where <math>\lambda(\mathbf{x},\mathbf{y})</math> is a non-negative symmetric function in <math>\mathbf{x}</math> and <math>\mathbf{y}</math> that can be chosen by the user. </p>
<p>

Now suppose the current state is <math>\mathbf{x}</math>. The MTM algorithm is as follows:</p>
<p>

1) Draw <it>k</it> independent trial proposals <math>\mathbf{y}_1,\ldots,\mathbf{y}_k</math> from <math>Q(\mathbf{x},.)</math>. Compute the weights <math>w(\mathbf{y}_j,\mathbf{x})</math> for each of these.</p>
<p>

2) Select <math>\mathbf{y}</math> from the <math>\mathbf{y}_i</math> with probability proportional to the weights. </p>
<p>

3) Now produce a reference set by drawing <math>\mathbf{x}_1,\ldots,\mathbf{x}_{k-1}</math> from the distribution <math>Q(\mathbf{y},.)</math>. Set <math>\mathbf{x}_k=\mathbf{x}</math> (the current point).</p>
<p>

4) Accept <math>\mathbf{y}</math> with probability
<indent level="1">

<math>r=\text{min} \left(1, \frac{ w(\mathbf{y}_1,\mathbf{x} )+ \ldots+ w(\mathbf{y}_k,\mathbf{x}) }{ w(\mathbf{x}_1,\mathbf{y})+ \ldots+ w(\mathbf{x}_k,\mathbf{y}) } \right)</math>
</indent>

It can be shown that this method satisfies the <link xlink:type="simple" xlink:href="../867/2212867.xml">
detailed balance</link> requirement and therefore produces a reversible Markov chain with <math>\pi(\mathbf{x})</math> as the stationary distribution.</p>
<p>

If <math>Q(\mathbf{x},\mathbf{y})</math> is symmetric (as is the case for the <link xlink:type="simple" xlink:href="../347/50347.xml">
multivariate normal distribution</link>), then one can choose <math>\lambda(\mathbf{x},\mathbf{y})=Q^{-1}(\mathbf{x},\mathbf{y})</math>  which gives <math>w(\mathbf{x},\mathbf{y})=\pi(\mathbf{x})</math></p>

</sec>
<sec>
<st>
 See also</st>
<p>

<list>
<entry level="1" type="bullet">

 <know-how wordnetid="105616786" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../801/236801.xml">
Markov chain Monte Carlo</link></method>
</know-how>
</entry>
<entry level="1" type="bullet">

 <link>
Metropolis–Hastings algorithm</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../867/2212867.xml">
Detailed balance</link></entry>
</list>
</p>

</sec>
<sec>
<st>
 References </st>

<p>

<list>
<entry level="1" type="bullet">

 Liu, J. S., Liang, F. and Wong, W. H. (2000). The use of multiple-try method and local optimization in Metropolis sampling, <it>Journal of the American Statistical Association</it>, <b>96</b>(454): 561-573</entry>
</list>
</p>

</sec>
</bdy>
</method>
</know-how>
</article>
