<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 16:25:48[mciao0826] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<operation  confidence="0.8" wordnetid="100955060">
<worm  confidence="0.8" wordnetid="101922303">
<invertebrate  confidence="0.8" wordnetid="101905661">
<event  confidence="0.8" wordnetid="100029378">
<attack  confidence="0.8" wordnetid="100972621">
<act  confidence="0.8" wordnetid="100030358">
<psychological_feature  confidence="0.8" wordnetid="100023100">
<activity  confidence="0.8" wordnetid="100407535">
<animal  confidence="0.8" wordnetid="100015388">
<header>
<title>SQL slammer (computer worm)</title>
<id>174312</id>
<revision>
<id>244675298</id>
<timestamp>2008-10-12T00:10:53Z</timestamp>
<contributor>
<username>Mbac</username>
<id>85704</id>
</contributor>
</revision>
<categories>
<category>Denial-of-service attacks</category>
<category>Exploit-based worms</category>
</categories>
</header>
<bdy>

<table style="background:#f9f9f9; font-size:85%; line-height:110%; ">
<row>
<col>
 <image width="32x28px" src="Portal.svg">
</image>
</col>
<col style="padding:0 0.2em;">
 <b><it>
Computer security&#32;portal</it></b></col>
</row>
</table>
<p>

The <b>SQL slammer worm</b> is a <link xlink:type="simple" xlink:href="../010/6010.xml">
computer worm</link> that caused a <link xlink:type="simple" xlink:href="../776/39776.xml">
denial of service</link> on some <link xlink:type="simple" xlink:href="../539/14539.xml">
Internet</link> hosts and dramatically slowed down general <link xlink:type="simple" xlink:href="../845/856845.xml">
Internet traffic</link>, starting at 05:30 <link xlink:type="simple" xlink:href="../063/32063.xml">
UTC</link> on <link xlink:type="simple" xlink:href="../845/15845.xml">
January 25</link>, <link xlink:type="simple" xlink:href="../163/36163.xml">
2003</link>. It spread rapidly, infecting most of its 75,000 victims within ten minutes. So named by Christopher J. Rouland, the CTO of ISS, Slammer was first brought to the attention of the public by Michael Bacarella - see Notes. Although titled "SQL slammer worm", the program did not use the <programming_language wordnetid="106898352" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../004/29004.xml">
SQL</link></programming_language>
 language; it exploited a <link xlink:type="simple" xlink:href="../373/4373.xml">
buffer overflow</link> bug in Microsoft's flagship <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../994/13989994.xml">
SQL Server</link></software>
 and <system wordnetid="104377057" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<link xlink:type="simple" xlink:href="../939/1609939.xml">
Desktop Engine</link></instrumentality>
</artifact>
</system>
 database products, for which a patch had been released six months earlier in <weblink xlink:type="simple" xlink:href="http://www.microsoft.com/technet/security/bulletin/MS02-039.mspx">
MS02-039</weblink>. Other names include W32.SQLExp.Worm, DDOS.SQLP1434.A, the Sapphire Worm, SQL_HEL, W32/SQLSlammer and Helkern.
</p>
<sec>
<st>
Effect</st>
<p>

Sites monitoring the traffic of the Internet such as <computer wordnetid="103082979" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<machine wordnetid="103699975" confidence="0.8">
<web_site wordnetid="106359193" confidence="0.8">
<link xlink:type="simple" xlink:href="../388/176388.xml">
Internet Storm Center</link></web_site>
</machine>
</device>
</instrumentality>
</artifact>
</computer>
 reported significant slowdowns globally, resembling the effects of the <link xlink:type="simple" xlink:href="../722/174722.xml">
Code Red worm</link> in the summer of 2001.</p>
<p>

<link xlink:type="simple" xlink:href="../467/174467.xml">
Yonhap news agency</link> in <country wordnetid="108544813" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../019/27019.xml">
South Korea</link></country>
 reported that Internet services had been shut down for hours on Saturday, <link xlink:type="simple" xlink:href="../845/15845.xml">
January 25</link>, <link xlink:type="simple" xlink:href="../163/36163.xml">
2003</link> nationwide. The effects were mitigated by the fact that it occurred over the weekend.</p>
<p>

The same attack was reported throughout most of Asia, Europe, and North America. Anti-virus software maker <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../414/354414.xml">
Symantec</link></company>
 estimated that at least 22,000 systems were affected worldwide.   </p>
<p>

The <system wordnetid="104377057" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<link xlink:type="simple" xlink:href="../939/1609939.xml">
Microsoft SQL Server Desktop Engine</link></instrumentality>
</artifact>
</system>
 (MSDE) was affected by the worm and that increased the number of the systems affected. This, together with many home users unaware they have MSDE installed, worsened the effects of this worm. Also, if a computer running MSDE was infected with this worm via the Internet and then connected to a <link xlink:type="simple" xlink:href="../130/147130.xml">
Virtual Private Network</link>, the SQL Servers inside the <link xlink:type="simple" xlink:href="../036/53036.xml">
NAT</link> could be infected.</p>
<p>

According to a <link xlink:type="simple" xlink:href="../851/2917851.xml">
CAIDA</link>-coordinated analysis of the SQL Slammer outbreak, its <link xlink:type="simple" xlink:href="../933/191933.xml">
growth followed an exponential curve</link> with a doubling time of 8.5 seconds in the early phases of the attack, which was only slowed by the collapse of many networks because of the <link xlink:type="simple" xlink:href="../776/39776.xml">
denial of service</link> caused by SQL Slammer's traffic. 90% of all vulnerable machines were infected within 10 minutes, showing that the original estimate for infection speed was roughly correct.</p>

</sec>
<sec>
<st>
 Technical details </st>
<p>

The worm was based on proof of concept code demonstrated at the <social_group wordnetid="107950920" confidence="0.8">
<meeting wordnetid="108307589" confidence="0.8">
<gathering wordnetid="107975026" confidence="0.8">
<convention wordnetid="108309086" confidence="0.8">
<group wordnetid="100031264" confidence="0.8">
<conference wordnetid="108308497" confidence="0.8">
<link xlink:type="simple" xlink:href="../717/2398717.xml">
Black Hat Briefings</link></conference>
</group>
</convention>
</gathering>
</meeting>
</social_group>
 by <physical_entity wordnetid="100001930" confidence="0.8">
<expert wordnetid="109617867" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<specialist wordnetid="110631941" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<link xlink:type="simple" xlink:href="../777/5816777.xml">
David Litchfield</link></causal_agent>
</specialist>
</person>
</expert>
</physical_entity>
, who had initially discovered the buffer overflow vulnerability that the worm exploited.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%221%22])">1</ref> It is a small piece of code that does little other than generate random IP addresses and send itself out to those addresses. If a selected address happens to belong to a host that is running an unpatched copy of <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../994/13989994.xml">
Microsoft SQL Server</link></software>
 Resolution Service, the host immediately becomes infected and begins spraying the Internet with more copies of the worm program.</p>
<p>

Home <link xlink:type="simple" xlink:href="../137/18457137.xml">
PC</link>s are generally not vulnerable to this worm unless they have MSDE installed. The worm is so small that it does not contain code to write itself to disk, so it only stays in memory, and it is easy to remove. For example, Symantec provides a free removal utility (see external link below), or it can even be removed by restarting SQL Server (although the machine would likely be immediately reinfected).</p>
<p>

The worm was made possible by a <link xlink:type="simple" xlink:href="../827/1129827.xml">
software security vulnerability</link> in SQL Server first reported by Microsoft on <link xlink:type="simple" xlink:href="../888/15888.xml">
July 24</link>, <link xlink:type="simple" xlink:href="../502/35502.xml">
2002</link>. A patch had been available from Microsoft for six months prior to the worm's launch, but many installations had not been patched &ndash; including some at Microsoft.  </p>
<p>

The slowdown was caused by the collapse of numerous <link xlink:type="simple" xlink:href="../748/25748.xml">
router</link>s under the burden of extremely high bombardment traffic from infected servers. Normally, when traffic is too high for routers to handle, the routers are supposed to delay or temporarily stop network traffic. Instead, some routers <it>crashed</it> (became unusable), and the "neighbor" routers would notice that these routers had stopped and should not be contacted (aka "removed from the <link xlink:type="simple" xlink:href="../043/48043.xml">
routing table</link>"). Routers started sending notices to this effect to other routers they knew about. The flood of routing table update notices caused some additional routers to fail, compounding the problem. Eventually the crashed routers' maintainers restarted them, causing them to announce their status, leading to another wave of routing table updates. Soon a significant portion of Internet bandwidth was consumed by routers communicating with each other to update their routing tables, and ordinary data traffic slowed down or in some cases stopped altogether. Ironically because the SQL slammer worm was so small in size, sometimes it was able to get through and legitimate traffic was not.</p>
<p>

SQL Slammer was the first observed example of a "<worm wordnetid="101922303" confidence="0.8">
<invertebrate wordnetid="101905661" confidence="0.8">
<animal wordnetid="100015388" confidence="0.8">
<link xlink:type="simple" xlink:href="../373/177373.xml">
Warhol worm</link></animal>
</invertebrate>
</worm>
" &ndash; a fast-propagating Internet infection of the sort first hypothesized in 2002 in a paper by Nicholas Weaver. Two key aspects contributed to SQL Slammer's rapid propagation. The worm infected new hosts over <message wordnetid="106598915" confidence="0.8">
<protocol wordnetid="106665108" confidence="0.8">
<standard wordnetid="107260623" confidence="0.8">
<direction wordnetid="106786629" confidence="0.8">
<rule wordnetid="106652242" confidence="0.8">
<system_of_measurement wordnetid="113577171" confidence="0.8">
<link xlink:type="simple" xlink:href="../929/31929.xml">
UDP</link></system_of_measurement>
</rule>
</direction>
</standard>
</protocol>
</message>
, and the entire worm (only 376 bytes) fits inside a single packet. As a result, no connection was necessary for an infected host to attempt to infect another machine. Each infected host could instead simply "fire and forget" packets as rapidly as possible (generally hundreds per second).</p>

</sec>
<sec>
<st>
 Notes </st>

<p>

There is contention as to who found "Slammer" first. This is nigh on impossible to determine. However, in terms of who first alerted the general public, this can be attributed to <link xlink:type="simple" xlink:href="../375/19737375.xml">
Michael Bacarella</link> who posted a message to the Bugtraq security mailing list entitled "MS SQL WORM IS DESTROYING INTERNET BLOCK PORT 1434!"<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%222%22])">2</ref>. This was sent at 08:11:41 UTC on <link xlink:type="simple" xlink:href="../845/15845.xml">
25 January</link> <link xlink:type="simple" xlink:href="../163/36163.xml">
2003</link>. Ben Koshy is often credited as being the first; indeed the company he worked for put out a press statement to this effect.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%223%22])">3</ref> However, his alert<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%224%22])">4</ref> to the public, sent to the NTBugtraq mailing list was not sent until 10:28 UTC. Robert Boyle sent an alert to NTBugtraq at 08:35 UTC<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%225%22])">5</ref> beating Koshy but lagging behind Bacarella. ISS, through Chris Rouland, sent out alerts at 11:54 UTC<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%226%22])">6</ref> and 11:56 UTC<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%227%22])">7</ref> to the ISSForum and Vulnwatch mailing lists respectively.</p>
<p>

<reflist>
<entry id="1">
http://www.theregister.co.uk/2003/02/06/slammer_why_security_benefits/</entry>
<entry id="2">
<weblink xlink:type="simple" xlink:href="http://seclists.org/bugtraq/2003/Jan/0221.html">
Bugtraq: MS SQL WORM IS DESTROYING INTERNET BLOCK PORT 1434!</weblink></entry>
<entry id="3">
http://www.w3media.com/images/news/W3_Identify_Slammer_Virus.pdf</entry>
<entry id="4">
<weblink xlink:type="simple" xlink:href="http://archives.neohapsis.com/archives/ntbugtraq/2003-q1/0010.html">
NEOHAPSIS - Peace of Mind Through Integrity and Insight</weblink></entry>
<entry id="5">
<weblink xlink:type="simple" xlink:href="http://archives.neohapsis.com/archives/ntbugtraq/2003-q1/0011.html">
NEOHAPSIS - Peace of Mind Through Integrity and Insight</weblink></entry>
<entry id="6">
<weblink xlink:type="simple" xlink:href="http://lists.virus.org/issforum-0301/msg00099.html">
[ISSForum&#93; ISS Security Brief: Microsoft SQL Slammer Worm Propagation</weblink></entry>
<entry id="7">
<weblink xlink:type="simple" xlink:href="http://archives.neohapsis.com/archives/vulnwatch/2003-q1/0038.html">
NEOHAPSIS - Peace of Mind Through Integrity and Insight</weblink></entry>
</reflist>
</p>

</sec>
<sec>
<st>
External links</st>
<p>

<b>News:</b>
<list>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://news.bbc.co.uk/2/hi/technology/2693925.stm">
BBC NEWS Technology Virus-like attack hits web traffic</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://slashdot.org/article.pl?sid=03/01/25/1245206&amp;mode=flat&amp;tid=109">
MS SQL Server Worm Wreaking Havoc</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.wired.com/wired/archive/11.07/slammer.html">
Wired 11.07: Slammed!</weblink> A layman's explanation of the Slammer code.</entry>
</list>
</p>
<p>

<b>Announcement:</b>
<list>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.microsoft.com/technet/security/bulletin/MS02-039.mspx">
Microsoft Security Bulletin MS02-039 and Patch</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.cert.org/advisories/CA-2003-04.html">
CERT Advisory CA-2003-04</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://securityresponse.symantec.com/avcenter/venc/data/w32.sqlexp.worm.html">
Symantec Security Response - W32.SQLExp.Worm</weblink></entry>
</list>
</p>
<p>

<b>Analysis</b>
<list>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.cs.ucsd.edu/~savage/papers/IEEESP03.pdf">
Inside the Slammer Worm</weblink> IEEE Security and Privacy Magazine, David Moore, Vern Paxson, Stefan Savage, Colleen Shannon, Stuart Staniford, and Nicholas Weaver</entry>
</list>
</p>
<p>

<b>Technical details</b>
<list>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.eeye.com/html/Research/Flash/sapphire.txt">
Worm code disassembled</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.cert.org/advisories/CA-2002-22.html">
Multiple Vulnerabilities in Microsoft SQL Server</weblink> - Carnegie-Mellon Software Engineering Institute</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://isc.incidents.org/">
Internet Storm Center</weblink></entry>
</list>
</p>


</sec>
</bdy>
</animal>
</activity>
</psychological_feature>
</act>
</attack>
</event>
</invertebrate>
</worm>
</operation>
</article>
