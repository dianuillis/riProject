<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 18:56:48[mciao0827] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<header>
<title>Windows Media DRM</title>
<id>1783100</id>
<revision>
<id>231029523</id>
<timestamp>2008-08-10T15:08:25Z</timestamp>
<contributor>
<username>AlistairMcMillan</username>
<id>49523</id>
</contributor>
</revision>
<categories>
<category>Microsoft Windows multimedia technology</category>
<category>Digital rights management</category>
</categories>
</header>
<bdy>

<b>Windows Media DRM</b> is a <link xlink:type="simple" xlink:href="../226/18938226.xml">
Digital Rights Management</link> service for the <link xlink:type="simple" xlink:href="../206/441206.xml">
Windows Media</link> platform. It is designed to provide secure delivery of audio and/or video content over an IP network to a PC or other playback device in such a way that the distributor can control how that content is used.<p>

WMDRM includes the following components:
<list>
<entry level="1" type="bullet">

 Windows Media Rights Manager (WMRM) SDK for packaging content and issuing licenses</entry>
<entry level="1" type="bullet">

 Windows Media Format SDK (WMF SDK) for building Windows applications which support DRM and the Windows Media format</entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../012/1818012.xml">
Windows Media DRM for Portable Devices</link> (WMDRM-PD) for supporting offline playback on portable devices</entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../503/5708503.xml">
Windows Media DRM for Network Devices</link> (WMDRM-ND) for streaming protected content to devices attached to a home network</entry>
</list>
</p>

<sec>
<st>
How it works</st>

<p>

In May 2007 Microsoft published the network protocol behind its license acquisition mechanism.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%221%22])">1</ref>  According to the specification, the client software obtains a 7 byte plain-text content key Kcontent from the license server.  The server encrypts the key before transferring it to the client with a globally predefined 160-bit <link xlink:type="simple" xlink:href="../966/9966.xml">
ECC</link> key, ECC1.  The server also sends a content key ID, unencrypted.  The client then uses the Kcontent as an <cipher wordnetid="106254239" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../831/25831.xml">
RC4</link></cipher>
 key to decrypt the licensed media stream.  </p>
<p>

As an anti-spoofing measure, additional fields such as playback rights and a random number are encrypted with 3 more predefined ECC key pairs either by the client or server software:
<list>
<entry level="1" type="bullet">

 client software ECC key pair KC,</entry>
<entry level="1" type="bullet">

 client machine ECC key pair KM,</entry>
<entry level="1" type="bullet">

 server software ECC key pair KS.</entry>
</list>
</p>
<p>

An analysis of version 2 of the DRM scheme in Windows Media Audio revealed that it was using a combination of <link xlink:type="simple" xlink:href="../966/9966.xml">
elliptic curve cryptography</link> key exchange, the <cipher wordnetid="106254239" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../978/7978.xml">
DES</link></cipher>
 <link xlink:type="simple" xlink:href="../594/4594.xml">
block cipher</link>, a custom block cipher dubbed <cipher wordnetid="106254239" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../149/13358149.xml">
MultiSwap</link></cipher>
 (for <link xlink:type="simple" xlink:href="../523/567523.xml">
MACs</link> only), the <link xlink:type="simple" xlink:href="../831/25831.xml">
RC4</link> stream cipher, and the <link xlink:type="simple" xlink:href="../672/26672.xml">
SHA-1</link> hashing function.</p>
<p>

Windows Media DRM is designed to be renewable, that is, it is designed on the assumption that it will be cracked and must be constantly updated by Microsoft. The result is that while the scheme has been cracked several times, it has usually not remained cracked for long.</p>
<p>

<it>Version 1</it> was released in April 1999 and supported basic business rules such as expiration dates. <it>Version 2</it> was released in January 2003 and is also known as version 7.x and 9, to keep in sync with the equivalent versions of <skilled_worker wordnetid="110605985" confidence="0.8">
<physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<editor wordnetid="110044879" confidence="0.8">
<player wordnetid="110439851" confidence="0.8">
<contestant wordnetid="109613191" confidence="0.8">
<worker wordnetid="109632518" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<link xlink:type="simple" xlink:href="../941/43941.xml">
Windows Media Player</link></causal_agent>
</worker>
</contestant>
</player>
</editor>
</person>
</physical_entity>
</skilled_worker>
. <it>Version 3</it>, better known as DRM v10, was released in 2004. Earlier versions of the system have cracks available, meaning content restricted with these versions can have the protections stripped. Version 10 was cracked in early 2005, but a <weblink xlink:type="simple" xlink:href="http://support.microsoft.com/default.aspx?scid=kb;en-us;891122">
software update</weblink> was shortly pushed which sealed the relevant hole. </p>
<p>

Generally, these sorts of cracks have all worked in the same way to a certain extent. Rather than break the encryption itself, which is infeasible, they hook or interfere with the "black box" component as it runs to dump out the content keys or the unencrypted content from memory. These sorts of techniques are countered by Microsoft via automated Windows Updates , which in turn the user may choose to avoid or cancel. Since all Software DRMs ultimately rely on obfuscation rather than true security, as crackers sharpen their tools, they will also improve the speed and quality of their attacks.</p>

</sec>
<sec>
<st>
Interoperability</st>
<p>

The content delivered with the WMDRM encryption is not universally accessible but limited to those users running <link xlink:type="simple" xlink:href="../890/18890.xml">
Microsoft Windows</link>. Microsoft has not reached other markets yet.</p>
<p>

The open network protocol for digital rights management, [MS-DRM] from the <link>
MCPP</link> collection, stipulates that software developers have a right to implement the protocol outside the Microsoft's development tools and environment.</p>

</sec>
<sec>
<st>
Removal</st>
<p>

Tools have been created to strip files of Windows Media DRM, enabling them to be played on non-<link xlink:type="simple" xlink:href="../012/1818012.xml">
Janus</link> platforms.</p>
<p>

It was claimed that one particular tool FairUse4WM (Released on <link xlink:type="simple" xlink:href="../497/1497.xml">
August 19</link>, <link xlink:type="simple" xlink:href="../164/36164.xml">
2006</link>) written by <link xlink:type="simple" xlink:href="../468/7183468.xml">
Viodentia</link> had the ability to strip DRM from files protected with WMDRM <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%222%22])">2</ref>. However, on <link xlink:type="simple" xlink:href="../781/1781.xml">
August 28</link>, <link xlink:type="simple" xlink:href="../164/36164.xml">
2006</link> Microsoft released a new version of the individualized blackbox component (IBX) to prevent this particular tool from working. </p>
<p>

Microsoft also informed partners that they are working to further resolve this issue, given that the fix was also alleged to have been circumvented within days<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%223%22])">3</ref>. Microsoft also issued <link xlink:type="simple" xlink:href="../144/3708144.xml">
takedown</link> notices to web site owners<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%224%22])">4</ref>. They soon followed up by filing lawsuits, <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%225%22])">5</ref> although this has been disputed by the operator of the highest-ranked mirror of the utility, James Holden<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%226%22])">6</ref>, who has not received any such notices or threats.</p>
<p>

As of October 16th, distributors using the Windows Media DRM protection, such as Sky Anytime, are up and running using a patched <link xlink:type="simple" xlink:href="../660/6660.xml">
codec</link>. On April 6, 2007 Microsoft dropped the charges against Viodentia as they were unable to find him to serve him with court papers<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%227%22])">7</ref>. </p>
<p>

On September 6, 2007, Microsoft updated IBX to version 11.0.6000.7000, in an attempt to thwart
circumvention efforts by variants of the original program.</p>
<p>

As of November 28, 2007, DRM Removal under Windows XP on new installs or updated computers (i.e. those that already contain IBX version 11.0.6000.7000), is now not possible without rolling back to Windows Media Player 10. Recently, a patched version of FairUse4WM was released, allowing it to work with Windows Vista, and IBX versions lower than 11.0.6000.6324.</p>

</sec>
<sec>
<st>
References</st>


<p>

<reflist>
<entry id="1">
<weblink xlink:type="simple" xlink:href="http://msdn2.microsoft.com/en-us/library/cc227964.aspx">
[MS-DRM]: Digital Rights Management License Acquisition Data Structure</weblink>, Microsoft Development Network Library, rev. 2.0, March 14, 2008.</entry>
<entry id="2">
"<weblink xlink:type="simple" xlink:href="http://www.engadget.com/2006/08/25/fairuse4wm-strips-windows-media-drm">
Engadget FairUse4WM strips Windows Media DRM!</weblink>".&#32;Retrieved on <link>
2006-08-25</link>.</entry>
<entry id="3">
"<weblink xlink:type="simple" xlink:href="http://www.theregister.co.uk/2006/09/13/microsoft_drm_bskyb1/">
Sky movies paused by DRM security flaw</weblink>".&#32;Retrieved on <link>
2006-09-13</link>.</entry>
<entry id="4">
"<weblink xlink:type="simple" xlink:href="http://arstechnica.com/news.ars/post/20060917-7761.html">
Microsoft tells web site owners to take down FairUse4WM</weblink>".&#32;Retrieved on <link>
2006-09-17</link>.</entry>
<entry id="5">
"<weblink xlink:type="simple" xlink:href="http://www.engadget.com/2006/09/26/microsoft-sues-viodenta-for-copyright-infringement/">
Microsoft sues Viodentia for copyright infringement</weblink>".&#32;Retrieved on <link>
2006-09-26</link>.</entry>
<entry id="6">
"<weblink xlink:type="simple" xlink:href="http://jamesholden.net/2007/04/25/microsoft-didnt-issue-takedown-notices-for-fairuse4wm/">
Microsoft Didn’t Issue Takedown Notices For FairUse4WM</weblink>".</entry>
<entry id="7">
"<weblink xlink:type="simple" xlink:href="http://www.engadget.com/2007/04/06/microsoft-drops-case-against-fairuse4wm-creator-viodentia/">
Microsoft drops case against FairUse4WM creator Viodentia</weblink>".&#32;Retrieved on <link>
2007-04-23</link>.</entry>
</reflist>
</p>


</sec>
<sec>
<st>
See also</st>
<p>

<list>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../012/1818012.xml">
Janus (DRM)</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../503/5708503.xml">
Cardea (DRM)</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../206/441206.xml">
Windows Media</link></entry>
</list>
</p>

</sec>
<sec>
<st>
External links</st>
<p>

<list>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://patft.uspto.gov/netacgi/nph-Parser?patentnumber=7010808">
U.S. Patent 7,010,808</weblink><weblink xlink:type="simple" xlink:href="http://www.pat2pdf.org/pat2pdf/foo.pl?number=7010808">
&nbsp;</weblink>,<weblink xlink:type="simple" xlink:href="http://www.google.com/patents?vid=USPAT7010808&amp;id=iRx4AAAAEBAJ&amp;dq=Windows+Media+DRM+for+Portable+Devices">
Google Patent</weblink></entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.microsoft.com/windows/windowsmedia/drm/default.mspx">
Microsoft Windows Media DRM home page</weblink></entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://forum.doom9.org/showthread.php?t=114916">
FairUse4WM topic-thread on doom9-net forums</weblink></entry>
</list>
</p>


</sec>
</bdy>
</article>
