<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 19:05:50[mciao0828] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<entity  confidence="0.9511911446218017" wordnetid="100001740">
<header>
<title>Substitution model</title>
<id>1937800</id>
<revision>
<id>226862953</id>
<timestamp>2008-07-20T20:19:23Z</timestamp>
<contributor>
<username>DOI bot</username>
<id>6652755</id>
</contributor>
</revision>
<categories>
<category>Stochastic processes</category>
<category>Computational phylogenetics</category>
<category>Bioinformatics</category>
</categories>
</header>
<bdy>

A <b>substitution model</b> describes the process from which a sequence of characters of a fixed size from some <link xlink:type="simple" xlink:href="../670/670.xml">
alphabet</link> changes into another set of traits. For example, in <link xlink:type="simple" xlink:href="../376/5376.xml">
cladistics</link>, each position in the sequence might correspond to a property of a <link xlink:type="simple" xlink:href="../023/28023.xml">
species</link> which can either be present or absent. The alphabet could then consist of "0" for absence and "1" for presence. Then the sequence 00110 could mean, for example, that a species does not have feathers or lay eggs, does have fur, is warm-blooded, and cannot breathe underwater. Another sequence 11010 would mean that a species has feathers, lays eggs, does not have fur, is warm-blooded, and cannot breathe underwater. In <link xlink:type="simple" xlink:href="../962/23962.xml">
phylogenetics</link>, sequences are often obtained by firstly obtaining a <link xlink:type="simple" xlink:href="../535/331535.xml">
nucleotide</link> or <link xlink:type="simple" xlink:href="../659/1107659.xml">
protein sequence</link> <link xlink:type="simple" xlink:href="../289/149289.xml">
alignment</link>, and then taking the <link xlink:type="simple" xlink:href="../505/21505.xml">
bases</link> or <link xlink:type="simple" xlink:href="../207/1207.xml">
amino acid</link>s at corresponding positions in the alignment as the characters. Sequences achieved by this might look like AGCGGAGCTTA and GCCGTAGACGC.<p>

Substitution models are used for a number of things:
<list>
<entry level="1" type="number">

 Constructing <link xlink:type="simple" xlink:href="../326/149326.xml">
evolutionary tree</link>s in phylogenetics or cladistics.</entry>
<entry level="1" type="number">

 Simulating sequences to test other methods and algorithms.</entry>
</list>
</p>

<sec>
<st>
 Neutral, independent, finite sites models </st>
<p>

Most substitution models used to date are neutral, independent, finite sites models.
<list>
<entry level="1" type="definition">

 <link xlink:type="simple" xlink:href="../290/4155290.xml">
Neutral</link> : <link xlink:type="simple" xlink:href="../147/21147.xml">
Selection</link> does not operate on the substitutions, and so they are unconstrained.</entry>
<entry level="1" type="definition">

 <link xlink:type="simple" xlink:href="../593/27593.xml">
Independent</link> : Changes in one site do not affect the probability of changes in another site.</entry>
<entry level="1" type="definition">

 Finite Sites : There are finitely many sites, and so over evolution, a single site can be changed multiple times. This means that, for example, if a character has value 0 at time 0 and at time <it>t</it>, it could be that no changes occurred, or that it changed to a 1 and back to a 0, or that it changed to a 1 and back to a 0 and then to a 1 and then back to a 0, and so on.</entry>
</list>
</p>

</sec>
<sec>
<st>
 The molecular clock and the units of time </st>
<p>

Different substitution models deal with time differently.
<list>
<entry level="1" type="bullet">

It is very common to measure time in substitutions. For example, if one was going to construct a phylogenetic tree while employing a substitution model, one could just measure the distance along the branches of the trees in substitutions. This is convenient because it avoids any question of whether the <link>
rate</link> of substitution with respect to the unit of time has changed or not (because by definition the number of substitutions per substitution is one), and it does not need any information about timescales that could be called into question.</entry>
<entry level="1" type="bullet">

The <link xlink:type="simple" xlink:href="../001/250001.xml">
molecular clock</link> assumption is also very common, namely that the rate of substitutions with respect to time is constant. This is just multiplying factor (usually called <math>\mu</math>, the number of substitutions per unit time) different from measuring time in substitutions. To carry out this type of analysis, one needs to estimate <math>\mu</math> first (which requires knowledge of at least one branch length ahead of time, often a difficult task, which can easily be disputed by others).</entry>
<entry level="1" type="bullet">

The assumption of a molecular clock is often unrealistic, especially across long periods of evolution. For example, even though <link xlink:type="simple" xlink:href="../310/19337310.xml">
rodent</link>s are genetically very similar to <link xlink:type="simple" xlink:href="../984/22984.xml">
primate</link>s, they have undergone a much higher number of substitutions in the estimated time since divergence in some regions of the <link xlink:type="simple" xlink:href="../388/12388.xml">
genome</link><ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%221%22])">1</ref>. This could be due to their shorter <link xlink:type="simple" xlink:href="../437/6713437.xml">
generation time</link><ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%222%22])">2</ref>, higher <link>
metabolic rate</link>, increased population structuring, increased rate of <link xlink:type="simple" xlink:href="../000/29000.xml">
speciation</link>, or smaller <link>
body size</link> <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%223%22])">3</ref><ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%224%22])">4</ref>. When studying events like the <link xlink:type="simple" xlink:href="../161/19349161.xml">
Cambrian explosion</link> under a molecular clock assumption, poor concurrence between <link xlink:type="simple" xlink:href="../376/5376.xml">
cladistic</link> and phylogenetic data is often observed. There has been some work on models allowing variable rate of evolution (see for example <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%225%22])">5</ref> and <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%226%22])">6</ref>).</entry>
</list>
</p>

</sec>
<sec>
<st>
 Time-reversible models </st>
<p>

Most useful substitution models are <link xlink:type="simple" xlink:href="../658/1937658.xml">
time-reversible</link>. In terms of substitution models, this simply means that over time, the relative frequencies of each character do not change.</p>
<p>

For a time reversible model, there is no assumption that substitutions preferentially change in certain directions over time. For example A -&amp;gt; C -&amp;gt; G is the same as G -&amp;gt; C -&amp;gt; A.</p>
<p>

The reason for this is because when an analysis of real biological data is performed, there is generally no access to the sequences of ancestral species, only to the species present today. However, when a model is time-reversible, which species was the ancestral species is irrelevant. Instead, the phylogenetic tree can be rooted along the branch leading to any arbitrary extant species, re-rooted later based on new knowledge, or left unrooted.</p>
<p>

A time reversible model satisfies the following properly
<math> \pi_1Q_{12} = \pi_2Q_{21} </math></p>

</sec>
<sec>
<st>
 The mathematics of substitution models </st>
<p>

Neutral, independent, finite sites models (assuming a constant rate of evolution) have two parameters, <math>\Pi</math>, a vector of base (or character) frequencies at time zero (for a time reversible model, this vector is usually referred to as the equilibrium base frequencies, and applies at all times), and the rate matrix, Q, which describes the rate at which bases of one type change into bases of another type, <math>Q_{ij}</math> for <math> i \ne j</math> is the rate at which base i goes to base j. For convenience, the diagonals of the Q matrix are chosen so the rows sum to zero.</p>
<p>

<math> Q_{ii} = - {\sum_{i\ne j} Q_{ij}} </math></p>
<p>

The transition matrix function is a function from the branch lengths(in some units of time, possibly in substitutions), to a <link xlink:type="simple" xlink:href="../728/19008728.xml">
 matrix</link> of conditional probabilities. It is denoted <math>P(t)</math> The entry in the i-th  column and the j-th row (<math>P_{ij}(t)</math>) is the probability, after time t, that there is a base j at a given position, conditional on there being a i in that position at time 0. When the model is time reversible, this can be performed between any two sequences, even if one is not the ancestor of the other, if you know the total branch length between them.</p>
<p>

The asymptotic properties of <math>P_{ij}(t)</math> are such that <math>\lim_{t \rightarrow 0} P_{ij}(t) = \Pi_{i}</math>, i.e. there is no change in base composition between a sequence and itself, and <math>\lim_{t \rightarrow \infty} P_{ij}(t) = \Pi_{j}</math>, or in other words, as time goes to infinity, the probability of finding base j at a position given there was an i at that position originally goes to the probability that there is base j at that position (regardless of the original base).</p>
<p>

The transition matrix can be computed from the rate matrix and the equilibrium base frequencies by <math>P(t) = e^{Qt}</math>. Since Q is a matrix, this is a matrix exponential, and must be approximated by the <mathematical_relation wordnetid="113783581" confidence="0.8">
<function wordnetid="113783816" confidence="0.8">
<link xlink:type="simple" xlink:href="../448/30448.xml">
Taylor series</link></function>
</mathematical_relation>
 expansion <math>P(t) = \sum_{n=0}^{\infty}{Q^n {{t^n} \over {n!}}}</math>.</p>
<p>

The time reversibility(or stationarity) constraint is <math>\Pi Q = 0</math> (because the rows where defined to sum to zero, and the overall base frequencies must not systematically change from <math>\Pi</math>). This is equivalent to saying <math> \Pi P(t) = \Pi </math> for all t.</p>

</sec>
<sec>
<st>
 GTR: Generalised time reversible </st>
<p>

GTR is the most general neutral, independent, finite-sites, time-reversible model possible. It was first described in a general form by Simon Tavaré in 1986.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%227%22])">7</ref></p>
<p>

The GTR parameters consist of an equilibrium base frequency vector, <math>\Pi = (\pi_1 \pi_2 \pi_3 \pi_4)</math>, giving the frequency at which each base occurs at each site, and the rate matrix</p>
<p>

<indent level="1">

 <math>Q = \begin{pmatrix} {-(x_1+x_2+x_3)} &amp; x_1 &amp; x_2 &amp; x_3 \\ {\pi_1 x_1 \over \pi_2} &amp; {-({\pi_1 x_1 \over \pi_2} + x_4 + x_5)} &amp; x_4 &amp; x_5 \\ {\pi_1 x_2 \over \pi_3} &amp; {\pi_2 x_4 \over \pi_3} &amp; {-({\pi_1 x_2 \over \pi_3} + {\pi_2 x_4 \over \pi_3} + x_6)} &amp; x_6 \\  {\pi_1 x_3 \over \pi_4} &amp; {\pi_2 x_5 \over \pi_4} &amp; {\pi_3 x_6 \over \pi_4} &amp; {-({\pi_1 x_3 \over \pi_4} + {\pi_2 x_5 \over \pi_4} + {\pi_3 x_6 \over \pi_4})} \end{pmatrix} </math>
</indent>

Therefore, GTR (for four characters, as is often the case in phylogenetics) requires 6 substitution rate parameters, as well as 4 equilibrium base frequency parameters. Since the 4 frequency parameters have to sum to 1, there are really only 3 free frequency parameters. This is usually further eliminated down to 8 parameters plus <math>\mu</math>, the overall number of substitutions per unit time. When measuring time in substitutions (<math>\mu</math>=1) only 8 free parameters remain.</p>
<p>

In general, to compute the number of parameters, you count the number of entries above the diagonal in the matrix, i.e. for n trait values per site <math>{{n^2-n} \over 2} </math>, and then add <it>n-1</it> for the equilibrium base frequencies, and subtract 1 because <math>\mu</math> is fixed. You get</p>
<p>

<indent level="1">

 <math>{{n^2-n} \over 2} + (n - 1) - 1 = {1 \over 2}n^2 + {1 \over 2}n - 2.</math>
</indent>

For example, for an amino acid sequence (there are 20 "standard" amino acids that make up <link xlink:type="simple" xlink:href="../634/23634.xml">
proteins</link>), you would find there are 208 parameters. However, when studying coding regions of the genome, it is more common to work with a <link xlink:type="simple" xlink:href="../385/12385.xml">
codon</link> substitution model (a codon is three bases and codes for one amino acid in a protein). There are <math>4^3 = 64</math> codons, resulting in 2078 free parameters, but when the rates for transitions between codons which differ by more than one base are assumed to be zero, then there are only <math>{{20 \times 19 \times 3} \over 2} + 63 - 1 = 632</math> parameters.</p>

</sec>
<sec>
<st>
 Mechanistic vs. empirical models </st>

<p>

A main difference in evolutionary models is how many parameters are estimated every time for the data set under
consideration and how many of them are estimated once on a large data set. 
Mechanistic models describe all substitution as a function of a number of parameters which are estimated for every 
data set analyzed, preferably using <link xlink:type="simple" xlink:href="../806/140806.xml">
maximum likelihood</link>. This has the advantage that the model can be adjusted to the particularities of a specific data set (e.g. different composition biases in DNA). Problems can arise when too many
parameters are used, particularly if they can compensate for each other. Then it is often the case that the data set is too small to yield enough information to estimate all parameters accurately. </p>
<p>

Empirical models are created by estimating many parameters (typically all entries of the rate matrix and the character frequencies, see the GTR model above) from a large data set. These parameters are then fixed and will be
reused for every data set. This has the advantage that those parametes can be estimated more accurately. Normally, it
is not possible to estimate all entries of the substitution matrix from the current data set only. On the downside,
the estimated parameters might be too generic and don't fit a particular data set well enough.</p>
<p>

With the large-scale genome sequencing still producing very large amounts of DNA and protein sequences, there is
enough data available to create empirical models with any number of parameters. Because of the problems mentioned above, the two approaches are often combined, 
by estimating most of the parameters once on large-scale data, while a few remaining parameters are then adjusted to the data set under consideration. The following sections give an overview of the different approaches taken for DNA, protein or codon-based models.</p>

</sec>
<sec>
<st>
 Models of DNA substitution </st>

<p>

See main article: <b><link xlink:type="simple" xlink:href="../924/7025924.xml">
Models of DNA evolution</link></b> for more formal descriptions of the DNA models.</p>
<p>

Models of DNA evolution were first proposed in 1969 by Jukes and Cantor <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%228%22])">8</ref>, assuming equal transition rates as well as equal equilibrium frequencies for all bases. In 1980 Kimura<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%229%22])">9</ref> introduced a model with two parameters: one for the transition and one for the transversion rate and in 1981, Felsenstein<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2210%22])">10</ref> made a model in which the substitution rate corresponds to the equilibrium frequency of the target nucleotide. Hasegawa, Kishino and Yano (HKY)<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2211%22])">11</ref> unified the two last models to a six parameter model. In the 1990s, models similar to the HKY one have been developed and refined by several researchers (e.g. <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2212%22])">12</ref> and <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2213%22])">13</ref>).</p>
<p>

For DNA substitution models, mainly mechanistic models (as described above) are employed. The small number of parameters
to estimate makes this feasible, but also DNA is often highly optimized for specific purposes (e.g. fast <link xlink:type="simple" xlink:href="../266/159266.xml">
expression</link> or stability) depending on the organism and the type of gene, making it necessary to adjust the model to these circumstances.</p>

</sec>
<sec>
<st>
 Models of amino acid substitutions </st>

<p>

For many analyses, particularly for longer evolutionary distances, the evolution is modeled on the amino acid level. Since not
all DNA substitution also alter the encoded amino acid, information is lost when looking at amino acids instead of nucleotide
bases. However, several advantages speak in favor of using the amino acid information: DNA is much more inclined to show 
compositional bias than amino acids, not all positions in the DNA evolve at the same speed (non-<link xlink:type="simple" xlink:href="../905/1260905.xml">
synonymous</link> mutations
are more likely to become fixed in the population than synonymous ones), but probably most important, because of those
fast evolving positions and the limited alphabet size (only four possible states), the DNA suffers much more from back 
substitutions, making it difficult to accurately estimate longer distances.</p>
<p>

Unlike the DNA models, amino acid models traditionally are empirical models. They were pioneered in the 1970s by Dayhoff and co-workers
<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2214%22])">14</ref>, by estimating replacement rates from protein alignments with at least 85% identity. This minimized the chances of observing multiple substitutions at a site. From the estimated rate matrix, a series of replacement probability matrices were derived, known under names such as <link xlink:type="simple" xlink:href="../624/3167624.xml">
PAM</link>250. The Dayhoff model was used to assess the significance of homology search results, but also for phylogenetic analyses. The Dayhoff PAM matrices were based on relatively few alignments (since not more were available at that time), but in the 1990s, new matrices were estimated using almost the same methodology, but based on the large protein databases available then (<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2215%22])">15</ref><ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2216%22])">16</ref>, the latter being known as "JTT" matrices).</p>

</sec>
<sec>
<st>
References</st>

<p>

<reflist>
<entry id="1">
X Gu and W Li (1992): Higher rates of amino acid substitution in rodents than in man. Molecular Phylogenetics and Evolution, 1:211-214. <weblink xlink:type="simple" xlink:href="http://dx.doi.org/10.1016/1055-7903(92)90017-B">
DOI</weblink></entry>
<entry id="2">
WH Li, J Ellsworth, BH Krushkal, J Chang, and D Hewett-Emmett (1996): Rates of nucleotide substitution in primates and rodents and the generation-time effect hypothesis. Molecular Phylogenetics and Evolution, 5:182-187. <weblink xlink:type="simple" xlink:href="http://dx.doi.org/10.1006/mpev.1996.0012">
DOI</weblink></entry>
<entry id="3">
AP Martin and SR Palumbi (1993): Body size, metabolic rate, generation time, and the molecular clock. Proceedings of the National Academy of Science, USA, 90:4087-4091. <weblink xlink:type="simple" xlink:href="http://www.pnas.org/cgi/content/abstract/90/9/4087">
PNAS</weblink></entry>
<entry id="4">
Z Yang and R Nielsen (1998): Synonymous and nonsynonymous rate variation in nuclear genes of mammals. Journal of Molecular Evolution, 46:409-418. <weblink xlink:type="simple" xlink:href="http://dx.doi.org/10.1007/PL00006320">
DOI</weblink></entry>
<entry id="5">
H Kishino, JL Thorne and WJ Bruno (2001): Performance of a divergence estimation method under a probabilistic model of rate evolution. Molecular Biology and Evolution 18: 352-361.<weblink xlink:type="simple" xlink:href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=pubmed&amp;dopt=Abstract&amp;list_uids=11230536&amp;itool=iconfft&amp;query_hl=18&amp;itool=pubmed_docsum">
 PubMed</weblink></entry>
<entry id="6">
JL Thorne, H Kishino and IS Painter (1998): Estimating the rate of evolution of the rate of molecular evolution: Molecular Biology and Evolution 15: 1647-1657. <weblink xlink:type="simple" xlink:href="http://mbe.oxfordjournals.org/cgi/content/abstract/15/12/1647">
MBE</weblink></entry>
<entry id="7">
 <cite style="font-style:normal">Tavaré S.&#32;"<weblink xlink:type="simple" xlink:href="http://www-hto.usc.edu/people/stavare/STpapers-pdf/T86.pdf">
Some Probabilistic and Statistical Problems in the Analysis of DNA Sequences</weblink>". <it>American Mathematical Society: Lectures on Mathematics in the Life Sciences</it>&#32;<b>17</b>: 57–86.</cite>&nbsp;</entry>
<entry id="8">
Jukes, TH and Cantor, CR. 1969. Evolution of protein molecules. Pp. 21-123 in H. N. Munro, ed. <it>Mammalian protein metabolism</it>. Academic Press, New York.</entry>
<entry id="9">
Kimura, M. 1980. A simple method for estimating evolutionary rate of base substitution through comparative studies of nucleotide sequences. <it>Journal of Molecular Evolution</it> <b>16</b>:111-120. <weblink xlink:type="simple" xlink:href="http://dx.doi.org/10.1007/BF01731581">
DOI</weblink></entry>
<entry id="10">
Felsenstein, J. 1981. Evolutionary trees from DNA sequences: a maximum likelihood approach. <it>Journal of Molecular Evolution</it> <b>17</b>:368-376. <weblink xlink:type="simple" xlink:href="http://dx.doi.org/10.1007/BF01734359">
DOI</weblink></entry>
<entry id="11">
Hasegawa, M., Kishino, H  and Yano, T. 1985. Dating the human-ape splitting by a molecular clock of mitochondrial DNA. <it>Journal of Molecular Evolution</it> <b>22</b>:160-174. <weblink xlink:type="simple" xlink:href="http://dx.doi.org/10.1007/BF02101694">
DOI</weblink></entry>
<entry id="12">
Tamura, K. 1992. Estimation of the number of nucleotide substitutions when there are strong transition-transversion and G+C content biases. <it>Molecular Biology and Evolution</it> <b>9</b>:678-687. <weblink xlink:type="simple" xlink:href="http://mbe.oxfordjournals.org/cgi/content/abstract/9/4/678">
MBE</weblink></entry>
<entry id="13">
Tamura, K., and M. Nei. 1993. Estimation of the number of nucleotide substitutions in the control region of mitochondrial DNA in humans and chimpanzees. <it>Molecular Biology and Evolution</it> <b>10</b>:512-526. <weblink xlink:type="simple" xlink:href="http://mbe.oxfordjournals.org/cgi/content/abstract/10/3/512">
MBE</weblink></entry>
<entry id="14">
 <cite style="font-style:normal">Dayhoff MO, Schwartz RM, Orcutt BC&#32;(1978).&#32;"A model for evolutionary change in proteins". <it>Atlas of Protein Sequence and Structure</it>&#32;<b>5</b>: 345–352.</cite>&nbsp;</entry>
<entry id="15">
 <cite style="font-style:normal">Gonnet GH, Cohen MA, Benner SA&#32;(1992).&#32;"Exhaustive matching of the entire protein sequence database". <it>Science</it>&#32;<b>256</b>: 1443–1445. <document wordnetid="106470073" confidence="0.8">
<written_communication wordnetid="106349220" confidence="0.8">
<writing wordnetid="106362953" confidence="0.8">
<link xlink:type="simple" xlink:href="../994/422994.xml">
doi</link></writing>
</written_communication>
</document>
:<weblink xlink:type="simple" xlink:href="http://dx.doi.org/10.1126%2Fscience.1604319">
10.1126/science.1604319</weblink>. PMID 1604319.</cite>&nbsp;</entry>
<entry id="16">
 <cite style="font-style:normal">Jones DT, Taylor WR, Thornton JM&#32;(1992).&#32;"The rapid generation of mutation data matrices from protein sequences". <it>Comput Applic Biosci</it>&#32;<b>8</b>: 275–282.</cite>&nbsp;</entry>
</reflist>
</p>

</sec>
</bdy>
</entity>
</article>
