<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 16:34:23[mciao0826] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<entity  confidence="0.9511911446218017" wordnetid="100001740">
<header>
<title>Rootkit</title>
<id>223942</id>
<revision>
<id>244261117</id>
<timestamp>2008-10-10T00:22:56Z</timestamp>
<contributor>
<username>Senachie</username>
<id>3100761</id>
</contributor>
</revision>
<categories>
<category>Rootkits</category>
<category>Malware</category>
</categories>
</header>
<bdy>

A <b>rootkit</b> is a <link>
computer virus</link> which consists of a <link xlink:type="simple" xlink:href="../783/5783.xml">
program</link> (or combination of several programs) designed to take fundamental control (in <family wordnetid="108078020" confidence="0.8">
<link xlink:type="simple" xlink:href="../642/31642.xml">
Unix</link></family>
 terms "root" access, in <link xlink:type="simple" xlink:href="../890/18890.xml">
Windows</link> "Administrator" access) of a computer system, without authorization by the system's owners and legitimate managers. Access to the hardware (e.g., the reset switch) is rarely required as a rootkit is intended to seize control of the operating system running on the hardware. Typically, rootkits act to obscure their presence on the system through subversion or evasion of standard operating system <link xlink:type="simple" xlink:href="../398/7398.xml">
security</link> mechanisms. Often, they are  <link xlink:type="simple" xlink:href="../056/30056.xml">
Trojan</link>s as well, thus fooling users into believing they are safe to run on their systems. Techniques used to accomplish this can include concealing running processes from monitoring programs, or hiding files or system data from the <link xlink:type="simple" xlink:href="../194/22194.xml">
operating system</link>.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%221%22])">1</ref> <p>

Rootkits may have originated as regular applications, intended to take control of a failing or unresponsive system, but in recent years have been largely <link xlink:type="simple" xlink:href="../901/20901.xml">
malware</link> to help intruders gain access to systems while avoiding detection. Rootkits exist for a variety of operating systems, such as <link xlink:type="simple" xlink:href="../890/18890.xml">
Microsoft Windows</link>, <O wordnetid="106832680" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../297/6097297.xml">
Linux</link></O>
, <link xlink:type="simple" xlink:href="../043/20043.xml">
Mac OS</link>,  and <message wordnetid="106598915" confidence="0.8">
<information wordnetid="106634376" confidence="0.8">
<electronic_database wordnetid="106588511" confidence="0.8">
<lexical_database wordnetid="106638868" confidence="0.8">
<wordnet wordnetid="106639428" confidence="0.8">
<database wordnetid="106637824" confidence="0.8">
<link xlink:type="simple" xlink:href="../145/46145.xml">
Solaris</link></database>
</wordnet>
</lexical_database>
</electronic_database>
</information>
</message>
. Rootkits often modify parts of the operating system or install themselves as <link xlink:type="simple" xlink:href="../101/9101.xml">
drivers</link> or <link xlink:type="simple" xlink:href="../658/371658.xml">
kernel modules</link>, depending on the internal details of an operating system's mechanisms.</p>

<sec>
<st>
History</st>
<p>

The term <it>rootkit</it> or <it>root kit</it> originally referred to a maliciously modified set of administrative tools for a <family wordnetid="108078020" confidence="0.8">
<link xlink:type="simple" xlink:href="../642/31642.xml">
Unix</link></family>
-like <link xlink:type="simple" xlink:href="../194/22194.xml">
operating system</link>. If an intruder could replace the standard administrative tools on a system with a rootkit, the modified tools would give the intruder administrative control over the system while concealing his activities from the legitimate <link xlink:type="simple" xlink:href="../985/154985.xml">
system administrator</link>. The earliest known rootkit was written circa 1990 by Lane Davis and Steven Dake for <O wordnetid="106832680" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../071/29071.xml">
SunOS</link></O>
 4.1.1. There was an earlier, quite famous, exploit equivalent to a rootkit which was perpetrated by <person wordnetid="100007846" confidence="0.9508927676800064">
<scientist wordnetid="110560637" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../747/10817747.xml">
Ken Thompson</link></scientist>
</person>
 of <link xlink:type="simple" xlink:href="../712/3712.xml">
Bell Labs</link> against a Naval Laboratory in California to win a bet. Thompson subverted the C compiler in a distribution of Unix to the Lab.</p>
<p>

Rootkits were so named because they allowed an intruder to become a <link xlink:type="simple" xlink:href="../209/264209.xml">
root user</link> (ie, the system administrator) of a Unix system. Since then, similar software has been developed for other operating systems, and the term <it>rootkit</it> has been broadened to include any software that surreptitiously alters an operating system so that an unauthorized user can take arbitrary control of the system.</p>
<p>

In 2005, <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../671/895671.xml">
Sony BMG</link></company>
 caused a <link xlink:type="simple" xlink:href="../826/3174826.xml">
scandal</link> by including rootkit software on music <link xlink:type="simple" xlink:href="../429/6429.xml">
CDs</link> that, in an attempt to enforce <link xlink:type="simple" xlink:href="../226/18938226.xml">
DRM</link>,<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%222%22])">2</ref> inadvertently opened a <link xlink:type="simple" xlink:href="../788/360788.xml">
backdoor</link> that allowed root access to anyone aware of the rootkit's installation.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%223%22])">3</ref> The scandal raised the public's awareness of rootkits, while the public relations fallout for Sony was compared by one analyst to the <termination wordnetid="100209943" confidence="0.8">
<murder wordnetid="100220522" confidence="0.8">
<homicide wordnetid="100220023" confidence="0.8">
<condition wordnetid="113920429" confidence="0.8">
<change wordnetid="100191142" confidence="0.8">
<wrongdoing wordnetid="100732746" confidence="0.8">
<state wordnetid="100024720" confidence="0.8">
<adversity wordnetid="114475661" confidence="0.8">
<catastrophe wordnetid="114476290" confidence="0.8">
<fortune wordnetid="114473222" confidence="0.8">
<change_of_state wordnetid="100199130" confidence="0.8">
<misfortune wordnetid="114475405" confidence="0.8">
<transgression wordnetid="100745005" confidence="0.8">
<crime wordnetid="100766234" confidence="0.8">
<event wordnetid="100029378" confidence="0.8">
<action wordnetid="100037396" confidence="0.8">
<act wordnetid="100030358" confidence="0.8">
<psychological_feature wordnetid="100023100" confidence="0.8">
<activity wordnetid="100407535" confidence="0.8">
<killing wordnetid="100219012" confidence="0.8">
<link xlink:type="simple" xlink:href="../675/330675.xml">
Tylenol scare</link></killing>
</activity>
</psychological_feature>
</act>
</action>
</event>
</crime>
</transgression>
</misfortune>
</change_of_state>
</fortune>
</catastrophe>
</adversity>
</state>
</wrongdoing>
</change>
</condition>
</homicide>
</murder>
</termination>
.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%224%22])">4</ref></p>

</sec>
<sec>
<st>
Common use</st>
<p>

A successfully installed rootkit allows unauthorized users to act as system administrators, and thus to take full control of the 'rootkitted', or 'rooted' system. Secondary to this purpose, most rootkits typically hide files, network connections, blocks of memory, or <record wordnetid="106647206" confidence="0.8">
<idea wordnetid="105833840" confidence="0.8">
<concept wordnetid="105835747" confidence="0.8">
<component wordnetid="105868954" confidence="0.8">
<file wordnetid="106508816" confidence="0.8">
<indication wordnetid="106797169" confidence="0.8">
<evidence wordnetid="106643408" confidence="0.8">
<part wordnetid="105867413" confidence="0.8">
<link xlink:type="simple" xlink:href="../933/1164933.xml">
Windows Registry</link></part>
</evidence>
</indication>
</file>
</component>
</concept>
</idea>
</record>
 entries from other programs used by system administrators to detect specially privileged accesses to computer system resources. However, a rootkit may masquerade as or be intertwined with other files, programs, or libraries with other purposes. It is important to note that while the utilities bundled with a rootkit may be maliciously intended, not every rootkit is always malicious. Rootkits may be used for both productive and destructive purposes.</p>
<p>

A rootkit which hides utility programs, usually does so to abuse a compromised system, and often include so-called "<technique wordnetid="105665146" confidence="0.8">
<know-how wordnetid="105616786" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../788/360788.xml">
backdoor</link></method>
</know-how>
</technique>
s" to help the attacker subsequently access at will. A simple example might be a rootkit which hides an application that spawns a <link xlink:type="simple" xlink:href="../397/2281397.xml">
command processing shell</link> when the attacker connects to a particular network <link xlink:type="simple" xlink:href="../331/4971331.xml">
port</link> on the system. <link xlink:type="simple" xlink:href="../394/50394.xml">
Kernel</link> rootkits may include similar functionality. A backdoor may also allow processes started by a <link xlink:type="simple" xlink:href="../226/1695226.xml">
non-privileged user</link> to run as though it were started by a <link xlink:type="simple" xlink:href="../985/154985.xml">
privileged user</link> (including the root user) and to carry out functions normally reserved for the superuser. </p>
<p>

Many other utility tools useful for abuse can be hidden using rootkits. This includes tools for further attacks against computer systems with which the compromised system communicates, such as <link xlink:type="simple" xlink:href="../114/59114.xml">
sniffers</link> and <link xlink:type="simple" xlink:href="../829/57829.xml">
keylogger</link>s. A possible abuse is to use a compromised computer as a staging ground for further abuse (see <link xlink:type="simple" xlink:href="../566/531566.xml">
zombie computer</link>). This is often done to make the abuse appear to originate from the compromised system (or network) instead of the attacker's. Tools for such attacks can include <link xlink:type="simple" xlink:href="../776/39776.xml">
denial-of-service attack</link> tools, tools to relay <link xlink:type="simple" xlink:href="../390/40390.xml">
chat</link> sessions, and <link xlink:type="simple" xlink:href="../738/9738.xml">
e-mail</link> <link xlink:type="simple" xlink:href="../368/28368.xml">
spam</link> distribution. A major malicious use for rootkits is to allow the rootkit's programmer to see and access user names and log-in information of systems requiring them. Collection of such information from many systems (thousands or more) is easily possible. This makes rootkits even more hazardous, as it allows trojans to access this personal information while the rootkit covers it up.</p>
<p>

It has become increasingly popular for virus writers to make use of rootkit technologies. The reason for this is that they make it possible to hide malware from PC users and <link xlink:type="simple" xlink:href="../622/268622.xml">
antivirus programs</link>. Numerous <link xlink:type="simple" xlink:href="../661/27661.xml">
source code</link> samples for ready-made rootkits can be found on the Internet, which inevitably leads to their widespread use in various trojans or spyware programs etc.</p>
<p>

However, rootkits are not always used to attack and gain control of a computer. Some software may use rootkit techniques to hide from 3rd party scanners to detect tampering or attempted breakins, for example in a <link xlink:type="simple" xlink:href="../952/287952.xml">
honeypot</link>. Some emulation software and security software is known to be using rootkits.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%225%22])">5</ref> <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../814/700814.xml">
Alcohol 120%</link></software>
 and <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<copycat wordnetid="109964411" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<link xlink:type="simple" xlink:href="../305/1041305.xml">
Daemon Tools</link></causal_agent>
</copycat>
</person>
</physical_entity>
 are commercial examples of the use of non-hostile rootkits.</p>
<p>

Rootkit is a term now somewhat loosely applied to cloaking techniques and methods.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%226%22])">6</ref></p>

</sec>
<sec>
<st>
Types</st>
<p>

There are at least five kinds of rootkits: <link xlink:type="simple" xlink:href="../155/41155.xml">
firmware</link>, <link xlink:type="simple" xlink:href="../353/32353.xml">
virtualized</link>, <link xlink:type="simple" xlink:href="../394/50394.xml">
kernel</link>, <link xlink:type="simple" xlink:href="../421/106421.xml">
library</link>, and <link xlink:type="simple" xlink:href="../746/454746.xml">
application</link> level kits. </p>

<ss1>
<st>
Firmware</st>
<p>

A firmware rootkit uses device or platform <link xlink:type="simple" xlink:href="../155/41155.xml">
firmware</link> to create a persistent malware image. The rootkit can successfully hide in firmware because firmware is not often inspected for code integrity. John Heasman demonstrated the viability of firmware rootkits in both ACPI firmware routines<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%227%22])">7</ref> and in a PCI expansion card ROM.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%228%22])">8</ref></p>

</ss1>
<ss1>
<st>
Hypervisor level</st>
<p>

These rootkits work by modifying the boot sequence of the machine to load themselves as a <link xlink:type="simple" xlink:href="../216/1267216.xml">
hypervisor</link> under the original operating system.  By exploting hardware features such as <link xlink:type="simple" xlink:href="../179/996179.xml">
Intel VT</link> or <link xlink:type="simple" xlink:href="../179/996179.xml">
AMD-V</link>, the rootkit is able to load the original operating system as a <link xlink:type="simple" xlink:href="../353/32353.xml">
virtual machine</link>, thereby enabling it to intercept all hardware calls made by the original operating system, which is now a guest. The "SubVirt" laboratory rootkit, developed jointly by <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../001/19001.xml">
Microsoft</link></company>
 and <university wordnetid="108286163" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../740/31740.xml">
University of Michigan</link></university>
 researchers, is an academic example of a virtual machine based rootkit (VMBR)<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%229%22])">9</ref>, while <link xlink:type="simple" xlink:href="../272/6669272.xml">
 Blue Pill</link> is another.</p>

</ss1>
<ss1>
<st>
Kernel level</st>
<p>

Kernel-level rootkits add additional code and/or replace portions of an operating system, including both the <link xlink:type="simple" xlink:href="../394/50394.xml">
kernel</link> and associated <link xlink:type="simple" xlink:href="../101/9101.xml">
device driver</link>s.  Most operating systems support <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<model wordnetid="110324560" confidence="0.8">
<assistant wordnetid="109815790" confidence="0.8">
<worker wordnetid="109632518" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<link xlink:type="simple" xlink:href="../185/3446185.xml">
kernel-mode</link></causal_agent>
</worker>
</assistant>
</model>
</person>
</physical_entity>
 device drivers, that execute with the same privileges as the operating system itself.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2210%22])">10</ref>  As such, many kernel mode rootkits are developed as device drivers or loadable modules, such as <link xlink:type="simple" xlink:href="../658/371658.xml">
loadable kernel modules</link> in <O wordnetid="106832680" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../297/6097297.xml">
Linux</link></O>
 or <link xlink:type="simple" xlink:href="../101/9101.xml">
device driver</link>s in <link xlink:type="simple" xlink:href="../890/18890.xml">
Microsoft Windows</link>. This class of rootkit is perceived as dangerous simply because of the unrestricted security access the code has obtained, regardless of the features the rootkit may employ.  Any code operating at the kernel level may have serious impacts on entire system stability if bugs are present in the code.  The first and original rootkits did not operate at the kernel level, but were simple replacements of standard programs at the user level. One of the first widely known kernel rootkit was developed for <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../680/795680.xml">
Windows NT 4.0</link></version>
 and released in <work wordnetid="104599396" confidence="0.8">
<product wordnetid="104007894" confidence="0.8">
<magazine wordnetid="106595351" confidence="0.8">
<print_media wordnetid="106263609" confidence="0.8">
<creation wordnetid="103129123" confidence="0.8">
<press wordnetid="106263369" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<medium wordnetid="106254669" confidence="0.8">
<publication wordnetid="106589574" confidence="0.8">
<link xlink:type="simple" xlink:href="../076/37076.xml">
Phrack</link></publication>
</medium>
</instrumentality>
</artifact>
</press>
</creation>
</print_media>
</magazine>
</product>
</work>
 <weblink xlink:type="simple" xlink:href="http://phrack.org/issues.html?issue=55&amp;id=5">
issue 55</weblink> in the mid-1990s by <link xlink:type="simple" xlink:href="../782/19365782.xml">
Greg Hoglund</link>.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2211%22])">11</ref></p>
<p>

Kernel rootkits can be especially difficult to detect and remove because they operate at the same <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<model wordnetid="110324560" confidence="0.8">
<assistant wordnetid="109815790" confidence="0.8">
<worker wordnetid="109632518" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<link xlink:type="simple" xlink:href="../185/3446185.xml">
level</link></causal_agent>
</worker>
</assistant>
</model>
</person>
</physical_entity>
 as the operating system itself, and are thus able to intercept or subvert any operation made by the operating system itself.  Any software, such <link xlink:type="simple" xlink:href="../622/268622.xml">
antivirus software</link>, running on the comprised system is equally easily subverted.  In a situation such as this, the whole system can no longer be trusted.  One response in such a case is to perform system offline analysis from a second 'trusted' system by mounting the hard drive of the infected system as a secondary resource without executing anything on the untrusted volume, while another is to format the disk and re-install from trusted media.</p>

</ss1>
<ss1>
<st>
Library level</st>
<p>

Library rootkits commonly <link xlink:type="simple" xlink:href="../153/475153.xml">
patch</link>, <link xlink:type="simple" xlink:href="../077/2953077.xml">
hook</link>, or replace <link xlink:type="simple" xlink:href="../908/102908.xml">
system call</link>s with versions that hide information about the attacker. They can be found, at least theoretically, by examining code libraries (under Windows the term is usually <format wordnetid="106636806" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../077/2701077.xml">
DLL</link></format>
) for changes or against the originally distributed (and so presumably rootkit free) library package; this approach may not succeed however if the code is patched in memory only. <link xlink:type="simple" xlink:href="../644/59644.xml">
Digital signatures</link> help to detect unauthorised changes to code libraries.<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2212%22])">12</ref></p>

</ss1>
<ss1>
<st>
Application level</st>
<p>

Application level rootkits may replace regular application binaries with <link xlink:type="simple" xlink:href="../056/30056.xml">
Trojan</link> fakes, or they may modify the behavior of existing applications using hooks, patches, injected code, or other means.</p>

</ss1>
</sec>
<sec>
<st>
Detection</st>
<p>

Rootkit binaries can often be detected by signature or heuristics based antivirus programs, at least until they're run by a user and are able to attempt to conceal themselves. There are inherent limitations for any program that attempts to detect rootkits while the program is running under the suspect system. Rootkits are suites of programs that modify many of the core operating system tools and libraries upon which all programs on the system depend. Some rootkits attempt to modify the running <link xlink:type="simple" xlink:href="../394/50394.xml">
kernel</link> via loadable modules on Linux (and some other UNIX varieties), and through <idea wordnetid="105833840" confidence="0.8">
<concept wordnetid="105835747" confidence="0.8">
<component wordnetid="105868954" confidence="0.8">
<part wordnetid="105867413" confidence="0.8">
<link xlink:type="simple" xlink:href="../633/222633.xml">
VxD</link></part>
</component>
</concept>
</idea>
s, virtual external <link xlink:type="simple" xlink:href="../101/9101.xml">
device driver</link>s on MS Windows platforms. The fundamental problem with rootkit detection is that if the operating system currently running has been subverted, it cannot be trusted, including to find unauthorized modifications to itself or its components. In other words, actions such as requesting a list of all running processes, or a list of all files in a directory, cannot be trusted to behave as intended by the original designers. Rootkit detectors running on live systems currently only work because the rootkits they can detect have not yet been developed to hide themselves fully against these detectors.</p>
<p>

The best, and most reliable, method for rootkit detection is to shut down the computer suspected of infection, and then check its secondary <link xlink:type="simple" xlink:href="../300/5300.xml">
storage</link> by <link xlink:type="simple" xlink:href="../909/40909.xml">
booting</link> from an alternative medium (e.g., a rescue <recording wordnetid="104063868" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<sound_recording wordnetid="104262678" confidence="0.8">
<memory_device wordnetid="103744840" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<phonograph_record wordnetid="103924069" confidence="0.8">
<medium wordnetid="106254669" confidence="0.8">
<link xlink:type="simple" xlink:href="../902/18959902.xml">
CD-ROM</link></medium>
</phonograph_record>
</device>
</memory_device>
</sound_recording>
</instrumentality>
</artifact>
</recording>
 or <artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<medium wordnetid="106254669" confidence="0.8">
<link xlink:type="simple" xlink:href="../414/400414.xml">
USB flash drive</link></medium>
</device>
</instrumentality>
</artifact>
). A non-running rootkit cannot actively hide its presence, and most established antivirus programs will identify rootkits armed via standard OS calls (which are often tampered with by the rootkit) and lower level queries, which ought to remain reliable. If there is a difference, the presence of a rootkit infection should be assumed. Running rootkits attempt to protect themselves by monitoring running processes and suspending their activity until the scanning has finished; this is more difficult if the rootkit is not allowed to run. </p>
<p>

Security software vendors have attempted a solution by integrating rootkit detection into traditional antivirus products. Should a rootkit decide to hide during scanning, it will be identified by the stealth detector. If it decides to temporarily unload from the system, the traditional antivirus will find it using fingerprint detection. Since anti-virus products are almost never entirely capable of catching all viruses in public tests, this approach may be doubted on past behavior. But this combined approach may force attackers to implement counter-attack mechanisms (so called retro routines) in their rootkit code that will forcibly remove security software processes from memory, effectively killing the antivirus program. As with <link xlink:type="simple" xlink:href="../196/18994196.xml">
computer virus</link>es, the detection and elimination of rootkits will be an ongoing struggle between tool creators on both sides of this conflict. </p>
<p>

There are several programs available to detect rootkits. On Unix-based systems, three of the most popular are <link xlink:type="simple" xlink:href="../310/2081310.xml">
chkrootkit</link>, <link xlink:type="simple" xlink:href="../588/2246588.xml">
rkhunter</link> and <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../472/8913472.xml">
OSSEC</link></software>
. For Windows, there are many free detection tools such as <weblink xlink:type="simple" xlink:href="http://www.sophos.com/products/free-tools/sophos-anti-rootkit.html">
Sophos Anti-Rootkit</weblink>, <weblink xlink:type="simple" xlink:href="http://www.f-secure.co.uk/blacklight/blacklight.html">
F-Secure Blacklight</weblink>, <weblink xlink:type="simple" xlink:href="http://northsecuritylabs.com/">
Hypersight Rootkit Detector</weblink> or <weblink xlink:type="simple" xlink:href="http://www.usec.at/rootkit.html">
Radix Anti-Rootkit</weblink>. Another Windows detector is <link xlink:type="simple" xlink:href="../473/3152473.xml">
RootkitRevealer</link> from <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../001/19001.xml">
Microsoft</link></company>
 (formerly <link xlink:type="simple" xlink:href="../147/3370147.xml">
Sysinternals</link>) which detects rootkits by comparing results from the <link xlink:type="simple" xlink:href="../194/22194.xml">
OS</link> against expected results obtained by bypassing the operating system and analysing the raw underlying structures in the <link xlink:type="simple" xlink:href="../280/1010280.xml">
file system</link> (<b>cross-checking</b>). However, some rootkits started to add RootkitRevealer to a list of files it does not hide from, so in essence, they remove differences between the two listings, and the detector doesn't report them (most notably the commercial rootkit <it>Hacker Defender Antidetection</it>). Rootkit Revealer has apparently fixed this problem as they stated on their official page: "The reason that there is no longer a command-line version is that malware authors have started targetting RootkitRevealer's scan by using its executable name. We've therefore updated RootkitRevealer to execute its scan from a randomly named copy of itself that runs as a Windows service. This type of execution is not conducive to a command-line interface. Note that you can use command-line options to execute an automatic scan with results logged to a file, which is the equivalent of the command-line version's behavior."<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2213%22])">13</ref></p>
<p>

Another method is to compare content of binaries present on disk with their copies in operating memory — however some valid differences can be introduced by operating system mechanisms (e.g., memory relocation or <link xlink:type="simple" xlink:href="../796/376796.xml">
shimming</link>), but some can be very likely classified as system call hooks introduced by a running rootkit (<b>System Virginity Verifier</b>). <link>
Zeppoo</link> is another software product which detects rootkits under <O wordnetid="106832680" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../297/6097297.xml">
Linux</link></O>
 and <link xlink:type="simple" xlink:href="../642/31642.xml">
UNIX</link> systems.</p>
<p>

As always, prevention is better than cure, for being certain you have removed a rootkit typically involves re-installation of all software. If the integrity of the system install disks is trusted, cryptography can be used to monitor the integrity of the system. By "fingerprinting" the system files immediately after a fresh system install and then again after any subsequent changes made to the system (e.g., installing new software), the user or administrator will be alerted to any dangerous changes to the system's files. In the fingerprinting process a <link xlink:type="simple" xlink:href="../432/18934432.xml">
message digest</link> is used to create a fixed-length "digest" dependent on every bit in the file being fingerprinted. By calculating and comparing message digest values of files at regular intervals, changes in the system can be detected.</p>
<p>

Detection in <link xlink:type="simple" xlink:href="../155/41155.xml">
firmware</link> can be achieved by computing a <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<primitive wordnetid="109627462" confidence="0.8">
<link xlink:type="simple" xlink:href="../526/439526.xml">
cryptographic hash</link></primitive>
</causal_agent>
</person>
</physical_entity>
 of firmware and comparing hash values to a whitelist of expected values, or by extending the hash value into TPM (<link xlink:type="simple" xlink:href="../835/2936835.xml">
Trusted Platform Module</link>) configuration registers, which are later compared to a whitelist of expected values. Code that performs hash, compare, and/or extend operations must itself not be compromised by the rootkit. The notion of an immutable (by a rootkit) root-of-trust, if implementable,  ensures that the rootkit does not compromise the system at its most fundamental layer. A method of rootkit detection using a TPM is described by the <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../301/2792301.xml">
Trusted Computing Group</link></company>
<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%2214%22])">14</ref></p>

</sec>
<sec>
<st>
Removal</st>
<p>

Many hold this to be forbiddingly impractical. Even if the nature and composition of a rootkit is known, the time and effort of a system administrator with the necessary skills or experience would be better spent re-installing the operating system from scratch. Since <representation wordnetid="105926676" confidence="0.8">
<image wordnetid="105928118" confidence="0.8">
<link xlink:type="simple" xlink:href="../143/634143.xml#xpointer(//*[./st=%22Software%22])">
drive imaging software</link></image>
</representation>
 makes the task of restoring a “clean” OS installation almost trivial, there is no good reason to try to dig a rootkit out directly. </p>
<p>

<b> "I suppose traditional rootkits could be made to be as hard to remove as possible even when found, but I doubt there is much incentive for that, because the typical reaction of an experienced sysadmin on finding a rooted system is to save the data files, then <link xlink:type="simple" xlink:href="../743/305743.xml">
reformat</link> [and reinstall]. This is so even if the rootkit is very well known and can be removed 100%." <it> —<weblink xlink:type="simple" xlink:href="http://forums.spywareinfo.com/lofiversion/index.php/t52360.html">
Rootkit Question</weblink>'</it></b></p>
<p>

While most Anti-Virus and Malware Removal tools remain ineffective against rootkits, tools such as <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../384/2160384.xml">
BartPE</link></software>
 and other Preinstallation Environment(PE) or <structure wordnetid="105726345" confidence="0.8">
<arrangement wordnetid="105726596" confidence="0.8">
<distribution wordnetid="105729036" confidence="0.8">
<link xlink:type="simple" xlink:href="../137/331137.xml">
Live Distros</link></distribution>
</arrangement>
</structure>
 allow users to boot their computer with a fresh (presumably) "un-rooted" copy of the operating system. This allows users to examine and replace affected system files and delete offending rootkits of most types while keeping the underlying systems intact. Since most rootkits hook system files needed at the lowest level of the OS, booting into <link xlink:type="simple" xlink:href="../414/1850414.xml">
Safe Mode</link> will not usually allow removal of the rootkit process. In contrast, PE's do not rely on the infected underlying system structure but instead load a clean read-only copy of the Operating System allowing full control and detection of the rootkit. While most Administrators prefer a clean reinstall, a skilled Administrator using a PE can often delete and clean a rooted system if a reinstall is not a viable option.</p>

</sec>
<sec>
<st>
Comparison with computer viruses and worms</st>
<p>

The key distinction between a <link xlink:type="simple" xlink:href="../196/18994196.xml">
computer virus</link> and a rootkit relates to propagation.  Like a rootkit, a computer virus modifies core software components of the system, inserting code which attempts to hide the "infection" and provides some additional feature or service to the attacker (ie, the "payload" of a virus).</p>
<p>

In the case of the rootkit the payload may attempt to maintain the integrity of the rootkit (the compromise to the system) --- for example every time one runs the rootkit's version of the <it>ps</it> command, it may check the copies of <it>init</it> and <it>inetd</it> on the system to ensure that they are still compromised, "re-infecting" as necessary. The rest of the payload is there to ensure that the intruder continues to control the system. This generally involves having <technique wordnetid="105665146" confidence="0.8">
<know-how wordnetid="105616786" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../788/360788.xml">
backdoor</link></method>
</know-how>
</technique>
s in the form of hard-coded username/password pairs, hidden command-line switches or 'magic' environment variable settings which subvert normal access control policies of the uncompromised versions of the programs.  Some rootkits may add <link xlink:type="simple" xlink:href="../630/936630.xml">
port knocking</link> checks to existing network daemons (services) such as <it>inetd</it> or the <it>sshd</it>.</p>
<p>

A computer virus can have any sort of payload.  However, the computer virus also attempts to spread to other systems.  In general, a rootkit limits itself to maintaining control of one system.</p>
<p>

A program or suite of programs that attempts to automatically scan a network for vulnerable systems and to automatically exploit those vulnerabilities and compromise those systems is referred to as a <link xlink:type="simple" xlink:href="../010/6010.xml">
computer worm</link>. Other forms of computer worms work more passively, sniffing for usernames and passwords and using those to compromise accounts, installing copies of themselves into each such account (and usually relaying the compromised account information back to the intruder through some sort of <link xlink:type="simple" xlink:href="../907/174907.xml">
covert channel</link>).</p>
<p>

There are also hybrids.  A worm can install a rootkit, and a rootkit might include copies of one or more worms, <link xlink:type="simple" xlink:href="../114/59114.xml">
packet sniffer</link>s or <link xlink:type="simple" xlink:href="../635/576635.xml">
port scanner</link>s.  Also many of the e-mail worms are commonly referred to as "viruses."  So all of these terms have somewhat overlapping usage and are often conflated.</p>

</sec>
<sec>
<st>
Public availability</st>
<p>

Like much malware used by attackers, many rootkit implementations are shared and are easily available on the Internet. It is not uncommon to see a compromised system in which a sophisticated publicly available rootkit hides the presence of unsophisticated <link xlink:type="simple" xlink:href="../010/6010.xml">
worms</link> or attack tools that appear to have been written by inexperienced programmers.</p>
<p>

Most of the rootkits available on the Internet are constructed as an exploit or "<link xlink:type="simple" xlink:href="../668/608668.xml">
proof of concept</link>" to demonstrate varying methods of hiding things within a computer system and of taking unauthorized control. Since these are often not fully optimized for stealth, they sometimes leave unintended evidence of their presence. Even so, when such rootkits are used in an attack they are often very effective.</p>

</sec>
<sec>
<st>
See also</st>
<p>

<list>
<entry level="1" type="bullet">

<link xlink:type="simple" xlink:href="../972/3173972.xml">
Hacker con</link></entry>
<entry level="1" type="bullet">

<link xlink:type="simple" xlink:href="../196/18994196.xml">
Computer virus</link></entry>
<entry level="1" type="bullet">

<link xlink:type="simple" xlink:href="../224/1189224.xml">
Host-based intrusion detection system</link></entry>
<entry level="1" type="bullet">

<link xlink:type="simple" xlink:href="../072/29072.xml">
The SANS Institute</link></entry>
<entry level="1" type="bullet">

<link xlink:type="simple" xlink:href="../826/3174826.xml">
2005 Sony BMG CD copy protection scandal</link></entry>
</list>
</p>

</sec>
<sec>
<st>
References</st>

<p>

<reflist>
<entry id="1">
Brumley, David&#32;(<link>
1999-11-16</link>).&#32;"<weblink xlink:type="simple" xlink:href="http://www.usenix.org/publications/login/1999-9/features/rootkits.html">
invisible intruders: rootkits in practice</weblink>".&#32;  <link xlink:type="simple" xlink:href="../584/253584.xml">
USENIX</link>.</entry>
<entry id="2">
Mark Russinovich&#32;(2005-10-31).&#32;"<weblink xlink:type="simple" xlink:href="http://blogs.technet.com/markrussinovich/archive/2005/10/31/sony-rootkits-and-digital-rights-management-gone-too-far.aspx">
Sony, Rootkits and Digital Rights Management Gone Too Far</weblink>".&#32;Retrieved on <link>
2008-09-15</link>.</entry>
<entry id="3">
"<weblink xlink:type="simple" xlink:href="http://www.kaspersky.com/news?id=173737204">
New backdoor program uses Sony rootkit</weblink>".&#32;  <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../619/584619.xml">
Kaspersky Lab</link></company>
&#32;(2005-11-10).&#32;Retrieved on <link>
2008-09-15</link>.</entry>
<entry id="4">
"<weblink xlink:type="simple" xlink:href="http://news.bbc.co.uk/2/hi/technology/4456970.stm">
Sony's long-term rootkit CD woes</weblink>", <statement wordnetid="106722453" confidence="0.8">
<message wordnetid="106598915" confidence="0.8">
<announcement wordnetid="106746580" confidence="0.8">
<program wordnetid="106748466" confidence="0.8">
<link xlink:type="simple" xlink:href="../893/1139893.xml">
BBC News</link></program>
</announcement>
</message>
</statement>
&#32;(2005-11-21).&#32;Retrieved on <link>
2008-09-15</link>.&nbsp;</entry>
<entry id="5">
<physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<intellectual wordnetid="109621545" confidence="0.8">
<worker wordnetid="109632518" confidence="0.8">
<alumnus wordnetid="109786338" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<employee wordnetid="110053808" confidence="0.8">
<scholar wordnetid="110557854" confidence="0.8">
<link xlink:type="simple" xlink:href="../201/3127201.xml">
Russinovich, Mark</link></scholar>
</employee>
</causal_agent>
</alumnus>
</worker>
</intellectual>
</person>
</physical_entity>
&#32;(2006-02-06).&#32;"<weblink xlink:type="simple" xlink:href="http://blogs.technet.com/markrussinovich/archive/2006/02/06/using-rootkits-to-defeat-digital-rights-management.aspx">
Using Rootkits to Defeat Digital Rights Management</weblink>".&#32;<it>Winternals</it>.&#32;  SysInternals.&#32;Archived from <weblink xlink:type="simple" xlink:href="http://www.sysinternals.com/blog/2006/02/using-rootkits-to-defeat-digital.html">
Using Rootkits to Defeat Digital Rights Management the original</weblink> on <link>
2006-08-31</link>.&#32;Retrieved on <link>
2006-08-13</link>.</entry>
<entry id="6">
<physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<intellectual wordnetid="109621545" confidence="0.8">
<worker wordnetid="109632518" confidence="0.8">
<alumnus wordnetid="109786338" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<employee wordnetid="110053808" confidence="0.8">
<scholar wordnetid="110557854" confidence="0.8">
<link xlink:type="simple" xlink:href="../201/3127201.xml">
Mark Russinovich</link></scholar>
</employee>
</causal_agent>
</alumnus>
</worker>
</intellectual>
</person>
</physical_entity>
&#32;(June 2005).&#32;"<weblink xlink:type="simple" xlink:href="http://www.windowsitpro.com/Article/ArticleID/46266/46266.html">
Unearthing Root Kits</weblink>".&#32;  Windows IT Pro.</entry>
<entry id="7">
 Implementing and Detecting an ACPI Rootkit, by John Heasman, presented at BlackHat Federal, 2006. </entry>
<entry id="8">
<weblink xlink:type="simple" xlink:href="http://www.ngssoftware.com/research/papers/Implementing_And_Detecting_A_PCI_Rootkit.pdf">
Implementing and Detecting a PCI Rootkit</weblink> by John Heasman, 15 November, 2006.</entry>
<entry id="9">
"<weblink xlink:type="simple" xlink:href="http://www.eecs.umich.edu/virtual/papers/king06.pdf">
SubVirt: Implementing malware with virtual machines</weblink>".&#32;  <university wordnetid="108286163" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../740/31740.xml">
University of Michigan</link></university>
, <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../001/19001.xml">
Microsoft</link></company>
&#32;(2006-04-03).&#32;Retrieved on <link>
2008-09-15</link>.</entry>
<entry id="10">
The 64-bit version of Windows XP and Server 2008 are a notable exception "<weblink xlink:type="simple" xlink:href="http://www.microsoft.com/whdc/winlogo/drvsign/drvsign.mspx">
Driver Signing Requirements for Windows</weblink>".&#32;  <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../001/19001.xml">
Microsoft</link></company>
.&#32;Retrieved on <link>
2008-07-06</link>.</entry>
<entry id="11">
<weblink xlink:type="simple" xlink:href="http://www.net-security.org/article.php?id=1173&amp;p=2">
Rootkit Evolution</weblink> by <link>
Alisa Shevchenko</link> (1 September 2008), <weblink xlink:type="simple" xlink:href="http://www.megasecurity.org/papers/Rootkits.pdf">
An Overview of Unix Rootkits</weblink> by <physical_entity wordnetid="100001930" confidence="0.8">
<expert wordnetid="109617867" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<specialist wordnetid="110631941" confidence="0.8">
<intellectual wordnetid="109621545" confidence="0.8">
<alumnus wordnetid="109786338" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<scholar wordnetid="110557854" confidence="0.8">
<link xlink:type="simple" xlink:href="../287/3619287.xml">
Anton Chuvakin</link></scholar>
</causal_agent>
</alumnus>
</intellectual>
</specialist>
</person>
</expert>
</physical_entity>
 (February 2003)</entry>
<entry id="12">
"<weblink xlink:type="simple" xlink:href="http://msdn.microsoft.com/en-us/library/ms537364(VS.85).aspx">
Signing and Checking Code with Authenticode</weblink>".&#32;  <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../001/19001.xml">
Microsoft</link></company>
.&#32;Retrieved on <link>
2008-09-15</link>.</entry>
<entry id="13">
"<weblink xlink:type="simple" xlink:href="http://technet.microsoft.com/en-us/sysinternals/bb897445.aspx">
RootkitRevealer v1.71</weblink>".&#32;  Microsoft Technet&#32;(2006-11-01).&#32;Retrieved on <link>
2008-10-10</link>.</entry>
<entry id="14">
"[https://www.trustedcomputinggroup.org/news/Industry_Data/Whitepaper_Rootkit_Strom_v3.pdf Stopping Rootkits at the Network Edge]".&#32;  <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../301/2792301.xml">
Trusted Computing Group</link></company>
&#32;(2007-01-04).&#32;Retrieved on <link>
2008-07-11</link>.</entry>
</reflist>
</p>

</sec>
<sec>
<st>
Further reading</st>
<p>

<list>
<entry level="1" type="bullet">

  <cite style="font-style:normal">Robert S Morris, Sr.&#32;(1984).&#32;"UNIX Operating System Security". <it>Bell Systems Technical Journal</it>&#32;<b>Vol. 62, No. 8</b>.&#32;BSTJ.</cite>&nbsp;</entry>
<entry level="1" type="bullet">

  <cite style="font-style:normal" class="book">Greg Hoglund and James Butler&#32;(2005). <weblink xlink:type="simple" xlink:href="http://books.google.com/books?id=fDxg1W3eT2gC">
Rootkits: Subverting the Windows Kernel</weblink>.&#32;Addison Wesley. ISBN 0-321-29431-9.</cite>&nbsp;</entry>
<entry level="1" type="bullet">

  <cite style="font-style:normal" class="book">Nancy Altholz and Larry Stevenson&#32;(2006). <weblink xlink:type="simple" xlink:href="http://books.google.com/books?id=MTcep7V6heUC">
Rootkits for Dummies</weblink>.&#32;John Wiley and Sons Ltd. ISBN 0-471-91710-9.</cite>&nbsp;</entry>
<entry level="1" type="bullet">

  <cite style="font-style:normal" class="book">Ric Veiler&#32;(2007). <weblink xlink:type="simple" xlink:href="http://books.google.com/books?id=OSaVF_jzsJgC">
Professional Rootkits</weblink>.&#32;Wrox. ISBN 978-0-470-10154-4.</cite>&nbsp;</entry>
</list>
</p>

</sec>
<sec>
<st>
External links</st>

<p>

<list>
<entry level="1" type="bullet">

 Mark Russinovich, <weblink xlink:type="simple" xlink:href="http://www.microsoft.com/emea/itsshowtime/sessionh.aspx?videoid=359">
Advanced Malware Cleaning <b>video</b></weblink>, Microsoft TechEd: IT Forum, November 2006</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://northsecuritylabs.com/downloads/whitepaper-html/">
White paper on new-generation rootkit detection</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.antirootkit.com">
antirootkit.com</weblink> (Up to date rootkit information, news and removal software for less experienced users - also has a list of all rootkits in the wild)</entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.anti-malware-test.com/?q=taxonomy/term/7">
Testing of antivirus/anti-rootkit software for the detection and removal of rootkits</weblink> made by Anti-Malware Test Lab, January 2008</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.informationweek.com/news/showArticle.jhtml?articleID=196901062">
Testing of anti-rootkit software</weblink> made by InformationWeek, January 2007</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.grc.com/sn/SN-009.htm">
Steve Gibson's Security Now! Episode #9</weblink> (on rootkits)</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.grc.com/sn/SN-012.htm">
Steve Gibson's Security Now! Episode #12</weblink> (on rootkits)</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.grc.com/sn/SN-127.htm">
Steve Gibson's Security Now! Episode #127</weblink> (on Corporate Security - MBR rootkit update)</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://blogs.technet.com/markrussinovich/archive/2005/10/31/sony-rootkits-and-digital-rights-management-gone-too-far.aspx">
Sony, Rootkits and Digital Rights Management Gone Too Far</weblink> (Mark Russinovich's first blog entry about the Sony DRM rootkit, from which the scandal ensued)</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.oreilly.com/catalog/1593271425/">
Designing BSD Rootkits</weblink> An Introduction to Kernel Hacking (book by Joseph Kong)</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.pcworld.ca/news/column/23a7f73b0a010408001a024ccab0dd5e/pg1.htm">
How to remove spyware from your PC: rid yourself of rootkits</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.antispywarecoalition.org/documents/glossary.htm">
Glossary of malware terminology</weblink> ("Rootkit" has a negative connotation)</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.crucialsecurity.com/documents/hvmrootkits.pdf">
White paper on hypervisor rootkit technology</weblink></entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.informationweek.com/news/software/reviews/showArticle.jhtml?articleID=196901062">
http://www.informationweek.com/news/software/reviews/showArticle.jhtml?articleID=196901062</weblink>Review: Six Rootkit Detectors Protect Your System</entry>
</list>
</p>


</sec>
</bdy>
</entity>
</article>
