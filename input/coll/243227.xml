<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 16:36:57[mciao0828] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<event  confidence="0.8" wordnetid="100029378">
<rule  confidence="0.8" wordnetid="105846932">
<act  confidence="0.8" wordnetid="100030358">
<psychological_feature  confidence="0.8" wordnetid="100023100">
<procedure  confidence="0.8" wordnetid="101023820">
<activity  confidence="0.8" wordnetid="100407535">
<algorithm  confidence="0.8" wordnetid="105847438">
<header>
<title>Tarjan&apos;s off-line least common ancestors algorithm</title>
<id>243227</id>
<revision>
<id>231966115</id>
<timestamp>2008-08-14T20:14:11Z</timestamp>
<contributor>
<username>Giftlite</username>
<id>37986</id>
</contributor>
</revision>
<categories>
<category>Graph algorithms</category>
</categories>
</header>
<bdy>

In <link xlink:type="simple" xlink:href="../323/5323.xml">
computer science</link>, <b>Tarjan's off-line least common ancestors algorithm</b> is an <link xlink:type="simple" xlink:href="../775/775.xml">
algorithm</link> for computing <link xlink:type="simple" xlink:href="../522/7196522.xml">
lowest common ancestor</link>s for pairs of nodes in a tree, based on the <link xlink:type="simple" xlink:href="../551/1037551.xml">
union-find</link> data structure. The least common ancestor of two nodes <it>d</it> and <it>e</it> in a <link xlink:type="simple" xlink:href="../560/48560.xml">
rooted tree</link> <it>T</it> is the node <it>g</it> that is an ancestor of both <it>d</it> and <it>e</it> and that has the greatest depth in <it>T</it>. It is named after <person wordnetid="100007846" confidence="0.9508927676800064">
<scientist wordnetid="110560637" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../127/46127.xml">
Robert Tarjan</link></scientist>
</person>
, who discovered the technique in 1979. Tarjan's algorithm is <it>offline</it>; that is, unlike other lowest common ancestor algorithms, it requires that all pairs of nodes for which the lowest common ancestor is desired must be specified in advance. The simplest version of the algorithm uses the <link xlink:type="simple" xlink:href="../551/1037551.xml">
union find</link> data structure, which unlike other lowest common ancestor data structures can take more than constant time per operation when the number of pairs of nodes is similar in magnitude to the number of nodes. A later refinement by <link xlink:type="simple" xlink:href="#xpointer(//cite[@id=%22CITEREFGabowTarjan1983%22])">
Gabow &amp; Tarjan (1983)</link> speeds the algorithm up to <link xlink:type="simple" xlink:href="../258/754258.xml">
linear time</link>.
<sec>
<st>
 Pseudocode </st>

<p>

The pseudocode below determines the least common ancestor of each pair in <it>P</it>, given the root <it>r</it> of a tree in which the children of node <it>n</it> are in the set <it>n.children</it>.  For this offline algorithm, the set <it>P</it> must be specified in advance.  It uses the <it>MakeSet</it>, <it>Find</it>, and <it>Union</it> functions of a <link xlink:type="simple" xlink:href="../551/1037551.xml#xpointer(//*[./st=%22Disjoint-set+forests%22])">
disjoint-set forest</link>.  <it>MakeSet(u)</it> removes <it>u</it> to a singleton set, <it>Find(u)</it> returns the standard representative of the set containing <it>u</it>, and <it>Union(u,v)</it> merges the set containing <it>u</it> with the set containing <it>v</it>.
TarjanOLCA(<it>r</it>) is first called on the root <it>r</it>.</p>
<p>

<b>function</b> TarjanOLCA(u)
MakeSet(u);
u.ancestor := u;
<b>for each</b> v <b>in</b> u.children <b>do</b>
TarjanOLCA(v);
Union(u,v);
Find(u).ancestor := u;
u.colour := black;
<b>for each</b> v <b>such that</b> {u,v} <b>in</b> P <b>do</b>
<b>if</b> v.colour == black
print "Tarjan's Least Common Ancestor of " + u +
" and " + v + " is " + Find(v).ancestor + ".";</p>
<p>

Each node is initially white, and is colored black after it and all its children have been visited.  The least common ancestor of the pair <it>{u,v}</it> is available as <it>Find(v).ancestor</it> immediately (and only immediately) after <it>u</it> is colored black, provided <it>v</it> is already black.  Otherwise, it will be available later as <it>Find(u).ancestor</it>, immediately after <it>v</it> is colored black.</p>
<p>

For reference, here are optimized versions of <it>MakeSet</it>, <it>Find</it>, and <it>Union</it> for a <link xlink:type="simple" xlink:href="../551/1037551.xml#xpointer(//*[./st=%22Disjoint-set+forests%22])">
disjoint-set forest</link>:</p>
<p>

<b>function</b> MakeSet(x)
x.parent := x
x.rank   := 0</p>
<p>

<b>function</b> Union(x, y)
xRoot := Find(x)
yRoot := Find(y)
<b>if</b> xRoot.rank &amp;gt; yRoot.rank
yRoot.parent := xRoot
<b>else if</b> xRoot.rank  yRoot.rank
xRoot.parent := yRoot
<b>else if</b> xRoot != yRoot
yRoot.parent := xRoot
xRoot.rank := xRoot.rank + 1</p>
<p>

<b>function</b> Find(x)
<b>if</b> x.parent == x
<b>return</b> x
<b>else</b>
x.parent := Find(x.parent)
<b>return</b> x.parent</p>

</sec>
<sec>
<st>
References</st>
<p>

<list>
<entry level="1" type="bullet">

 <cite id="CITEREFGabowTarjan1983" style="font-style:normal">Gabow, H. N.&#32;&amp;&#32;<link>
Tarjan, R. E.</link>&#32;(1983),&#32;"A linear-time algorithm for a special case of disjoint set union",&#32;<it>Proceedings of the 15th ACM Symposium on Theory of Computing (STOC)</it>, pp. 246–251, <document wordnetid="106470073" confidence="0.8">
<written_communication wordnetid="106349220" confidence="0.8">
<writing wordnetid="106362953" confidence="0.8">
<link xlink:type="simple" xlink:href="../994/422994.xml">
doi</link></writing>
</written_communication>
</document>
:<weblink xlink:type="simple" xlink:href="http://dx.doi.org/10.1145%2F800061.808753">
10.1145/800061.808753</weblink></cite>&nbsp;.</entry>
</list>
</p>
<p>

<list>
<entry level="1" type="bullet">

 <cite id="CITEREFTarjan1979" style="font-style:normal"><link>
Tarjan</link>&#32;(1979),&#32;"Applications of path compression on balanced trees",&#32;<it><magazine wordnetid="106595351" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../845/2321845.xml">
Journal of the ACM</link></magazine>
</it>&#32;<b>26</b>(4):  690–715, <document wordnetid="106470073" confidence="0.8">
<written_communication wordnetid="106349220" confidence="0.8">
<writing wordnetid="106362953" confidence="0.8">
<link xlink:type="simple" xlink:href="../994/422994.xml">
doi</link></writing>
</written_communication>
</document>
:<weblink xlink:type="simple" xlink:href="http://dx.doi.org/10.1145%2F322154.322161">
10.1145/322154.322161</weblink></cite>&nbsp;.</entry>
</list>
</p>

</sec>
</bdy>
</algorithm>
</activity>
</procedure>
</psychological_feature>
</act>
</rule>
</event>
</article>
