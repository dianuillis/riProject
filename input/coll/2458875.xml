<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 19:37:32[mciao0825] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<header>
<title>Data assimilation</title>
<id>2458875</id>
<revision>
<id>237271047</id>
<timestamp>2008-09-09T12:32:35Z</timestamp>
<contributor>
<username>Melcombe</username>
<id>4682566</id>
</contributor>
</revision>
<categories>
<category>Estimation theory</category>
<category>Articles to be expanded since June 2008</category>
<category>Climate and weather statistics</category>
<category>Control theory</category>
<category>All articles to be expanded</category>
<category>Bayesian statistics</category>
<category>Numerical climate and weather models</category>
<category>Weather prediction</category>
</categories>
</header>
<bdy>

Applications of <b>data assimilation</b> arise in many geosciences, perhaps most importantly in <link xlink:type="simple" xlink:href="../231/73231.xml">
weather forecasting</link> and <link xlink:type="simple" xlink:href="../435/13435.xml">
hydrology</link>.  Data assimilation proceeds by <it>analysis cycles</it>. In each analysis cycle, observations of the current (and possibly, past) state of a system are combined with the results from a <link xlink:type="simple" xlink:href="../590/20590.xml">
mathematical model</link> (the <it>forecast</it>) to produce an <it>analysis</it>, which is considered as 'the best' estimate of the current state of the system. This is called the <it>analysis step</it>. Essentially, the analysis step tries to balance the uncertainty in the data and in the forecast. The model is then advanced in time and its result becomes the forecast in the next analysis cycle.<p>

In data assimilation applications, the analysis and forecasts are best thought of as <link xlink:type="simple" xlink:href="../543/23543.xml">
probability distribution</link>s. The analysis step is an application of the <link xlink:type="simple" xlink:href="../569/49569.xml">
Bayes theorem</link> and the overall assimilation procedure is an example of <artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<filter wordnetid="103339643" confidence="0.8">
<link xlink:type="simple" xlink:href="../408/2591408.xml">
Recursive Bayesian estimation</link></filter>
</device>
</instrumentality>
</artifact>
. However, the probabilistic analysis is using simplified to a compuationally feasible form. Advancing the probability distribution in time would be done exactly in the general case by the <link xlink:type="simple" xlink:href="../896/166896.xml">
Fokker-Planck equation</link>, but that is unrealistically expensive, so various approximations operating on simplified <link xlink:type="simple" xlink:href="../211/348211.xml">
representation</link>s of the probability distributions are used instead.  If the probability distributions are normal, they can be represented by their mean and covariance, which gives rise to the <artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<filter wordnetid="103339643" confidence="0.8">
<link xlink:type="simple" xlink:href="../855/180855.xml">
Kalman filter</link></filter>
</device>
</instrumentality>
</artifact>
. However it is not feasible to maintain the covariance because of the large number of degrees of freedom in the state, so various approximations are used instead. </p>
<p>

Many methods represent the probability distributions only by the mean and impute some covariance instead. In the basic form, such analysis step is known as <link>
optimal statistical interpolation</link>. Adjusting the initial value of the mathematical model instead of changing the state directly at the analysis time is the essence of the variational methods, 3DVAR and 4DVAR. <link xlink:type="simple" xlink:href="../810/6808810.xml">
Nudging</link>, also known as Newtonian relaxation or 4DDA, is essentially the same as proceeding in continuous time rather than in discrete analysis cycles (the <link>
Kalman-Bucy filter</link>), again with imputing simplified covariance. </p>
<p>

<artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<filter wordnetid="103339643" confidence="0.8">
<link xlink:type="simple" xlink:href="../738/9553738.xml">
Ensemble Kalman filter</link></filter>
</device>
</instrumentality>
</artifact>
s represent the probability distribution by an ensemble of simulations, and the covariance is approximated by <link xlink:type="simple" xlink:href="../756/10005756.xml">
sample covariance</link>.</p>
<p>

In addition to weather forecasting, other uses of DA include trajectory estimation for the <work wordnetid="100575741" confidence="0.8">
<statement wordnetid="106722453" confidence="0.8">
<message wordnetid="106598915" confidence="0.8">
<announcement wordnetid="106746580" confidence="0.8">
<program wordnetid="106748466" confidence="0.8">
<event wordnetid="100029378" confidence="0.8">
<undertaking wordnetid="100795720" confidence="0.8">
<act wordnetid="100030358" confidence="0.8">
<psychological_feature wordnetid="100023100" confidence="0.8">
<activity wordnetid="100407535" confidence="0.8">
<link xlink:type="simple" xlink:href="../461/1461.xml">
Apollo program</link></activity>
</psychological_feature>
</act>
</undertaking>
</event>
</program>
</announcement>
</message>
</statement>
</work>
, <link xlink:type="simple" xlink:href="../866/11866.xml">
GPS</link>, and <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../453/7011453.xml">
atmospheric chemistry</link></software>
.</p>

<sec>
<st>
Weather forecasting applications</st>

<p>

Data assimilation is a concept encompassing any method for combining observations of variables like <link xlink:type="simple" xlink:href="../300/19572300.xml">
temperature</link>, and <link xlink:type="simple" xlink:href="../484/47484.xml">
atmospheric pressure</link> into numerical models as the ones used to predict <link xlink:type="simple" xlink:href="../978/33978.xml">
weather</link>.</p>
<p>

In weather forecasting there are 2 main types of data assimilation: 3 dimensional (3DDA) and 4 dimensional (4DDA). In 3DDA only those observations available at the time of analysis are used. In 4DDA the past observations are included (thus, time dimension added). </p>

<ss1>
<st>
History of Data Assimilation in Weather forecasting</st>

<p>

The first data assimilation methods were called the "objective analyses" (e.g., <link>
Cressman algorithm</link>). This was in contrast to the "subjective analyses", when (in past practices) <link xlink:type="simple" xlink:href="../381/1505381.xml">
numerical weather prediction</link>s (NWP) forecasts were adjusted by meteorologists using their operational expertise. The objective methods used simple interpolation approaches, and thus were 3DDA methods. </p>
<p>

The similar 4DDA methods, called "<link xlink:type="simple" xlink:href="../810/6808810.xml">
nudging</link>" also exist (e.g. in MM5 NWP model). They are based on the simple idea of <link>
Newtonian relaxation</link> (the 2nd axiom of Newton). The idea is to add in the right part of dynamical equations of the model a term that is proportional to the difference of the calculated meteorological variable and the observed value. This term that has a negative sign "keeps" the calculated <link xlink:type="simple" xlink:href="../156/548156.xml">
state vector</link> closer to the observations. Nudging can be interpreted as a variant of the <link>
Kalman-Bucy filter</link> (a continuous time version of the <artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<filter wordnetid="103339643" confidence="0.8">
<link xlink:type="simple" xlink:href="../855/180855.xml">
Kalman filter</link></filter>
</device>
</instrumentality>
</artifact>
) with the gain matrix prescribed rather than obtained from covariances.</p>
<p>

The breakthrough in the field of data assimilation was achieved by L. Gandin (1963) who introduced the "<link>
statistical interpolation</link>" (or "optimal interpolation") method. His work developed the previous ideas of Kolmogorov.  That method is a 3DDA method and is a type of <link xlink:type="simple" xlink:href="../997/826997.xml">
regression analyses</link>, which utilizes information about the spatial distributions of <link xlink:type="simple" xlink:href="../059/157059.xml">
covariance</link> functions of the errors of the "first guess" field (previous forecast) and "true field". These functions are never known. However, the different approximations were assumed.</p>
<p>

In fact the optimal interpolation algorithm is the reduced version of the <link xlink:type="simple" xlink:href="../855/180855.xml">
Kalman filtering</link> (KF) algorithm, when the covariance matrices are not calculated from the dynamical equations, but are pre-determined in advance.</p>
<p>

Attempts to introduce the KF algorithms as a 4DDA tool for NWP models came later. However, this was (and remains) a very difficult task, since the full version of KF algorithm requires solution of the enormous number of additional equations (~N*N~10**12, where N=Nx*Ny*Nz is the size of the state vector, Nx~100, Ny~100, Nz~100 - the dimensions of the computational grid). To overcome that difficulty the special kind of KF algorithms (approximate or suboptimal KF's) for NWP models were developed. These include, e.g., the <artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<filter wordnetid="103339643" confidence="0.8">
<link xlink:type="simple" xlink:href="../738/9553738.xml">
Ensemble Kalman filter</link></filter>
</device>
</instrumentality>
</artifact>
 and the <link>
Reduced-Rank Kalman filter</link>s (RRSQRT) (e.g., Todling and Cohn, 1994). </p>
<p>

Another significant advance in the development of the 4DDA methods was utilizing the <link xlink:type="simple" xlink:href="../565/362565.xml">
optimal control</link> theory (variational approach) in the works of Le Dimet and Talagrand (1986), based on the previous works of G. Marchuk, who was the first to apply that theory in the environmental modeling. The significant advantage of the variational approaches is that the meteorological fields satisfy the dynamical equations of the NWP model and at the same time they minimize the functional, characterizing their difference from observations. Thus, the problem of constrained minimization is solved. The 3DDA variational methods were developed for the first time by Sasaki (1958).</p>
<p>

As was shown by Lorenz (1986), all the above-mentioned 4DDA methods are in some limit equivalent, i.e. under some assumptions they minimize the same <link xlink:type="simple" xlink:href="../033/52033.xml">
cost function</link>. However, in practical applications these assumptions are never fulfilled, the different methods perform differently and generally it is not clear what approach (Kalman filtering or variational) is better. The fundamental questions also arise in application of the advanced DA techniques such as convergence of the computational method to the global minimum of the functional to be minimised. For instance, cost function or the set in which the solution is sought can be not convex.</p>

</ss1>
<ss1>
<st>
Future Development in NWP</st>

<p>

The rapid development of the various data assimilation methods for NWP models is connected with the two main points in the field of numerical weather prediction:</p>
<p>

<list>
<entry level="1" type="number">

 Utilizing the observations currently seems to be the most promising chance to improve the quality of the forecasts at the different spatial scales (from the planetary scale to the local city, or even street scale) and time scales.</entry>
<entry level="1" type="number">

 The number of different kinds of available observations (<link xlink:type="simple" xlink:href="../677/5084677.xml">
sodar</link>s, <link xlink:type="simple" xlink:href="../676/25676.xml">
radar</link>s, <link xlink:type="simple" xlink:href="../683/27683.xml">
satellite</link>) is rapidly growing.</entry>
</list>
</p>
<p>

The question is: can the principal limit of the <link xlink:type="simple" xlink:href="../070/246070.xml">
predictability</link> of weather forecast models be overcome (and to what extent) with the help of data assimilation?</p>

</ss1>
<ss1>
<st>
Cost function</st>
<p>

The process of creating the analysis in data assimilation often involves minimization of a "cost function."  A typical cost function would be the sum of the squared deviations of the analysis values from the observations weighted by the accuracy of the observations, plus the sum of the squared deviations of the forecast fields and the analyzed fields weighted by the accuracy of the forecast.  This has the effect of making sure that the analysis does not drift too far away from observations and forecasts that are known to usually be reliable.</p>
<p>

1. 3D-Var</p>
<p>

<math>J(\mathbf{x}) = (\mathbf{x}-\mathbf{x}_{b})^{\mathrm{T}}\mathbf{B}^{-1}(\mathbf{x}-\mathbf{x}_{b}) + (\mathbf{y}-\mathit{H}[\mathbf{x}])^{\mathrm{T}}\mathbf{R}^{-1}(\mathbf{y}-\mathit{H}[\mathbf{x}]),</math></p>
<p>

where <math>\mathbf{B}</math> denotes the background error covariance, <math>\mathbf{R}</math> the observational error covariance.</p>
<p>

<math>\nabla J(\mathbf{x}) = 2\mathbf{B}^{-1}(\mathbf{x}-\mathbf{x}_{b}) - 2\mathit{H}\mathbf{R}^{-1}(\mathbf{y}-\mathit{H}[\mathbf{x}])</math></p>
<p>

2. 4D-var</p>
<p>

<math>J(\mathbf{x}) = (\mathbf{x}-\mathbf{x}_{b})^{\mathrm{T}}\mathbf{B}^{-1}(\mathbf{x}-\mathbf{x}_{b}) + \sum_{i=0}^{n}(\mathbf{y}_{i}-\mathit{H}_{i}[\mathbf{x}_{i}])^{\mathrm{T}}\mathbf{R}_{i}^{-1}(\mathbf{y}_{i}-\mathit{H}_{i}[\mathbf{x}_{i}])</math></p>
<p>

provided that <math>\mathit{H}</math> is linear operator (matrix). </p>
<p>

<table class="metadata plainlinks ambox ">
<row>
<col>

ambox-notice" style=""</col>
</row>
<row>
<col class="mbox-image"><p>

<image width="36px" src="Wiki_letter_w.svg">
</image>
</p>
</col>
<col style="" class="mbox-text">
 <b>Please help <weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php?title=Data_assimilation&amp;action=edit">
improve this section</weblink> by expanding it.</b> Further information might be found on the  or at . 
<it>(June 2008)''</it></col>
</row>
</table>

</p>

</ss1>
</sec>
<sec>
<st>
Other applications of Data Assimilation</st>

<p>

<table class="metadata plainlinks ambox ">
<row>
<col>

ambox-notice" style=""</col>
</row>
<row>
<col class="mbox-image"><p>

<image width="36px" src="Wiki_letter_w.svg">
</image>
</p>
</col>
<col style="" class="mbox-text">
 <b>Please help <weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php?title=Data_assimilation&amp;action=edit">
improve this section</weblink> by expanding it.</b> Further information might be found on the  or at . 
<it>(June 2008)''</it></col>
</row>
</table>


Data assimilation methods are currently also used in other environmental forecasting problems, e.g. in <link xlink:type="simple" xlink:href="../435/13435.xml">
hydrological</link> forecasting. Basically, the same types of data assimilation methods as those described above are in use there.  An example of chemical data assimilation using <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../453/7011453.xml">
Autochem</link></software>
 can be found at <weblink xlink:type="simple" xlink:href="http://www.cdacentral.info/">
CDACentral</weblink>.</p>
<p>

Data assimilation is a part of the challenge for every forecasting problem.</p>
<p>

Dealing with biased data is a serious challenge in data assimilation. Further development of methods to deal with biases will be of particular use. If there are several instruments observing the same variable then intercomparing them using <link xlink:type="simple" xlink:href="../235/1622235.xml">
probability distribution function</link>s can be instructive. Such an analysis is available on line at <weblink xlink:type="simple" xlink:href="http://www.pdfcentral.info/">
PDFCentral</weblink> designed for the validation of observations from the NASA <satellite wordnetid="104137444" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<equipment wordnetid="103294048" confidence="0.8">
<link xlink:type="simple" xlink:href="../963/827963.xml">
Aura satellite</link></equipment>
</instrumentality>
</artifact>
</satellite>
.</p>

</sec>
<sec>
<st>
References</st>
<p>

<list>
<entry level="1" type="bullet">

 R. Daley, Atmospheric data analysis, Cambridge University Press, 1991.</entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.mmm.ucar.edu/mm5/">
MM5 community model homepage</weblink></entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.ecmwf.int/newsevents/training/lecture_notes/LN_DA.html">
ECMWF Data Assimilation Lecture notes</weblink></entry>
<entry level="1" type="bullet">

 Ide, K., P. Courtier, M. Ghil, and A. C. Lorenc (1997) <weblink xlink:type="simple" xlink:href="http://www.atmos.ucla.edu/~kayo/data/publication/ide_etal_jmsj97.pdf">
Unified Notation for Data Assimilation: Operational, Sequential and Variational</weblink> Journal of the Meteorologcial Society of Japan, vol. 75, No. 1B, pp. 181-189</entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.meted.ucar.edu/nwp/pcu1/ic6/frameset.htm">
COMET module "Understanding Data Assimilation"</weblink></entry>
<entry level="1" type="bullet">

 Geir Evensen, Data Assimilation. The Ensemble Kalman Filter. Springer, 2007</entry>
</list>
</p>

</sec>
<sec>
<st>
External links</st>
<p>

<list>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.CDAcentral.info/">
CDACentral (an example analysis from Chemical Data Assimilation)</weblink></entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.PDFcentral.info/">
PDFCentral (using PDFs to examine biases and representativeness)</weblink></entry>
</list>
</p>


</sec>
</bdy>
</article>
