<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 16:52:52[mciao0828] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<entity  confidence="0.9511911446218017" wordnetid="100001740">
<header>
<title>Inclusion-exclusion principle</title>
<id>342684</id>
<revision>
<id>244542107</id>
<timestamp>2008-10-11T09:54:03Z</timestamp>
<contributor>
<username>DragonBot</username>
<id>5466012</id>
</contributor>
</revision>
<categories>
<category>Articles containing proofs</category>
<category>Probability theory</category>
<category>Combinatorics</category>
</categories>
</header>
<bdy>

In <link xlink:type="simple" xlink:href="../170/5170.xml">
combinatorial</link> <link xlink:type="simple" xlink:href="../831/18831.xml">
mathematics</link>, the <b>inclusion-exclusion principle</b> (also known as the <b>sieve principle</b>) states that if <it>A</it>1, ..., <it>An</it> are finite sets, then<p>

<indent level="1">

<math>
\begin{align}
\biggl|\bigcup_{i=1}^n A_i\biggr| &amp; {} =\sum_{i=1}^n\left|A_i\right|
-\sum_{i,j\,:\,1 \le i &amp;lt; j \le n}\left|A_i\cap A_j\right| \\
&amp; {}\qquad +\sum_{i,j,k\,:\,1 \le i &amp;lt; j &amp;lt; k \le n}\left|A_i\cap A_j\cap A_k\right|-\ \cdots\ + \left(-1\right)^{n-1} \left|A_1\cap\cdots\cap A_n\right|
\end{align}</math>
</indent>

where |<it>A</it>| denotes the <link xlink:type="simple" xlink:href="../er)/6174_(number).xml">
cardinality</link> of the set <it>A</it>. For example, taking <it>n</it> = 2, we get a special case of <link xlink:type="simple" xlink:href="../942/296942.xml">
double counting</link>; in words: we can count the size of the <link xlink:type="simple" xlink:href="../949/47949.xml">
union</link> of sets <it>A</it> and <it>B</it> by adding |<it>A</it>| and |<it>B</it>| and then subtracting the size of their <link xlink:type="simple" xlink:href="../157/48157.xml">
intersection</link>. The name comes from the idea that the principle is based on over-generous <it>inclusion</it>, followed by compensating <it>exclusion</it>. When <it>n</it> &amp;gt; 2 the exclusion of the pairwise intersections is (possibly) too severe, and the correct formula is as shown with alternating signs.</p>
<p>

This formula is attributed to <scientist wordnetid="110560637" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../327/57327.xml">
Abraham de Moivre</link></scientist>
; it is sometimes also named for <link xlink:type="simple" xlink:href="../861/234861.xml">
Joseph Sylvester</link> or <link>
Henri Poincaré</link>.
<image width="150px" src="Inclusion-exclusion.svg" type="thumb">
<caption>

Inclusion-exclusion illustrated for three sets
</caption>
</image>

<image width="150px" src="Inclusion_exclusion_diagram.JPG" type="thumb">
<caption>

Counts of each region with progressively more terms used for n = 4
</caption>
</image>
</p>
<p>

For the case of three sets <it>A</it>, <it>B</it>, <it>C</it> the inclusion-exclusion principle is illustrated in the graphic on the right. </p>

<sec>
<st>
Inclusion-exclusion principle in probability</st>

<p>

In <link xlink:type="simple" xlink:href="../934/22934.xml">
probability</link>, for events <it>A</it>1, ..., <it>An</it> in a <link xlink:type="simple" xlink:href="../325/43325.xml">
probability space</link> <math>\scriptstyle(\Omega,\mathcal{F},\mathbb{P})</math>, the inclusion-exclusion principle becomes for <it>n</it>&nbsp;=&nbsp;2</p>
<p>

<indent level="1">

<math>\mathbb{P}(A_1\cup A_2)=\mathbb{P}(A_1)+\mathbb{P}(A_2)-\mathbb{P}(A_1\cap A_2),</math>
</indent>

for <it>n</it>&nbsp;=&nbsp;3</p>
<p>

<indent level="1">

<math>\begin{align}\mathbb{P}(A_1\cup A_2\cup A_3)&amp;=\mathbb{P}(A_1)+\mathbb{P}(A_2)+\mathbb{P}(A_3)\\
&amp;\qquad-\mathbb{P}(A_1\cap A_2)-\mathbb{P}(A_1\cap A_3)-\mathbb{P}(A_2\cap A_3)+\mathbb{P}(A_1\cap A_2\cap A_3)
\end{align}</math>
</indent>

and in general</p>
<p>

<indent level="1">

<math>\begin{align}
\mathbb{P}\biggl(\bigcup_{i=1}^n A_i\biggr) &amp; {} =\sum_{i=1}^n \mathbb{P}(A_i)
-\sum_{i,j\,:\,i&amp;lt;j}\mathbb{P}(A_i\cap A_j) \\
&amp;\qquad+\sum_{i,j,k\,:\,i&amp;lt;j&amp;lt;k}\mathbb{P}(A_i\cap A_j\cap A_k)-\ \cdots\ +(-1)^{n-1}\, \mathbb{P}\biggl(\bigcap_{i=1}^n A_i\biggr),
\end{align}</math>
</indent>

which can be written in closed form as</p>
<p>

<indent level="1">

<math>\mathbb{P}\biggl(\bigcup_{i=1}^n A_i\biggr)  =\sum_{k=1}^n (-1)^{k-1}\sum_{\scriptstyle I\subset\{1,\ldots,n\}\atop\scriptstyle|I|=k} \mathbb{P}\biggl(\bigcap_{i\in I} A_i\biggr),</math>
</indent>

where the last sum runs over all subsets <it>I</it> of the indices 1, ..., <it>n</it> which contain exactly <it>k</it> elements.</p>
<p>

According to the <difference wordnetid="104748836" confidence="0.8">
<inequality wordnetid="104752221" confidence="0.8">
<link xlink:type="simple" xlink:href="../887/344887.xml">
Bonferroni inequalities</link></inequality>
</difference>
, the sum of the first terms in the formula is alternately an upper bound and a lower bound for the <link xlink:type="simple" xlink:href="../352/166352.xml">
LHS</link>. This can be used in cases where the full formula is too cumbersome.</p>
<p>

For a general <link xlink:type="simple" xlink:href="../873/19873.xml">
measure space</link> (<it>S</it>,<it>Σ</it>,<it>μ</it>) and <link xlink:type="simple" xlink:href="../873/19873.xml">
measurable</link> subsets <it>A</it>1, ..., <it>An</it> of finite measure, the above identities also hold when the probability measure <math>\mathbb{P}</math> is replaced by the measure <it>μ</it>.</p>

</sec>
<sec>
<st>
Proof</st>

<p>

To prove the inclusion-exclusion principle in general, we first have to verify the identity</p>
<p>

<indent level="1">

<math>1_{\cup_{i=1}^n A_i}  =\sum_{k=1}^n (-1)^{k-1}\sum_{\scriptstyle I\subset\{1,\ldots,n\}\atop\scriptstyle|I|=k} 1_{\cap_{i\in I} A_i}\qquad(*)</math>
</indent>

for <link xlink:type="simple" xlink:href="../790/240790.xml">
indicator function</link>s. There are at least two ways to do this:</p>
<p>

<b>First possibility:</b> If suffices to do this for every <it>x</it> in the union of <it>A</it>1, ..., <it>An</it>. Suppose <it>x</it> belongs to exactly <it>m</it> sets with 1&nbsp;≤&nbsp;<it>m</it>&nbsp;≤&nbsp;<it>n</it>, for simplicity of notation say <it>A</it>1, ..., <it>Am</it>. Then the identity at <it>x</it> reduces to</p>
<p>

<indent level="1">

<math>1 =\sum_{k=1}^m (-1)^{k-1}\sum_{\scriptstyle I\subset\{1,\ldots,m\}\atop\scriptstyle|I|=k} 1.</math>
</indent>

The number of subsets of cardinality <it>k</it> of an <it>m</it>-element set is the combinatorical interpretation of the <link xlink:type="simple" xlink:href="../668/4668.xml">
binomial coefficient</link> <math>\textstyle\binom mk</math>&nbsp;. Since <math>\textstyle1=\binom m0</math>&nbsp;, we have</p>
<p>

<indent level="1">

<math>\binom m0 =\sum_{k=1}^m (-1)^{k-1}\binom mk.</math>
</indent>

Putting all terms to the left-hand side of the equation, we obtain the expansion for (1&nbsp;–&nbsp;1)<it>m</it> given by the <link xlink:type="simple" xlink:href="../677/4677.xml">
binomial theorem</link>, hence we see that (*) is true for <it>x</it>.</p>
<p>

<b>Second possibility:</b> Let <it>A</it> denote the union of the sets <it>A</it>1, ..., <it>An</it>. Then</p>
<p>

<indent level="1">

<math>0=(1_A-1_{A_1})(1_A-1_{A_2})\cdots(1_A-1_{A_n})\,,</math>
</indent>

because both sides are zero for an <it>x</it> not in <it>A</it>, and if <it>x</it> belongs to one of the sets, say <it>Am</it>, then the corresponding <it>m</it>th factor is zero. By expanding the product on the right-hand side, equation (*) follows.</p>
<p>

<b>Use of (*):</b> To prove the inclusion-exclusion principle for the cardinality of sets, sum the equation (*) over all <it>x</it> in the union of <it>A</it>1, ..., <it>An</it>. To derive the version used in probability, take the <link xlink:type="simple" xlink:href="../653/9653.xml">
expectation</link> in (*). In general, <link xlink:type="simple" xlink:href="../987/17987.xml">
integrate</link> the equation (*) with respect to <it>μ</it>. Always use linearity.</p>

</sec>
<sec>
<st>
Other forms</st>

<p>

The principle is sometimes stated in the form that says that if</p>
<p>

<indent level="1">

<math>g(A)=\sum_{S\,:\,S\subseteq A}f(S)</math>
</indent>

then</p>
<p>

<indent level="1">

<math>f(A)=\sum_{S\,:\,S\subseteq A}(-1)^{\left|A\right|-\left|S\right|}g(S)</math>
</indent>

In that form it is seen to be the <link>
Möbius inversion formula</link> for the <link xlink:type="simple" xlink:href="../980/166980.xml">
incidence algebra</link> of the <link xlink:type="simple" xlink:href="../572/23572.xml">
partially ordered set</link> of all subsets of <it>A</it>.</p>

</sec>
<sec>
<st>
Applications</st>

<p>

In many cases where the principle could give an exact formula (in particular, counting <link xlink:type="simple" xlink:href="../666/23666.xml">
prime number</link>s using the <link xlink:type="simple" xlink:href="../415/73415.xml">
sieve of Eratosthenes</link>), the formula arising doesn't offer useful content because the number of terms in it is excessive. If each term individually can be estimated accurately, the accumulation of errors may imply that the inclusion-exclusion formula isn't directly applicable. In <link xlink:type="simple" xlink:href="../527/21527.xml">
number theory</link>, this difficulty was addressed by <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<scientist wordnetid="110560637" confidence="0.8">
<mathematician wordnetid="110301261" confidence="0.8">
<link xlink:type="simple" xlink:href="../647/40647.xml">
Viggo Brun</link></mathematician>
</scientist>
</causal_agent>
</person>
</physical_entity>
. After a slow start, his ideas were taken up by others, and a large variety of <link xlink:type="simple" xlink:href="../403/14173403.xml">
sieve method</link>s developed. These for example may try to find upper bounds for the "sieved" sets, rather than an exact formula.</p>

<ss1>
<st>
Derangements</st>

<p>

A well-known application of the inclusion-exclusion principle is to the combinatorial problem of counting all <link xlink:type="simple" xlink:href="../132/162132.xml">
derangement</link>s of a finite set.  A <it>derangement</it> of a set <it>A</it> is a <link xlink:type="simple" xlink:href="../942/3942.xml">
bijection</link> from <it>A</it> into itself that has no fixed points. Via the inclusion-exclusion principle one can show that if the cardinality of <it>A</it> is <it>n</it>, then the number of derangements is [''n''!&nbsp;/&nbsp;''e''] where [''x''] denotes the <link xlink:type="simple" xlink:href="../388/3134388.xml">
nearest integer</link> to <it>x</it>; a detailed proof is available <link xlink:type="simple" xlink:href="../182/4915182.xml#xpointer(//*[./st=%22Number+of+permutations+that+are+derangements%22])">
here</link>.</p>
<p>

This is also known as the <link xlink:type="simple" xlink:href="../855/1451855.xml">
subfactorial</link> of <it>n</it>, written !<it>n</it>. It follows that if all bijections are assigned the same probability then the probability that a random bijection is a derangement quickly approaches 1/<it>e</it> as <it>n</it> grows.</p>

</ss1>
</sec>
<sec>
<st>
Counting intersections</st>
<p>

The principle of inclusion-exclusion, combined with <link xlink:type="simple" xlink:href="../669/64669.xml">
de Morgan's theorem</link>, can be used to count the intersection of sets as well. Let <math>\scriptstyle\overline{A}_k</math> represent the complement of <it>Ak</it> with respect to some universal set <it>A</it> such that <math>\scriptstyle A_k\, \subseteq\, A</math> for each <it>k</it>. Then we have</p>
<p>

<indent level="1">

<math> 
\bigcap_{i=1}^n A_i = \overline{\bigcup_{i=1}^n \overline{A}_i}
</math>
</indent>

thereby turning the problem of finding an intersection into the problem of finding a union.</p>

</sec>
<sec>
<st>
See also</st>
<p>

<list>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../279/1588279.xml">
Combinatorial principles</link></entry>
<entry level="1" type="bullet">

 <difference wordnetid="104748836" confidence="0.8">
<inequality wordnetid="104752221" confidence="0.8">
<link xlink:type="simple" xlink:href="../887/344887.xml">
Boole's inequality</link></inequality>
</difference>
</entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../969/296969.xml">
Necklace problem</link></entry>
<entry level="1" type="bullet">

 <link>
Schuette–Nesbitt formula</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../177/19167177.xml">
Maximum-minimums identity</link></entry>
</list>
</p>

</sec>
<sec>
<st>
References</st>
<p>

<it>This article incorporates material from  on <web_site wordnetid="106359193" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../623/161623.xml">
PlanetMath</link></web_site>
, which is licensed under the .</it></p>


</sec>
</bdy>
</entity>
</article>
