<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 20:36:59[mciao0827] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<accomplishment  confidence="0.8" wordnetid="100035189">
<structure  confidence="0.8" wordnetid="104341686">
<artifact  confidence="0.8" wordnetid="100021939">
<window  confidence="0.8" wordnetid="104587648">
<event  confidence="0.8" wordnetid="100029378">
<action  confidence="0.8" wordnetid="100037396">
<supporting_structure  confidence="0.8" wordnetid="104361095">
<act  confidence="0.8" wordnetid="100030358">
<psychological_feature  confidence="0.8" wordnetid="100023100">
<framework  confidence="0.8" wordnetid="103391770">
<feat  confidence="0.8" wordnetid="100036762">
<header>
<title>Windows Metafile vulnerability</title>
<id>3589914</id>
<revision>
<id>244375080</id>
<timestamp>2008-10-10T14:23:06Z</timestamp>
<contributor>
<username>Lightbot</username>
<id>7178666</id>
</contributor>
</revision>
<categories>
<category>Security exploits</category>
<category>Microsoft Windows</category>
</categories>
</header>
<bdy>

The <b>Windows Metafile vulnerability</b> is a <link xlink:type="simple" xlink:href="../827/1129827.xml">
security vulnerability</link> in <link xlink:type="simple" xlink:href="../438/33438.xml">
Microsoft Windows NT</link>-based <link xlink:type="simple" xlink:href="../194/22194.xml">
operating system</link>s which has been used in a variety of <accomplishment wordnetid="100035189" confidence="0.8">
<event wordnetid="100029378" confidence="0.8">
<action wordnetid="100037396" confidence="0.8">
<act wordnetid="100030358" confidence="0.8">
<psychological_feature wordnetid="100023100" confidence="0.8">
<feat wordnetid="100036762" confidence="0.8">
<link xlink:type="simple" xlink:href="../875/9875.xml">
exploit</link></feat>
</psychological_feature>
</act>
</action>
</event>
</accomplishment>
s since late December <link xlink:type="simple" xlink:href="../984/35984.xml">
2005</link>. The vulnerability was first discussed in the <link xlink:type="simple" xlink:href="../398/7398.xml">
computer security</link> community around 26 and <link xlink:type="simple" xlink:href="../452/8452.xml">
December 27</link> <link xlink:type="simple" xlink:href="../984/35984.xml">
2005</link>, with the first reports of affected computers subsequently announced within 24 hours. As of <time_off wordnetid="115118453" confidence="0.8">
<fundamental_quantity wordnetid="113575869" confidence="0.8">
<time_period wordnetid="115113229" confidence="0.8">
<vacation wordnetid="115137890" confidence="0.8">
<leisure wordnetid="115137676" confidence="0.8">
<link xlink:type="simple" xlink:href="../054/19279054.xml">
January 5</link></leisure>
</vacation>
</time_period>
</fundamental_quantity>
</time_off>
, <link xlink:type="simple" xlink:href="../164/36164.xml">
2006</link>, a high priority update to fix this vulnerability is available via <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../881/296881.xml">
Windows Update</link></software>
 (see <weblink xlink:type="simple" xlink:href="http://www.microsoft.com/presspass/press/2006/jan06/01-05UpdatePR.mspx">
announcement</weblink>). No patches are needed for <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../433/75433.xml">
Windows 98</link></version>
, <link>
Windows 98 Second Edition</link> or <link xlink:type="simple" xlink:href="../458/75458.xml">
Windows Millennium Edition</link>, as they are unaffected by this vulnerability.<p>

The vulnerability, located in <structure wordnetid="104341686" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<window wordnetid="104587648" confidence="0.8">
<supporting_structure wordnetid="104361095" confidence="0.8">
<framework wordnetid="103391770" confidence="0.8">
<link xlink:type="simple" xlink:href="../625/144625.xml">
gdi32.dll</link></framework>
</supporting_structure>
</window>
</artifact>
</structure>
, arises from the way in which Windows <link xlink:type="simple" xlink:href="../194/22194.xml">
operating system</link>s handle <format wordnetid="106636806" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../673/81673.xml">
Windows Metafile</link></format>
 (WMF) <link xlink:type="simple" xlink:href="../499/32499.xml">
vector images</link>, and permits <link xlink:type="simple" xlink:href="../597/1752597.xml">
arbitrary code</link> to be executed on affected computers without the knowledge or permission of their users. The vulnerability therefore facilitates the propagation of various types of <link xlink:type="simple" xlink:href="../901/20901.xml">
malware</link>, typically through <link xlink:type="simple" xlink:href="../939/2008939.xml">
drive-by download</link>s.</p>

<sec>
<st>
Affected systems</st>
<p>

Windows Metafiles are extensively supported by all versions of the <link xlink:type="simple" xlink:href="../890/18890.xml">
Microsoft Windows</link> operating system. All versions from <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../400/168400.xml">
Windows 3.0</link></version>
 to the latest <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../068/208068.xml">
Windows Server 2003 R2</link></version>
 contain this security flaw. However, versions from <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../879/33879.xml">
Windows XP</link></version>
 onwards are more severely affected than earlier versions, since they have a handler and reader for the WMF file in their default installation.<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_abcReport">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_abcReport</weblink></p>
<p>

According to <weblink xlink:type="simple" xlink:href="http://www.grc.com/wmf/wmf.htm">
Steve Gibson's M.I.C.E. analysis</weblink>, no versions of Windows made before <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../879/33879.xml">
Windows XP</link></version>
 are affected, except for <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../941/33941.xml">
Windows 2000</link></version>
 and <link xlink:type="simple" xlink:href="../680/795680.xml">
Windows NT 4</link>. However, <link xlink:type="simple" xlink:href="../680/795680.xml">
Windows NT 4</link> may be affected by known exploits if it has an Image Preview Feature enabled.<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_MEImPrev">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_MEImPrev</weblink> Computers NOT susceptible to known exploits of the flaw (but potentially susceptible to future versions or as-yet undiscovered exploits) include: those running other versions of Windows, without Image Previewing enabled, or those with hardware-based <link xlink:type="simple" xlink:href="../836/2225836.xml">
Data Execution Prevention</link> (DEP) effective for all applications <weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_sunbeltblog">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_sunbeltblog</weblink></p>
<p>

Machines running non-Windows operating systems (e.g. <link xlink:type="simple" xlink:href="../043/20043.xml">
Mac OS</link>, <O wordnetid="106832680" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../297/6097297.xml">
Linux</link></O>
, etc.) are not directly affected. A scenario in which such computers might become vulnerable would be where a third-party program or library, designed to view WMF files on a non-Windows system, used the native Windows <structure wordnetid="104341686" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<window wordnetid="104587648" confidence="0.8">
<supporting_structure wordnetid="104361095" confidence="0.8">
<framework wordnetid="103391770" confidence="0.8">
<link xlink:type="simple" xlink:href="../625/144625.xml">
GDI</link></framework>
</supporting_structure>
</window>
</artifact>
</structure>
 <format wordnetid="106636806" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../077/2701077.xml">
DLL</link></format>
,<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_libwmf">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_libwmf</weblink> or a clone, that copied the design flaw leading to this bug, e.g. through a Windows <link xlink:type="simple" xlink:href="../937/18943937.xml">
emulator</link> or <link xlink:type="simple" xlink:href="../289/540289.xml">
compatibility layer</link>. As an example, while <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../583/37583.xml">
Wine</link></software>
 has its own version of GDI, it follows the Microsoft GDI so closely (even beyond the documented Windows specifications) that until recently it did, in fact, have the flaw,<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_ZDNet">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_ZDNet</weblink> although it might not have been exploitable in the same way. According to a test using MouseTrap, though, the vulnerability is no longer an issue. This test was done using wine-0.9.46.</p>
<p>

More recently, <link xlink:type="simple" xlink:href="../510/1314510.xml">
Steve Gibson</link> stated <weblink xlink:type="simple" xlink:href="http://www.grc.com/sn/SN-023.htm">
here</weblink> that the vulnerability could be exploited in <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../583/37583.xml">
Wine</link></software>
, and has provided a tool called <weblink xlink:type="simple" xlink:href="http://www.grc.com/wmf/wmf.htm">
MouseTrap</weblink> to detect this on all Windows systems, together with a command line version called <weblink xlink:type="simple" xlink:href="http://www.grc.com/wmf/wmf.htm">
MouseTrapCmd</weblink> for testing less compatible <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../583/37583.xml">
Wine</link></software>
 builds.</p>

</sec>
<sec>
<st>
The vulnerability</st>
<p>

According to assessments by <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../998/1107998.xml">
F-Secure</link></company>
,<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_designNotBug">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_designNotBug</weblink> the vulnerability is an inherent defect in the design of WMF files, because the underlying <link xlink:type="simple" xlink:href="../364/48364.xml">
architecture</link> of such files is from a <link xlink:type="simple" xlink:href="../295/18295.xml">
previous era</link>, and includes features which allow actual code to be executed whenever a WMF file opens. The original purpose of this was mainly to handle the cancellation of <link xlink:type="simple" xlink:href="../723/44723.xml">
print jobs</link> during <link xlink:type="simple" xlink:href="../801/469801.xml">
spooling</link>.</p>
<p>

According to <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../310/1569310.xml">
Secunia</link></company>
, “The vulnerability is caused due to an error in the handling of Windows Metafile files (‘.wmf’) containing specially crafted SETABORTPROC ‘Escape’ records. Such records allow arbitrary user-defined function to be executed when the rendering of a WMF file fails.” According to the Windows 3.1 SDK docs, the SETABORTPROC escape was obsoleted and replaced by the function of the same name in Windows 3.1, long before the WMF vulnerability was discovered.</p>
<p>

The vulnerability is <weblink xlink:type="simple" xlink:href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-4560">
CVE-2005-4560</weblink> in the <link xlink:type="simple" xlink:href="../528/4005528.xml">
Common Vulnerabilities and Exposures</link> database, <link xlink:type="simple" xlink:href="../446/1289446.xml">
US-CERT</link> reference <weblink xlink:type="simple" xlink:href="http://www.kb.cert.org/vuls/id/181038">
VU#181038</weblink> and Microsoft Knowledge Base Article <weblink xlink:type="simple" xlink:href="http://support.microsoft.com/kb/912840">
912840</weblink>.</p>

</sec>
<sec>
<st>
Propagation and infection</st>
<p>

Computers can be affected via the spread of infected <link xlink:type="simple" xlink:href="../738/9738.xml">
e-mail</link>s which may carry the hacked WMF file as an <link xlink:type="simple" xlink:href="../752/865752.xml">
attachment</link>. Infection may also result from:
<list>
<entry level="1" type="bullet">

 Viewing a <link xlink:type="simple" xlink:href="../898/33898.xml">
website</link> in a web browser that automatically opens malicious WMF files, in which case any potential malicious code may be automatically downloaded and opened. This includes <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../215/15215.xml">
Internet Explorer</link></software>
, the default Web browser for all versions of Microsoft Windows since 1996.</entry>
<entry level="1" type="bullet">

<link xlink:type="simple" xlink:href="../223/23223.xml">
Preview</link>ing an infected file in <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../959/445959.xml">
Windows Explorer</link></software>
.</entry>
<entry level="1" type="bullet">

 Viewing an infected image file using some vulnerable image viewing programs.</entry>
<entry level="1" type="bullet">

Previewing infected emails in older versions of <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<client wordnetid="109985075" confidence="0.8">
<leader wordnetid="109623038" confidence="0.8">
<administrator wordnetid="109770949" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<case wordnetid="109898892" confidence="0.8">
<head wordnetid="110162991" confidence="0.8">
<director wordnetid="110014939" confidence="0.8">
<link xlink:type="simple" xlink:href="../271/176271.xml">
Microsoft Outlook</link></director>
</head>
</case>
</causal_agent>
</administrator>
</leader>
</client>
</person>
</physical_entity>
 and <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<client wordnetid="109985075" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<case wordnetid="109898892" confidence="0.8">
<link xlink:type="simple" xlink:href="../281/176281.xml">
Outlook Express</link></case>
</causal_agent>
</client>
</person>
</physical_entity>
.</entry>
<entry level="1" type="bullet">

Indexing a hard disk containing an infected file with <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../149/1072149.xml">
Google Desktop</link></software>
.</entry>
<entry level="1" type="bullet">

Clicking on a link through an <link xlink:type="simple" xlink:href="../951/55951.xml">
instant messaging</link> program such as <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../063/19011063.xml">
Windows Live Messenger</link></software>
, <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<client wordnetid="109985075" confidence="0.8">
<traveler wordnetid="109629752" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<case wordnetid="109898892" confidence="0.8">
<messenger wordnetid="110311021" confidence="0.8">
<link xlink:type="simple" xlink:href="../ury/30th_century.xml">
AOL Instant Messenger</link></messenger>
</case>
</causal_agent>
</traveler>
</client>
</person>
</physical_entity>
 (AIM) or <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../351/199351.xml">
Yahoo! Messenger</link></software>
.</entry>
</list>
</p>
<p>

Other methods may also be used to propagate infection. Because the problem is within the operating system, using different browsers like <link xlink:type="simple" xlink:href="../892/210892.xml">
Firefox</link> or <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../620/18996620.xml">
Opera</link></software>
 would not provide complete protection. Users will commonly be prompted to download and view the file, upon which infection would occur. Infected files may be <link xlink:type="simple" xlink:href="../719/437719.xml">
downloaded automatically</link> which opens the possibility for infection by disk indexing or accidental previewing.</p>
<p>

According to assessments from the <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../684/198684.xml">
McAfee</link></company>
 antivirus company,<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_backdoor-CEP">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_backdoor-CEP</weblink> the vulnerability has been used to propagate the <link xlink:type="simple" xlink:href="../208/3602208.xml">
Bifrost</link> <technique wordnetid="105665146" confidence="0.8">
<know-how wordnetid="105616786" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../788/360788.xml">
backdoor</link></method>
</know-how>
</technique>
 <link xlink:type="simple" xlink:href="../056/30056.xml">
trojan horse</link>. Other forms of <link xlink:type="simple" xlink:href="../901/20901.xml">
malware</link> have also exploited the vulnerability to deliver various malicious <link xlink:type="simple" xlink:href="../666/15160666.xml">
payload</link>s.</p>
<p>

McAfee claims that the first generation of such exploits had been encountered by more than 6% of their customer base by <link xlink:type="simple" xlink:href="../204/8204.xml">
31 December</link> <link xlink:type="simple" xlink:href="../984/35984.xml">
2005</link>.</p>

</sec>
<sec>
<st>
Official patch</st>
<p>

<image location="left" width="45px" src="Wikinews-logo.svg">

</image>

<work wordnetid="100575741" confidence="0.8">
<social_group wordnetid="107950920" confidence="0.8">
<possession wordnetid="100032613" confidence="0.8">
<event wordnetid="100029378" confidence="0.8">
<gathering wordnetid="107975026" confidence="0.8">
<community wordnetid="108223802" confidence="0.8">
<undertaking wordnetid="100795720" confidence="0.8">
<property wordnetid="113244109" confidence="0.8">
<group wordnetid="100031264" confidence="0.8">
<act wordnetid="100030358" confidence="0.8">
<psychological_feature wordnetid="100023100" confidence="0.8">
<activity wordnetid="100407535" confidence="0.8">
<link xlink:type="simple" xlink:href="../018/1173018.xml">
Wikinews</link></activity>
</psychological_feature>
</act>
</group>
</property>
</undertaking>
</community>
</gathering>
</event>
</possession>
</social_group>
</work>
 has related news:
</p>

<p>

<company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../001/19001.xml">
Microsoft</link></company>
 released an official <link xlink:type="simple" xlink:href="../153/475153.xml">
patch</link> (available <weblink xlink:type="simple" xlink:href="http://www.microsoft.com/technet/security/Bulletin/ms06-001.mspx">
here</weblink>) to address the problem on <link xlink:type="simple" xlink:href="../054/19279054.xml">
5 January</link> <link xlink:type="simple" xlink:href="../164/36164.xml">
2006</link>, five days earlier than originally stated. This patch may be applied in lieu of other corrective measures.</p>
<p>

The official patch is available for <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../941/33941.xml">
Windows 2000</link></version>
, <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../879/33879.xml">
Windows XP</link></version>
 and <link xlink:type="simple" xlink:href="../068/208068.xml">
Microsoft Windows Server 2003</link>. A patch has not been released for <O wordnetid="106832680" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../486/454486.xml">
Windows 9x</link></O>
/<version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../458/75458.xml">
Me</link></version>
, as the vulnerability is non-existent on these operating systems. <link xlink:type="simple" xlink:href="../680/795680.xml">
Windows NT 4</link> and other affected operating systems will not receive a patch as they are no longer supported by Microsoft. <link xlink:type="simple" xlink:href="../510/1314510.xml">
Steve Gibson</link> stated <weblink xlink:type="simple" xlink:href="http://www.grc.com/sn/SN-020.htm">
here</weblink>, in his <link xlink:type="simple" xlink:href="../183/2523183.xml">
Security Now!</link> <link xlink:type="simple" xlink:href="../453/1034453.xml">
podcast</link> #20, that his company <link xlink:type="simple" xlink:href="../223/1112223.xml">
Gibson Research Corporation</link> would make a patch available for Windows 9x systems if Microsoft did not. After further research, Steve Gibson stated <weblink xlink:type="simple" xlink:href="http://www.grc.com/sn/SN-023.htm">
here</weblink>, in the more recent <link xlink:type="simple" xlink:href="../183/2523183.xml">
Security Now!</link> <link xlink:type="simple" xlink:href="../453/1034453.xml">
podcast</link> #23, that Windows 9x and Me users are <b>not</b> vulnerable, and that these systems do <b>not</b> need to be patched. Windows 9x users can run his <weblink xlink:type="simple" xlink:href="http://www.grc.com/wmf/wmf.htm">
Mouse Trap</weblink> utility to see this for themselves.</p>
<p>

Users of Windows NT who are seeking a patch should install Paolo Monti's patch from <b>Future Time</b>, the Italian distributor of <link xlink:type="simple" xlink:href="../228/590228.xml">
Eset</link>'s <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../678/962678.xml">
NOD32</link></software>
 <link xlink:type="simple" xlink:href="../622/268622.xml">
anti-virus</link> system. The patch is free, and works on older operating systems, but it is supplied without warranty. It is available for download from its <weblink xlink:type="simple" xlink:href="http://futuretime.itaweb.it/wmfpatch11.zip">
official server</weblink>.</p>
<p>

There have been reports of the official patch being automatically installed even when Windows Automatic Update is configured to download the updates automatically but ask before applying them. This results in an automatic <link xlink:type="simple" xlink:href="../972/241972.xml">
reboot</link>, which can cause loss of data (particularly if the user has a program open with unsaved changes).<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_emailbattles">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_emailbattles</weblink></p>

</sec>
<sec>
<st>
Other corrective measures</st>

<ss1>
<st>
Workaround</st>
<p>

As a <link xlink:type="simple" xlink:href="../490/124490.xml">
workaround</link>,<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_KB912840">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_KB912840</weblink> on <link xlink:type="simple" xlink:href="../198/8198.xml">
28 December</link> <link xlink:type="simple" xlink:href="../984/35984.xml">
2005</link> Microsoft advised Windows users to unregister the <link xlink:type="simple" xlink:href="../077/2701077.xml">
dynamic-link library</link> file <b>shimgvw.dll</b> (which can be done by executing the command regsvr32.exe /u shimgvw.dll from the Run menu or the <component wordnetid="105868954" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../072/1256072.xml">
command prompt</link></component>
) which invokes previewing of image files and is exploited by most of these attacks. The DLL can be re-registered once the flaw is fixed by running regsvr32.exe shimgvw.dll. This workaround does not eliminate the vulnerability, it only blocks a common attack vector.</p>

</ss1>
<ss1>
<st>
Third party patch</st>
<p>

A <idea wordnetid="105833840" confidence="0.8">
<concept wordnetid="105835747" confidence="0.8">
<component wordnetid="105868954" confidence="0.8">
<part wordnetid="105867413" confidence="0.8">
<link xlink:type="simple" xlink:href="../218/349218.xml">
third party</link></part>
</component>
</concept>
</idea>
 patch<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_IlfakPatch">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_IlfakPatch</weblink> was released by <physical_entity wordnetid="100001930" confidence="0.8">
<expert wordnetid="109617867" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<specialist wordnetid="110631941" confidence="0.8">
<intellectual wordnetid="109621545" confidence="0.8">
<alumnus wordnetid="109786338" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<scholar wordnetid="110557854" confidence="0.8">
<link xlink:type="simple" xlink:href="../822/3638822.xml">
Ilfak Guilfanov</link></scholar>
</causal_agent>
</alumnus>
</intellectual>
</specialist>
</person>
</expert>
</physical_entity>
 on <link xlink:type="simple" xlink:href="../204/8204.xml">
31 December</link> <link xlink:type="simple" xlink:href="../984/35984.xml">
2005</link> to temporarily disable the vulnerable <link xlink:type="simple" xlink:href="../988/40988.xml">
function</link> call in gdi32.dll. This unofficial patch received much <link xlink:type="simple" xlink:href="../583/245583.xml">
publicity</link> due to the unavailability of an official one from Microsoft, receiving the recommendation of <link xlink:type="simple" xlink:href="../072/29072.xml">
SANS Institute</link> <computer wordnetid="103082979" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<machine wordnetid="103699975" confidence="0.8">
<web_site wordnetid="106359193" confidence="0.8">
<link xlink:type="simple" xlink:href="../388/176388.xml">
Internet Storm Center</link></web_site>
</machine>
</device>
</instrumentality>
</artifact>
</computer>
<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_iscEndorseIlfak">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_iscEndorseIlfak</weblink> and F-Secure.<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_fsEndorseIlfak">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_fsEndorseIlfak</weblink> Because of the large amount of publicity, including being indirectly <link xlink:type="simple" xlink:href="../122/18933122.xml">
slashdotted</link>,<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_IlfakSlashdotted">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_IlfakSlashdotted</weblink> Guilfanov's website was overrun with more visitors than it could have coped with, causing it to be suspended on 3 January 2006. During the downtime, the patch was available for download from a number of <link xlink:type="simple" xlink:href="../038/371038.xml">
mirrors</link> including the Internet Storm Center website<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_iscMirror">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_iscMirror</weblink></p>
<p>

Guilfanov's website went back online on <link xlink:type="simple" xlink:href="../982/15982.xml">
4 January</link> in a much reduced state. No longer providing the patch on site due to <link xlink:type="simple" xlink:href="../827/15612827.xml">
bandwidth</link> issues, the <weblink xlink:type="simple" xlink:href="http://www.hexblog.com/">
homepage</weblink> provides a list of mirrors where a user can download the patch and the associated vulnerability checker. Also available is the <function wordnetid="113783816" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../826/18826.xml">
MD5</link></function>
 <link xlink:type="simple" xlink:href="../538/7538.xml">
checksum</link> for the original file, so that a user can check the file they downloaded is an unmodified version.</p>
<p>

After Microsoft released its patch, Guilfanov took his offline and urged visitors to install the official patch, as his intention was always to spur the release of a supported and tested patch.</p>

</ss1>
<ss1>
<st>
Risk reduction techniques</st>
<p>

Microsoft says its patch removes the flawed functionality in gdi32 that allowed the WMF vulnerability. For computers running a version of Windows that Microsoft has not patched, a <link xlink:type="simple" xlink:href="../216/1674216.xml">
defence in depth</link> approach is recommended, to mitigate the risk of infection. Various sources have recommended mitigation efforts that include:
<list>
<entry level="1" type="bullet">

Making use of hardware-enforced <link xlink:type="simple" xlink:href="../836/2225836.xml">
Data Execution Prevention</link><weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_DEP">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_DEP</weblink> effective for all applications.</entry>
<entry level="1" type="bullet">

Set the default WMF application to be something innocuous such as <link xlink:type="simple" xlink:href="../474/143474.xml">
Notepad</link>.</entry>
<entry level="1" type="bullet">

Do not use Internet Explorer or at least turn off downloads by setting the default security settings to HIGH.</entry>
<entry level="1" type="bullet">

Be vigilant in keeping all <link xlink:type="simple" xlink:href="../622/268622.xml">
anti-virus software</link> up-to-date. Consider frequent manual updates.</entry>
<entry level="1" type="bullet">

Block all WMF files at your network perimeter by file header filtering.</entry>
<entry level="1" type="bullet">

Making use of users accounts that are configured with as few user rights as necessary.</entry>
<entry level="1" type="bullet">

Disable image loading in Internet Explorer, and all other browsers.<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_ieDisImage">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_ieDisImage</weblink></entry>
<entry level="1" type="bullet">

Disable image loading in <physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<client wordnetid="109985075" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<case wordnetid="109898892" confidence="0.8">
<link xlink:type="simple" xlink:href="../281/176281.xml">
Outlook Express</link></case>
</causal_agent>
</client>
</person>
</physical_entity>
.<weblink xlink:type="simple" xlink:href="http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_oeDisImage">
http://localhost:18088/wiki/index.php/Windows_Metafile_vulnerability#endnote_oeDisImage</weblink></entry>
<entry level="1" type="bullet">

Disable hyperlinks in MSN Messenger.</entry>
<entry level="1" type="bullet">

Disable the Indexing Service on <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../941/33941.xml">
Windows 2000</link></version>
, <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../879/33879.xml">
Windows XP</link></version>
 and <version wordnetid="107173585" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../068/208068.xml">
Windows Server 2003</link></version>
.</entry>
<entry level="1" type="bullet">

Disable Desktop Search applications such as <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../149/1072149.xml">
Google Desktop</link></software>
 or <link>
Windows Desktop Search</link> until the problem is corrected.</entry>
</list>

According to <weblink xlink:type="simple" xlink:href="http://isc.sans.org/diary.php?storyid=994">
this</weblink> SANS Institute Internet Storm Center article, using a web browser other than Internet Explorer <it>may</it> offer additional protection against this vulnerability. Depending on settings, these browsers may ask the user before opening an image with the .wmf extension, but this only reduces the chance of opening the maliciously crafted Windows Metafile and does not protect against the vulnerability being exploited, as these browsers still open the metafile if it is masquerading as another format. It is better to entirely disable image loading in the browser you choose to use.</p>

</ss1>
</sec>
<sec>
<st>
Accusations</st>
<p>

An independent examination of the vulnerability by <link xlink:type="simple" xlink:href="../510/1314510.xml">
Steve Gibson</link> of <link xlink:type="simple" xlink:href="../223/1112223.xml">
Gibson Research</link> had suggested that the peculiar nature of the 'bug' was an indication that the vulnerability was actually a <technique wordnetid="105665146" confidence="0.8">
<know-how wordnetid="105616786" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../788/360788.xml">
backdoor</link></method>
</know-how>
</technique>
 engineered consciously into the system<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%221%22])">1</ref>. Some sources have questioned this conclusion <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%222%22])">2</ref> <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%223%22])">3</ref> <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%224%22])">4</ref>. Steve Gibson has since clarified <ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%225%22])">5</ref> that his use of the term <technique wordnetid="105665146" confidence="0.8">
<know-how wordnetid="105616786" confidence="0.8">
<method wordnetid="105660268" confidence="0.8">
<link xlink:type="simple" xlink:href="../788/360788.xml">
backdoor</link></method>
</know-how>
</technique>
 was never intended to imply anything done by <link>
malicious intent</link> . He still maintains that the backdoor was intentional, though not necessarily officially mandated by Microsoft (e.g. a rogue employee may have put it in).</p>

</sec>
<sec>
<st>
Notes</st>

<p>

<list>
<entry level="1" type="number">

  <cite id="endnote_abcReport" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://www.pcmag.com/article2/0,2817,1907400,00.asp">
Security Watch: Iniquitous Images Imperil the Internet!</weblink>, Larry Seltzer, PC Magazine. </entry>
<entry level="1" type="number">

  <cite id="endnote_MEImPrev" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://support.microsoft.com/?kbid=272969">
A Description of the Image Preview Feature in Windows Millennium Edition</weblink>, Microsoft.</entry>
<entry level="1" type="number">

  <cite id="endnote_sunbeltblog" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://sunbeltblog.blogspot.com/2005/12/microsoft-clarifies-dep-issue.html">
sunbeltblog.blogspot.com</weblink> Microsoft clarifies DEP issue</entry>
<entry level="1" type="number">

  <cite id="endnote_libwmf" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://www.icewalkers.com/Linux/Software/5400/libwmf.html">
Library for non-Windows operating systems</weblink> to run WMF files.</entry>
<entry level="1" type="number">

  <cite id="endnote_ZDNet" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://blogs.zdnet.com/Ou/index.php?p=146">
Linux/BSD still exposed to WMF exploit through WINE</weblink>, ZDNet.</entry>
<entry level="1" type="number">

  <cite id="endnote_designNotBug" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://www.f-secure.com/weblog/archives/archive-012006.html#00000761">
It's not a bug, it's a feature</weblink>, F-Secure.</entry>
<entry level="1" type="number">

  <cite id="endnote_backdoor-CEP" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://vil.mcafeesecurity.com/vil/content/v_137760.htm">
Exploit-WMF</weblink>, by McAfee</entry>
<entry level="1" type="number">

  <cite id="endnote_emailbattles" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://www.emailbattles.com/archive/battles/vuln_aacfhddccc_de/">
Does Windows Patch Without Permission?</weblink></entry>
<entry level="1" type="number">

  <cite id="endnote_KB912840" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://www.microsoft.com/technet/security/advisory/912840.mspx">
Microsoft Security Advisory (912840) - Vulnerability in Graphics Rendering Engine Could Allow Remote Code Execution</weblink>, Microsoft Official Advisory on the vulnerability.</entry>
<entry level="1" type="number">

  <cite id="endnote_IlfakPatch" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://www.hexblog.com/2005/12/wmf_vuln.html">
http://www.hexblog.com/2005/12/wmf_vuln.html</weblink>, unofficial patch by Ilfak Guilfanov.</entry>
<entry level="1" type="number">

  <cite id="endnote_iscEndorseIlfak" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://isc.sans.org/diary.php?rss&amp;storyid=996">
Trustworthy Computing</weblink>, SANS Institute Internet Storm Center.</entry>
<entry level="1" type="number">

  <cite id="endnote_fsEndorseIlfak" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://www.f-secure.com/weblog/archives/archive-122005.html#00000756">
Ilfak to the rescue!</weblink>, F-Secure.</entry>
<entry level="1" type="number">

  <cite id="endnote_IlfakSlashdotted" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://it.slashdot.org/it/06/01/02/1153244.shtml?tid=201">
Trustworthy Computing</weblink>, Slashdot. Linking to SANS Institute Internet Storm Center's article titled Trustworthy Computing (see above).</entry>
<entry level="1" type="number">

  <cite id="endnote_iscMirror" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://isc.sans.org/diary.php?storyid=1010">
.MSI installer file for WMF flaw available</weblink>, SANS Institute Internet Storm Center.</entry>
<entry level="1" type="number">

  <cite id="endnote_DEP" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://www.microsoft.com/technet/security/prodtech/windowsxp/depcnfxp.mspx">
How to Configure Memory Protection in Windows XP SP2</weblink>, software-enforced Data Execution Prevention (DEP) feature in Microsoft Windows XP SP 2.</entry>
<entry level="1" type="number">

  <cite id="endnote_ieDisImage" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://support.microsoft.com/kb/153790">
How to improve browsing performance in Internet Explorer (KB153790)</weblink>, Microsoft.</entry>
<entry level="1" type="number">

  <cite id="endnote_oeDisImage" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://support.microsoft.com/kb/843018">
Images are blocked when you open an e-mail message in Outlook Express on a Windows XP Service Pack 2-based computer (KB843018)</weblink>, Microsoft.</entry>
<entry level="1" type="number">

  <cite id="endnote_PaoloPatch" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://www.nod32.ch/en/download/tools.php">
http://www.nod32.ch/en/download/tools.php</weblink> Unofficial WMF patch by Paolo Monti distributed by ESET.</entry>
<entry level="1" type="number">

  <cite id="endnote_TomPatch" style="font-style: normal;">
<b>^</b></cite>&nbsp; <weblink xlink:type="simple" xlink:href="http://blogs.securiteam.com/index.php/archives/210">
http://blogs.securiteam.com/index.php/archives/210</weblink> Unofficial Windows 98SE patch by Tom Walsh.</entry>
</list>
</p>

</sec>
<sec>
<st>
External links</st>
<p>

<image location="left" width="45px" src="Wikinews-logo.svg">

</image>

<work wordnetid="100575741" confidence="0.8">
<social_group wordnetid="107950920" confidence="0.8">
<possession wordnetid="100032613" confidence="0.8">
<event wordnetid="100029378" confidence="0.8">
<gathering wordnetid="107975026" confidence="0.8">
<community wordnetid="108223802" confidence="0.8">
<undertaking wordnetid="100795720" confidence="0.8">
<property wordnetid="113244109" confidence="0.8">
<group wordnetid="100031264" confidence="0.8">
<act wordnetid="100030358" confidence="0.8">
<psychological_feature wordnetid="100023100" confidence="0.8">
<activity wordnetid="100407535" confidence="0.8">
<link xlink:type="simple" xlink:href="../018/1173018.xml">
Wikinews</link></activity>
</psychological_feature>
</act>
</group>
</property>
</undertaking>
</community>
</gathering>
</event>
</possession>
</social_group>
</work>
 has related news:
</p>

<p>

<list>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.grc.com/wmf/wmf.htm">
GRC's M.I.C.E.</weblink> Metafile Image Code Execution</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.microsoft.com/athome/security/update/bulletins/200601_WMF.mspx">
Microsoft Security Bulletin for novice Home Users</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.microsoft.com/technet/security/bulletin/ms08-021.mspx">
Microsoft Security Bulletin MS08-021</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.microsoft.com/technet/security/Bulletin/ms06-001.mspx">
Microsoft Security Bulletin MS06-001</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://isc.sans.org/diary.php?storyid=994">
WMF FAQ</weblink> - SANS Institute Internet Storm Center</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.washingtonpost.com/wp-dyn/content/article/2005/12/29/AR2005122901456.html">
Windows Security Flaw Is 'Severe'</weblink> - <link xlink:type="simple" xlink:href="../226/102226.xml">
Washington Post</link></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://secunia.com/advisories/18255/">
Microsoft Windows WMF "SETABORTPROC" Arbitrary Code Execution</weblink> - <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../310/1569310.xml">
Secunia</link></company>
 advisory</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.node707.com/archives/006520.shtml">
Summary of status as of 1 January</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://blogs.technet.com/msrc/archive/2006/01/13/417431.aspx">
Looking at the WMF issue, how did it get there?</weblink> - Microsoft Security Response Center Blog</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://isc.sans.org/diary.php?storyid=992">
New exploit released for the WMF vulnerability</weblink> - SANS Institute Internet Storm Center</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.f-secure.com/weblog/archives/archive-122005.html#00000753">
Be careful with WMF files</weblink> - F-Secure</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://isc.sans.org/diary.php?storyid=981">
Lotus Notes Vulnerable to WMF 0-Day Exploit</weblink> - SANS Institute Internet Storm Center</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.hexblog.com/2006/01/wmf_vulnerability_checker.html">
Vulnerability Checker</weblink> - Ilfak Guilfanov</entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.metasploit.com/projects/Framework/exploits.html#ie_xp_pfv_metafile">
Example exploit</weblink> - <software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../115/3838115.xml">
Metasploit Project</link></software>
</entry>
<entry level="1" type="bullet">

<computer wordnetid="103082979" confidence="0.8">
<artifact wordnetid="100021939" confidence="0.8">
<social_group wordnetid="107950920" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<gathering wordnetid="107975026" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<community wordnetid="108223802" confidence="0.8">
<machine wordnetid="103699975" confidence="0.8">
<group wordnetid="100031264" confidence="0.8">
<web_site wordnetid="106359193" confidence="0.8">
<link xlink:type="simple" xlink:href="../316/63316.xml">
Microsoft Developer Network</link></web_site>
</group>
</machine>
</community>
</device>
</gathering>
</instrumentality>
</social_group>
</artifact>
</computer>
 pages for <weblink xlink:type="simple" xlink:href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/gdi/prntspol_0d6b.asp">
Escape</weblink> and <weblink xlink:type="simple" xlink:href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/gdi/prntspol_0883.asp">
SetAbortProc</weblink></entry>
<entry level="1" type="bullet">

<weblink xlink:type="simple" xlink:href="http://www.sysinternals.com/blog/2006/01/inside-wmf-backdoor.html">
Mark Russinovich's Technical Commentary on the Backdoor Controversy</weblink></entry>
</list>
</p>


</sec>
</bdy>
</feat>
</framework>
</psychological_feature>
</act>
</supporting_structure>
</action>
</event>
</window>
</artifact>
</structure>
</accomplishment>
</article>
