<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 20:51:09[mciao0827] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<idea  confidence="0.8" wordnetid="105833840">
<concept  confidence="0.8" wordnetid="105835747">
<property  confidence="0.8" wordnetid="105849040">
<feature  confidence="0.8" wordnetid="105849789">
<header>
<title>Loop device</title>
<id>3864138</id>
<revision>
<id>244003622</id>
<timestamp>2008-10-08T22:10:39Z</timestamp>
<contributor>
<username>Ryan Sawhill</username>
<id>8033579</id>
</contributor>
</revision>
<categories>
<category>Linux kernel features</category>
<category>Unix</category>
</categories>
</header>
<bdy>

"Lofi" redirects here. For the sound recording technique, see <link xlink:type="simple" xlink:href="../177/101177.xml">
Lo-fi</link>.<p>

In <family wordnetid="108078020" confidence="0.8">
<link xlink:type="simple" xlink:href="../815/31815.xml">
Unix-like</link></family>
 operating systems, a <b>loop device</b>, <b>vnd</b> (vnode disk), or <b>lofi</b> (loopback file interface) is a <link xlink:type="simple" xlink:href="../986/18016986.xml">
pseudo-device</link> that makes a <link xlink:type="simple" xlink:href="../077/7077.xml">
file</link> accessible as a <link xlink:type="simple" xlink:href="../986/18016986.xml">
block device</link>.</p>
<p>

Before use, a loop device must be connected to an existing file in the filesystem. The association provides the user with an <link xlink:type="simple" xlink:href="../ury/24th_century.xml">
API</link> that allows the file to be used in place of a block special file (cf. <link xlink:type="simple" xlink:href="../986/18016986.xml">
device file system</link>). Thus, if the file contains an entire <link xlink:type="simple" xlink:href="../280/1010280.xml">
file system</link>, the file may then be <link xlink:type="simple" xlink:href="../987/5176987.xml">
mounted</link> as if it were a disk device.</p>
<p>

Files of this kind are often used for CD <format wordnetid="106636806" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../185/346185.xml">
ISO image</link></format>
s and floppy disc images. Mounting a file containing a filesystem via such a <b>loop mount</b> makes the files within that filesystem accessible as regular files, located in the <link xlink:type="simple" xlink:href="../987/5176987.xml">
mount point</link> directory.</p>
<p>

A loop device may allow some kind of data elaboration during this redirection; for example, the device may be the unencrypted version of an encrypted file. In such a case, the file associated with a loop device may be another pseudo-device. This is mostly useful when this device contains an encrypted file system. If supported, the loop device is in this case the decrypted version of the original encrypted file and can therefore be mounted as if it were a normal filesystem.</p>

<sec>
<st>
 Examples </st>
<p>

Mounting a file on a directory requires two steps:</p>
<p>

<list>
<entry level="1" type="number">

 the file is associated with a loop <link xlink:type="simple" xlink:href="../986/18016986.xml">
device node</link>, which is a special file</entry>
<entry level="1" type="number">

 the loop device is mounted on the directory</entry>
</list>
</p>
<p>

These two operations can be performed either using two separate commands, or by letting the mount command perform the first step before actually doing the mount. The first operation can be executed by a specific command such as losetup<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%221%22])">1</ref> in <O wordnetid="106832680" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../297/6097297.xml">
Linux</link></O>
. As an example, if example.img is a regular file containing a filesystem and /home/you/dir is a directory on a Linux box, the <link xlink:type="simple" xlink:href="../209/264209.xml">
root user</link> can mount the file on the directory by executing the following two commands:</p>
<p>

losetup /dev/loop0 example.img
mount /dev/loop0 /home/you/dir</p>
<p>

The first command associates the loop device node /dev/loop0 with the regular file example.img. This association can be later destroyed by executing losetup -d /dev/loop0. The second command mounts the device on the directory /home/you/dir. The overall effect of executing these two commands is that the content of the file is used as the whole mounted directory. The system call used by losetup to associate and disassociate files with loop devices is an <link xlink:type="simple" xlink:href="../038/2924038.xml">
ioctl</link> on the loop device.</p>
<p>

An alternative way of doing the same is to let the mount utility handle the setting up of the loop device:</p>
<p>

mount -o loop example.img /home/you/dir</p>
<p>

In this case, the mount command performs both the association of the file with the loop device and the mount itself.</p>
<p>

At the level of <link xlink:type="simple" xlink:href="../908/102908.xml">
system call</link>s, the association and disassociation of a file with a loop device are done via <link xlink:type="simple" xlink:href="../038/2924038.xml">
ioctl</link>'s on the loop device. Both losetup and mount therefore use such ioctl's to operate on loop devices. For example, losetup /dev/loop0 example.img opens device /dev/loop0 and performs an ioctl on the resulting file descriptor, passing LOOP_SET_FD as the request number and the string example.img as the third argument.</p>

</sec>
<sec>
<st>
 Uses of loop mounting </st>

<p>

After mounting a file containing a filesystem, the files within the filesystem can be accessed through the usual filesystem interface of the operating system, without any need for special functionality, such as reading and writing to ISO images, in applications.</p>
<p>

Uses include managing and editing filesystem images meant for later normal use (especially CD or DVD images or installation systems) or permanent segregation of data in actual use (for example simulating removable media on a faster and more convenient hard disk or encapsulating encrypted filesystems).</p>

</sec>
<sec>
<st>
 Availability</st>

<p>

Some confusion exists about the naming of the loop device under various operating systems.
Various Unix-like operating system provide the loop device functionality under different names.</p>
<p>

In Linux<ref xlink:type="simple" xlink:href="#xpointer(//reflist/entry[@id=%222%22])">2</ref>, device names are encoded in the symbol table entries of their corresponding device drivers.  The device is called "loop" device and device nodes in the <link xlink:type="simple" xlink:href="../986/18016986.xml">
device file system</link> are named /dev/loop0, /dev/loop1, etc. and created by the <link>
makedev</link> script. The management user interface for the loop device is losetup and is part of the <link xlink:type="simple" xlink:href="../801/6223801.xml">
util-linux</link> package.</p>
<p>

Sometimes, the loop device is erroneously referred to as 'loopback' device, but this term is reserved for a networking device in the Linux kernel (cf. <link xlink:type="simple" xlink:href="../478/160478.xml">
loopback</link>). The concept of the 'loop' device is distinct from that of 'loopback', although similar in name. </p>
<p>

In BSD, the loop device is called "virtual node device" or "vnd", and generally located at /dev/vnd0, /dev/rvnd0 or /dev/svnd0, etc., in the file system. 
The configuration is called the vnconfig program.</p>
<p>

In SunOS, it is called "loopback file interface" or lofi, and located at /dev/lofi/1, etc. SunOS has the lofiadm program for configuration.</p>
<p>

Loop mounting is not natively available on <link xlink:type="simple" xlink:href="../890/18890.xml">
Microsoft Windows</link> operating systems; however, the facility often added using third-party applications such as <it><physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<copycat wordnetid="109964411" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<link xlink:type="simple" xlink:href="../305/1041305.xml">
Daemon Tools</link></causal_agent>
</copycat>
</person>
</physical_entity>
</it> and <it><software wordnetid="106566077" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../814/700814.xml">
Alcohol 120%</link></software>
</it>.</p>
<p>

A freely-available <weblink xlink:type="simple" xlink:href="http://www.stoev.org/vmware/diskmount.html">
http://www.stoev.org/vmware/diskmount.html</weblink> tool from <company wordnetid="108058098" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../018/312018.xml">
VMware</link></company>
 can also be used to achieve similar functionality.</p>

</sec>
<sec>
<st>
 See also </st>
<p>

<list>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../986/18016986.xml">
device file system</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../092/1930092.xml">
Disk image emulator</link></entry>
<entry level="1" type="bullet">

 <idea wordnetid="105833840" confidence="0.8">
<concept wordnetid="105835747" confidence="0.8">
<property wordnetid="105849040" confidence="0.8">
<feature wordnetid="105849789" confidence="0.8">
<link xlink:type="simple" xlink:href="../808/16019808.xml">
Network block device</link></feature>
</property>
</concept>
</idea>
 used when the file to associate with the device is on a remote computer</entry>
<entry level="1" type="bullet">

 With similar name, but different concept, a <artifact wordnetid="100021939" confidence="0.8">
<instrumentality wordnetid="103575240" confidence="0.8">
<electrical_device wordnetid="103269401" confidence="0.8">
<device wordnetid="103183080" confidence="0.8">
<circuit wordnetid="103033362" confidence="0.8">
<link xlink:type="simple" xlink:href="../478/160478.xml#xpointer(//*[./st=%22Virtual+Internet+Protocol+Network+Interface%22])">
loopback interface</link></circuit>
</device>
</electrical_device>
</instrumentality>
</artifact>
, or loopback device is network facility in UNIX-like operating systems</entry>
</list>
</p>

</sec>
<sec>
<st>
 References </st>
<p>

<reflist>
<entry id="1">
http://www.cl.cam.ac.uk/cgi-bin/manpage?8+losetup losetup manual page</entry>
<entry id="2">
http://www.kernel.org The Linux kernel archives</entry>
</reflist>
</p>

</sec>
<sec>
<st>
 External links </st>
<p>

<list>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://www.linux.org/docs/ldp/howto/Cryptoloop-HOWTO/loopdevice-setup.html">
Setting up the loop device</weblink> from the <link xlink:type="simple" xlink:href="../312/6361312.xml">
cryptoloop</link> <link xlink:type="simple" xlink:href="../502/175502.xml">
HOWTO</link>.</entry>
<entry level="1" type="bullet">

 <weblink xlink:type="simple" xlink:href="http://bochs.sourceforge.net/doc/docbook/user/loop-device-usage.html">
Mounting a disk image using the loop device</weblink> from the <it><physical_entity wordnetid="100001930" confidence="0.8">
<person wordnetid="100007846" confidence="0.8">
<copycat wordnetid="109964411" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<link xlink:type="simple" xlink:href="../072/362072.xml">
Bochs</link></causal_agent>
</copycat>
</person>
</physical_entity>
 User Manual''</it></entry>
</list>
</p>


</sec>
</bdy>
</feature>
</property>
</concept>
</idea>
</article>
