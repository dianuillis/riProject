<?xml version="1.0" encoding="UTF-8"?>
<!-- generated by CLiX/Wiki2XML [MPI-Inf, MMCI@UdS] $LastChangedRevision: 92 $ on 16.04.2009 17:45:18[mciao0826] -->
<!DOCTYPE article SYSTEM "../article.dtd">
<article xmlns:xlink="http://www.w3.org/1999/xlink">
<header>
<title>Metamorphic code</title>
<id>861400</id>
<revision>
<id>235688785</id>
<timestamp>2008-09-01T22:41:09Z</timestamp>
<contributor>
<username>SmackBot</username>
<id>433328</id>
</contributor>
</revision>
<categories>
<category>Malware</category>
<category>Computer viruses</category>
</categories>
</header>
<bdy>

In <link xlink:type="simple" xlink:href="../196/18994196.xml">
computer virus</link> terms, <b>metamorphic code</b> is code that can reprogram itself. Often, it does this by translating its own code into a temporary representation, edit the temporary representation of itself, and then write itself back to normal code again.<weblink xlink:type="simple" xlink:href="http://vx.netlux.org/lib/vmd01.html">
http://vx.netlux.org/lib/vmd01.html</weblink> This procedure is done with the virus itself, and thus also the metamorphic engine <it>itself</it> undergoes changes. This is used by some viruses when they are about to infect new files, and the result is that the "children" will never look like their "parents". The computer viruses that use this technique do this in order to avoid the <link xlink:type="simple" xlink:href="../706/126706.xml">
pattern recognition</link> of anti-virus software: the actual algorithm does not change, but everything else might.<p>

The main difference between metamorphic and polymorphic viruses is the fact that a polymorphic virus ciphers its original code to avoid pattern recognition, and a metamorphic virus changes its code to an equivalent one (i.e. the codes do essentially the same thing). This modification can be achieved using techniques like inserting <message wordnetid="106598915" confidence="0.8">
<direction wordnetid="106786629" confidence="0.8">
<link xlink:type="simple" xlink:href="../580/390580.xml">
NOP</link></direction>
</message>
 instructions, swapping registers, changing flow control with jumps or reordering independent instructions. Metamorphic code is usually more effective than <link xlink:type="simple" xlink:href="../447/218447.xml">
polymorphic code</link>. This is because the anti-virus, in order to detect it, will need to use some kind of emulation to analyze the code behavior.</p>
<p>

Metamorphic code can also mean that a virus is capable of infecting executables from two or more different <link xlink:type="simple" xlink:href="../194/22194.xml">
operating system</link>s (such as <link xlink:type="simple" xlink:href="../890/18890.xml">
Windows</link> and <O wordnetid="106832680" confidence="0.9508927676800064">
<link xlink:type="simple" xlink:href="../297/6097297.xml">
GNU/Linux</link></O>
) or even different <link xlink:type="simple" xlink:href="../509/6509.xml">
computer architecture</link>s. Often, the virus does this by carrying several viruses with itself. The beginning of the virus is then coded so that it translates to correct machine-code for all of the platforms that it is supposed to execute in <weblink xlink:type="simple" xlink:href="http://www.phrack.org/archives/57/p57-0x17">
http://www.phrack.org/archives/57/p57-0x17</weblink>. It is possible in theory for a metamorphic virus to rewrite the temporary representation of itself into another set of instructions, intended for another computer architecture. The <link xlink:type="simple" xlink:href="../ury/24th_century.xml">
API</link> would also have to be changed.</p>

<sec>
<st>
See also</st>
<p>

<list>
<entry level="1" type="bullet">

 <paradigm wordnetid="113804375" confidence="0.8">
<linguistic_relation wordnetid="113797142" confidence="0.8">
<inflection wordnetid="113803782" confidence="0.8">
<grammatical_relation wordnetid="113796779" confidence="0.8">
<link xlink:type="simple" xlink:href="../647/217647.xml">
Self-modifying code</link></grammatical_relation>
</inflection>
</linguistic_relation>
</paradigm>
</entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../929/47929.xml">
Strange loop</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../447/218447.xml">
Polymorphic code</link></entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../761/174761.xml">
Timeline of notable computer viruses and worms</link></entry>
</list>
</p>

</sec>
<sec>
<st>
Metamorphic viruses</st>
<p>

<list>
<entry level="1" type="bullet">

 <physical_entity wordnetid="100001930" confidence="0.8">
<microorganism wordnetid="101326291" confidence="0.8">
<virus wordnetid="101328702" confidence="0.8">
<causal_agent wordnetid="100007347" confidence="0.8">
<agent wordnetid="109190918" confidence="0.8">
<infectious_agent wordnetid="109312843" confidence="0.8">
<link xlink:type="simple" xlink:href="../574/1517574.xml">
Simile</link></infectious_agent>
</agent>
</causal_agent>
</virus>
</microorganism>
</physical_entity>
</entry>
<entry level="1" type="bullet">

 <link xlink:type="simple" xlink:href="../100/3784100.xml">
ZMist</link></entry>
</list>
</p>

</sec>
<sec>
<st>
External links</st>
<p>

<weblink xlink:type="simple" xlink:href="http://www.symantec.com/avcenter/reference/hunting.for.metamorphic.pdf">
http://www.symantec.com/avcenter/reference/hunting.for.metamorphic.pdf</weblink> Hunting for Metamorphic</p>


</sec>
</bdy>
</article>
